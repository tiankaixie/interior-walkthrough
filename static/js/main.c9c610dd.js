/*! For license information please see main.c9c610dd.js.LICENSE.txt */
(()=>{var e={895:(e,t,n)=>{var r;!function(i,s,o,a){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],u=s.createElement("div"),h=Math.round,d=Math.abs,f=Date.now;function p(e,t,n){return setTimeout(_(e,n),t)}function g(e,t,n){return!!Array.isArray(e)&&(m(e,n[t],n),!0)}function m(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==a)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function v(e,t,n){var r="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=i.console&&(i.console.warn||i.console.log);return s&&s.call(i.console,r,n),e.apply(this,arguments)}}l="function"!==typeof Object.assign?function(e){if(e===a||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==a&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t}:Object.assign;var b=v((function(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;)(!n||n&&e[r[i]]===a)&&(e[r[i]]=t[r[i]]),i++;return e}),"extend","Use `assign`."),y=v((function(e,t){return b(e,t,!0)}),"merge","Use `assign`.");function A(e,t,n){var r,i=t.prototype;(r=e.prototype=Object.create(i)).constructor=e,r._super=i,n&&l(r,n)}function _(e,t){return function(){return e.apply(t,arguments)}}function w(e,t){return"function"==typeof e?e.apply(t&&t[0]||a,t):e}function C(e,t){return e===a?t:e}function E(e,t,n){m(T(t),(function(t){e.addEventListener(t,n,!1)}))}function B(e,t,n){m(T(t),(function(t){e.removeEventListener(t,n,!1)}))}function x(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function S(e,t){return e.indexOf(t)>-1}function T(e){return e.trim().split(/\s+/g)}function M(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function P(e){return Array.prototype.slice.call(e,0)}function I(e,t,n){for(var r=[],i=[],s=0;s<e.length;){var o=t?e[s][t]:e[s];M(i,o)<0&&r.push(e[s]),i[s]=o,s++}return n&&(r=t?r.sort((function(e,n){return e[t]>n[t]})):r.sort()),r}function R(e,t){for(var n,r,i=t[0].toUpperCase()+t.slice(1),s=0;s<c.length;){if((r=(n=c[s])?n+i:t)in e)return r;s++}return a}var O=1;function L(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||i}var F="ontouchstart"in i,k=R(i,"PointerEvent")!==a,D=F&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),N="touch",j="mouse",U=24,G=["x","y"],z=["clientX","clientY"];function V(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){w(e.options.enable,[e])&&n.handler(t)},this.init()}function H(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,s=1&t&&r-i===0,o=12&t&&r-i===0;n.isFirst=!!s,n.isFinal=!!o,s&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=J(t));i>1&&!n.firstMultiple?n.firstMultiple=J(t):1===i&&(n.firstMultiple=!1);var s=n.firstInput,o=n.firstMultiple,l=o?o.center:s.center,c=t.center=W(r);t.timeStamp=f(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=Y(l,c),t.distance=Q(l,c),function(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},s=e.prevInput||{};1!==t.eventType&&4!==s.eventType||(i=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y});t.deltaX=i.x+(n.x-r.x),t.deltaY=i.y+(n.y-r.y)}(n,t),t.offsetDirection=K(t.deltaX,t.deltaY);var u=X(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=u.x,t.overallVelocityY=u.y,t.overallVelocity=d(u.x)>d(u.y)?u.x:u.y,t.scale=o?(h=o.pointers,p=r,Q(p[0],p[1],z)/Q(h[0],h[1],z)):1,t.rotation=o?function(e,t){return Y(t[1],t[0],z)+Y(e[1],e[0],z)}(o.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,i,s,o=e.lastInterval||t,l=t.timeStamp-o.timeStamp;if(8!=t.eventType&&(l>25||o.velocity===a)){var c=t.deltaX-o.deltaX,u=t.deltaY-o.deltaY,h=X(l,c,u);r=h.x,i=h.y,n=d(h.x)>d(h.y)?h.x:h.y,s=K(c,u),e.lastInterval=t}else n=o.velocity,r=o.velocityX,i=o.velocityY,s=o.direction;t.velocity=n,t.velocityX=r,t.velocityY=i,t.direction=s}(n,t);var h,p;var g=e.element;x(t.srcEvent.target,g)&&(g=t.srcEvent.target);t.target=g}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function J(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:h(e.pointers[n].clientX),clientY:h(e.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:t,center:W(t),deltaX:e.deltaX,deltaY:e.deltaY}}function W(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var n=0,r=0,i=0;i<t;)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:h(n/t),y:h(r/t)}}function X(e,t,n){return{x:t/e||0,y:n/e||0}}function K(e,t){return e===t?1:d(e)>=d(t)?e<0?2:4:t<0?8:16}function Q(e,t,n){n||(n=G);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function Y(e,t,n){n||(n=G);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return 180*Math.atan2(i,r)/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(L(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&B(this.element,this.evEl,this.domHandler),this.evTarget&&B(this.target,this.evTarget,this.domHandler),this.evWin&&B(L(this.element),this.evWin,this.domHandler)}};var Z={mousedown:1,mousemove:2,mouseup:4},q="mousedown",$="mousemove mouseup";function ee(){this.evEl=q,this.evWin=$,this.pressed=!1,V.apply(this,arguments)}A(ee,V,{handler:function(e){var t=Z[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:j,srcEvent:e}))}});var te={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},ne={2:N,3:"pen",4:j,5:"kinect"},re="pointerdown",ie="pointermove pointerup pointercancel";function se(){this.evEl=re,this.evWin=ie,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(re="MSPointerDown",ie="MSPointerMove MSPointerUp MSPointerCancel"),A(se,V,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),i=te[r],s=ne[e.pointerType]||e.pointerType,o=s==N,a=M(t,e.pointerId,"pointerId");1&i&&(0===e.button||o)?a<0&&(t.push(e),a=t.length-1):12&i&&(n=!0),a<0||(t[a]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:s,srcEvent:e}),n&&t.splice(a,1))}});var oe={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ae(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,V.apply(this,arguments)}function le(e,t){var n=P(e.touches),r=P(e.changedTouches);return 12&t&&(n=I(n.concat(r),"identifier",!0)),[n,r]}A(ae,V,{handler:function(e){var t=oe[e.type];if(1===t&&(this.started=!0),this.started){var n=le.call(this,e,t);12&t&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:N,srcEvent:e})}}});var ce={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ue="touchstart touchmove touchend touchcancel";function he(){this.evTarget=ue,this.targetIds={},V.apply(this,arguments)}function de(e,t){var n=P(e.touches),r=this.targetIds;if(3&t&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,s,o=P(e.changedTouches),a=[],l=this.target;if(s=n.filter((function(e){return x(e.target,l)})),1===t)for(i=0;i<s.length;)r[s[i].identifier]=!0,i++;for(i=0;i<o.length;)r[o[i].identifier]&&a.push(o[i]),12&t&&delete r[o[i].identifier],i++;return a.length?[I(s.concat(a),"identifier",!0),a]:void 0}A(he,V,{handler:function(e){var t=ce[e.type],n=de.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:N,srcEvent:e})}});function fe(){V.apply(this,arguments);var e=_(this.handler,this);this.touch=new he(this.manager,e),this.mouse=new ee(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function pe(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ge.call(this,t)):12&e&&ge.call(this,t)}function ge(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)}),2500)}}function me(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],s=Math.abs(t-i.x),o=Math.abs(n-i.y);if(s<=25&&o<=25)return!0}return!1}A(fe,V,{handler:function(e,t,n){var r=n.pointerType==N,i=n.pointerType==j;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)pe.call(this,t,n);else if(i&&me.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ve=R(u.style,"touchAction"),be=ve!==a,ye="compute",Ae="auto",_e="manipulation",we="none",Ce="pan-x",Ee="pan-y",Be=function(){if(!be)return!1;var e={},t=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){e[n]=!t||i.CSS.supports("touch-action",n)})),e}();function xe(e,t){this.manager=e,this.set(t)}xe.prototype={set:function(e){e==ye&&(e=this.compute()),be&&this.manager.element.style&&Be[e]&&(this.manager.element.style[ve]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return m(this.manager.recognizers,(function(t){w(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(S(e,we))return we;var t=S(e,Ce),n=S(e,Ee);if(t&&n)return we;if(t||n)return t?Ce:Ee;if(S(e,_e))return _e;return Ae}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,i=S(r,we)&&!Be[we],s=S(r,Ee)&&!Be[Ee],o=S(r,Ce)&&!Be[Ce];if(i){var a=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(a&&l&&c)return}if(!o||!s)return i||s&&6&n||o&&n&U?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Se=32;function Te(e){this.options=l({},this.defaults,e||{}),this.id=O++,this.manager=null,this.options.enable=C(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Me(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Pe(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Ie(e,t){var n=t.manager;return n?n.get(e):e}function Re(){Te.apply(this,arguments)}function Oe(){Re.apply(this,arguments),this.pX=null,this.pY=null}function Le(){Re.apply(this,arguments)}function Fe(){Te.apply(this,arguments),this._timer=null,this._input=null}function ke(){Re.apply(this,arguments)}function De(){Re.apply(this,arguments)}function Ne(){Te.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function je(e,t){return(t=t||{}).recognizers=C(t.recognizers,je.defaults.preset),new Ue(e,t)}Te.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(g(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Ie(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return g(e,"dropRecognizeWith",this)||(e=Ie(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(g(e,"requireFailure",this))return this;var t=this.requireFail;return-1===M(t,e=Ie(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(g(e,"dropRequireFailure",this))return this;e=Ie(e,this);var t=M(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<8&&r(t.options.event+Me(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=8&&r(t.options.event+Me(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Se},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!w(this.options.enable,[this,t]))return this.reset(),void(this.state=Se);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},A(Re,Te,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=6&t,i=this.attrTest(e);return r&&(8&n||!i)?16|t:r||i?4&n?8|t:2&t?4|t:2:Se}}),A(Oe,Re,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Ee),e&U&&t.push(Ce),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,i=e.direction,s=e.deltaX,o=e.deltaY;return i&t.direction||(6&t.direction?(i=0===s?1:s<0?2:4,n=s!=this.pX,r=Math.abs(e.deltaX)):(i=0===o?1:o<0?8:16,n=o!=this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&i&t.direction},attrTest:function(e){return Re.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Pe(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),A(Le,Re,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[we]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),A(Fe,Te,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ae]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!r||!n||12&e.eventType&&!i)this.reset();else if(1&e.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return Se},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),A(ke,Re,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[we]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),A(De,Re,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Oe.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:n&U&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Pe(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),A(Ne,Te,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[_e]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=e.eventType)return this.failTimeout();var s=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||Q(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&s?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return Se},failTimeout:function(){return this._timer=p((function(){this.state=Se}),this.options.interval,this),Se},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),je.VERSION="2.0.7",je.defaults={domEvents:!1,touchAction:ye,enable:!0,inputTarget:null,inputClass:null,preset:[[ke,{enable:!1}],[Le,{enable:!1},["rotate"]],[De,{direction:6}],[Oe,{direction:6},["swipe"]],[Ne],[Ne,{event:"doubletap",taps:2},["tap"]],[Fe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Ue(e,t){var n;this.options=l({},je.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((n=this).options.inputClass||(k?se:D?he:F?fe:ee))(n,H),this.touchAction=new xe(this,this.options.touchAction),Ge(this,!0),m(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function Ge(e,t){var n,r=e.element;r.style&&(m(e.options.cssProps,(function(i,s){n=R(r.style,s),t?(e.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=e.oldCssProps[n]||""})),t||(e.oldCssProps={}))}Ue.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var s=0;s<r.length;)n=r[s],2===t.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&14&n.state&&(i=t.curRecognizer=n),s++}},get:function(e){if(e instanceof Te)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(g(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(g(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=M(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==a&&t!==a){var n=this.handlers;return m(T(e),(function(e){n[e]=n[e]||[],n[e].push(t)})),this}},off:function(e,t){if(e!==a){var n=this.handlers;return m(T(e),(function(e){t?n[e]&&n[e].splice(M(n[e],t),1):delete n[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=s.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](t),r++}},destroy:function(){this.element&&Ge(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(je,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Se,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:U,DIRECTION_ALL:30,Manager:Ue,Input:V,TouchAction:xe,TouchInput:he,MouseInput:ee,PointerEventInput:se,TouchMouseInput:fe,SingleTouchInput:ae,Recognizer:Te,AttrRecognizer:Re,Tap:Ne,Pan:Oe,Swipe:De,Pinch:Le,Rotate:ke,Press:Fe,on:E,off:B,each:m,merge:y,extend:b,assign:l,inherit:A,bindFn:_,prefixed:R}),("undefined"!==typeof i?i:"undefined"!==typeof self?self:{}).Hammer=je,(r=function(){return je}.call(t,n,t,e))===a||(e.exports=r)}(window,document)},730:(e,t,n)=>{"use strict";var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function y(e,t,n,r){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,b);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,b);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,b);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var A=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),w=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),S=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function F(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var k,D=Object.assign;function N(e){if(void 0===k)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);k=t&&t[1]||""}return"\n"+k+e}var j=!1;function U(e,t){if(!e||j)return"";j=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==s[a]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{j=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?N(e):""}function G(e){switch(e.tag){case 5:return N(e.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case C:return"Fragment";case w:return"Portal";case B:return"Profiler";case E:return"StrictMode";case M:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case S:return(e.displayName||"Context")+".Consumer";case x:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case I:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return z(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function J(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=J(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=J(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return D({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Z(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function q(e,t){Z(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return D({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function se(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ge(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=D({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ae=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ce=null,Ee=null;function Be(e){if(e=yi(e)){if("function"!==typeof we)throw Error(s(280));var t=e.stateNode;t&&(t=_i(t),we(e.stateNode,e.type,t))}}function xe(e){Ce?Ee?Ee.push(e):Ee=[e]:Ce=e}function Se(){if(Ce){var e=Ce,t=Ee;if(Ee=Ce=null,Be(e),t)for(e=0;e<t.length;e++)Be(t[e])}}function Te(e,t){return e(t)}function Me(){}var Pe=!1;function Ie(e,t,n){if(Pe)return e(t,n);Pe=!0;try{return Te(e,t,n)}finally{Pe=!1,(null!==Ce||null!==Ee)&&(Me(),Se())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=_i(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Oe=!1;if(u)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ue){Oe=!1}function Fe(e,t,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var ke=!1,De=null,Ne=!1,je=null,Ue={onError:function(e){ke=!0,De=e}};function Ge(e,t,n,r,i,s,o,a,l){ke=!1,De=null,Fe.apply(Ue,arguments)}function ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(ze(e)!==e)throw Error(s(188))}function Je(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return He(i),e;if(o===r)return He(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Xe=i.unstable_scheduleCallback,Ke=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Ze=i.unstable_now,qe=i.unstable_getCurrentPriorityLevel,$e=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=ht(a):0!==(s&=o)&&(r=ht(s))}else 0!==(o=n&~i)?r=ht(o):0!==s&&(r=ht(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function bt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var yt=0;function At(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,wt,Ct,Et,Bt,xt=!1,St=[],Tt=null,Mt=null,Pt=null,It=new Map,Rt=new Map,Ot=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ft(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Mt=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":It.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function kt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=yi(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Dt(e){var t=bi(e.target);if(null!==t){var n=ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Bt(e.priority,(function(){Ct(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Nt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=yi(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Ae=r,n.target.dispatchEvent(r),Ae=null,t.shift()}return!0}function jt(e,t,n){Nt(e)&&n.delete(t)}function Ut(){xt=!1,null!==Tt&&Nt(Tt)&&(Tt=null),null!==Mt&&Nt(Mt)&&(Mt=null),null!==Pt&&Nt(Pt)&&(Pt=null),It.forEach(jt),Rt.forEach(jt)}function Gt(e,t){e.blockedOn===t&&(e.blockedOn=null,xt||(xt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function zt(e){function t(t){return Gt(t,e)}if(0<St.length){Gt(St[0],e);for(var n=1;n<St.length;n++){var r=St[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&Gt(Tt,e),null!==Mt&&Gt(Mt,e),null!==Pt&&Gt(Pt,e),It.forEach(t),Rt.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Dt(n),null===n.blockedOn&&Ot.shift()}var Vt=A.ReactCurrentBatchConfig,Ht=!0;function Jt(e,t,n,r){var i=yt,s=Vt.transition;Vt.transition=null;try{yt=1,Xt(e,t,n,r)}finally{yt=i,Vt.transition=s}}function Wt(e,t,n,r){var i=yt,s=Vt.transition;Vt.transition=null;try{yt=4,Xt(e,t,n,r)}finally{yt=i,Vt.transition=s}}function Xt(e,t,n,r){if(Ht){var i=Qt(e,t,n,r);if(null===i)Hr(e,t,r,Kt,n),Ft(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Tt=kt(Tt,e,t,n,r,i),!0;case"dragenter":return Mt=kt(Mt,e,t,n,r,i),!0;case"mouseover":return Pt=kt(Pt,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return It.set(s,kt(It.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Rt.set(s,kt(Rt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ft(e,r),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var s=yi(i);if(null!==s&&_t(s),null===(s=Qt(e,t,n,r))&&Hr(e,t,r,Kt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Kt=null;function Qt(e,t,n,r){if(Kt=null,null!==(e=bi(e=_e(r))))if(null===(t=ze(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qe()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Zt=null,qt=null,$t=null;function en(){if($t)return $t;var e,t,n=qt,r=n.length,i="value"in Zt?Zt.value:Zt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return $t=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return D(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),hn=D({},cn,{view:0,detail:0}),dn=sn(hn),fn=D({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=sn(fn),gn=sn(D({},fn,{dataTransfer:0})),mn=sn(D({},hn,{relatedTarget:0})),vn=sn(D({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=D({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=sn(bn),An=sn(D({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cn[e])&&!!t[e]}function Bn(){return En}var xn=D({},hn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sn=sn(xn),Tn=sn(D({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Mn=sn(D({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bn})),Pn=sn(D({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),In=D({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=sn(In),On=[9,13,27,32],Ln=u&&"CompositionEvent"in window,Fn=null;u&&"documentMode"in document&&(Fn=document.documentMode);var kn=u&&"TextEvent"in window&&!Fn,Dn=u&&(!Ln||Fn&&8<Fn&&11>=Fn),Nn=String.fromCharCode(32),jn=!1;function Un(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Jn(e,t,n,r){xe(r),0<(t=Wr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wn=null,Xn=null;function Kn(e){Nr(e,0)}function Qn(e){if(X(Ai(e)))return e}function Yn(e,t){if("change"===e)return t}var Zn=!1;if(u){var qn;if(u){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}qn=$n}else qn=!1;Zn=qn&&(!document.documentMode||9<document.documentMode)}function tr(){Wn&&(Wn.detachEvent("onpropertychange",nr),Xn=Wn=null)}function nr(e){if("value"===e.propertyName&&Qn(Xn)){var t=[];Jn(t,Xn,e,_e(e)),Ie(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Xn=n,(Wn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Xn)}function sr(e,t){if("click"===e)return Qn(t)}function or(e,t){if("input"===e||"change"===e)return Qn(t)}var ar="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ar(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=ur(n,s);var o=ur(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,vr=null,br=null,yr=!1;function Ar(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yr||null==mr||mr!==K(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&lr(br,r)||(br=r,0<(r=Wr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},Cr={},Er={};function Br(e){if(Cr[e])return Cr[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Cr[e]=n[t];return e}u&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var xr=Br("animationend"),Sr=Br("animationiteration"),Tr=Br("animationstart"),Mr=Br("transitionend"),Pr=new Map,Ir="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Pr.set(e,t),l(t,[e])}for(var Or=0;Or<Ir.length;Or++){var Lr=Ir[Or];Rr(Lr.toLowerCase(),"on"+(Lr[0].toUpperCase()+Lr.slice(1)))}Rr(xr,"onAnimationEnd"),Rr(Sr,"onAnimationIteration"),Rr(Tr,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Mr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fr));function Dr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,l,c){if(Ge.apply(this,arguments),ke){if(!ke)throw Error(s(198));var u=De;ke=!1,De=null,Ne||(Ne=!0,je=u)}}(r,t,void 0,e),e.currentTarget=null}function Nr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Dr(i,a,c),s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Dr(i,a,c),s=l}}}if(Ne)throw e=je,Ne=!1,je=null,e}function jr(e,t){var n=t[gi];void 0===n&&(n=t[gi]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var Gr="_reactListening"+Math.random().toString(36).slice(2);function zr(e){if(!e[Gr]){e[Gr]=!0,o.forEach((function(t){"selectionchange"!==t&&(kr.has(t)||Ur(t,!1,e),Ur(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Gr]||(t[Gr]=!0,Ur("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(Yt(t)){case 1:var i=Jt;break;case 4:i=Wt;break;default:i=Xt}n=i.bind(null,t,n,e),i=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=bi(a)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}a=a.parentNode}}r=r.return}Ie((function(){var r=s,i=_e(n),o=[];e:{var a=Pr.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Sn;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Mn;break;case xr:case Sr:case Tr:l=vn;break;case Mr:l=Pn;break;case"scroll":l=dn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==d&&(null!=(g=Re(p,d))&&u.push(Jr(p,g,f)))),h)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Ae||!(c=n.relatedTarget||n.fromElement)||!bi(c)&&!c[pi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?bi(c):null)&&(c!==(h=ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Tn,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:Ai(l),f=null==c?a:Ai(c),(a=new u(g,p+"leave",l,n,i)).target=h,a.relatedTarget=f,g=null,bi(i)===r&&((u=new u(d,p+"enter",c,n,i)).target=f,u.relatedTarget=h,g=u),h=g,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Xr(f))p++;for(f=0,g=d;g;g=Xr(g))f++;for(;0<p-f;)u=Xr(u),p--;for(;0<f-p;)d=Xr(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Xr(u),d=Xr(d)}u=null}else u=null;null!==l&&Kr(o,a,l,u,!1),null!==c&&null!==h&&Kr(o,h,c,u,!0)}if("select"===(l=(a=r?Ai(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Yn;else if(Hn(a))if(Zn)m=or;else{m=ir;var v=rr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=sr);switch(m&&(m=m(e,r))?Jn(o,m,n,i):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=r?Ai(r):window,e){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(mr=v,vr=r,br=null);break;case"focusout":br=vr=mr=null;break;case"mousedown":yr=!0;break;case"contextmenu":case"mouseup":case"dragend":yr=!1,Ar(o,n,i);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":Ar(o,n,i)}var b;if(Ln)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else zn?Un(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Dn&&"ko"!==n.locale&&(zn||"onCompositionStart"!==y?"onCompositionEnd"===y&&zn&&(b=en()):(qt="value"in(Zt=i)?Zt.value:Zt.textContent,zn=!0)),0<(v=Wr(r,y)).length&&(y=new An(y,e,null,n,i),o.push({event:y,listeners:v}),b?y.data=b:null!==(b=Gn(n))&&(y.data=b))),(b=kn?function(e,t){switch(e){case"compositionend":return Gn(t);case"keypress":return 32!==t.which?null:(jn=!0,Nn);case"textInput":return(e=t.data)===Nn&&jn?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!Ln&&Un(e,t)?(e=en(),$t=qt=Zt=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Wr(r,"onBeforeInput")).length&&(i=new An("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=b))}Nr(o,t)}))}function Jr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Re(e,n))&&r.unshift(Jr(e,s,i)),null!=(s=Re(e,t))&&r.push(Jr(e,s,i))),e=e.return}return r}function Xr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Re(n,s))&&o.unshift(Jr(n,l,a)):i||null!=(l=Re(n,s))&&o.push(Jr(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Qr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Zr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Yr,"")}function qr(e,t,n){if(t=Zr(t),Zr(e)!==t&&n)throw Error(s(425))}function $r(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void zt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);zt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,pi="__reactContainer$"+hi,gi="__reactEvents$"+hi,mi="__reactListeners$"+hi,vi="__reactHandles$"+hi;function bi(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[di])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function yi(e){return!(e=e[di]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Ai(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function _i(e){return e[fi]||null}var wi=[],Ci=-1;function Ei(e){return{current:e}}function Bi(e){0>Ci||(e.current=wi[Ci],wi[Ci]=null,Ci--)}function xi(e,t){Ci++,wi[Ci]=e.current,e.current=t}var Si={},Ti=Ei(Si),Mi=Ei(!1),Pi=Si;function Ii(e,t){var n=e.type.contextTypes;if(!n)return Si;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ri(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oi(){Bi(Mi),Bi(Ti)}function Li(e,t,n){if(Ti.current!==Si)throw Error(s(168));xi(Ti,t),xi(Mi,n)}function Fi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,V(e)||"Unknown",i));return D({},n,r)}function ki(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Si,Pi=Ti.current,xi(Ti,e),xi(Mi,Mi.current),!0}function Di(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Fi(e,t,Pi),r.__reactInternalMemoizedMergedChildContext=e,Bi(Mi),Bi(Ti),xi(Ti,e)):Bi(Mi),xi(Mi,n)}var Ni=null,ji=!1,Ui=!1;function Gi(e){null===Ni?Ni=[e]:Ni.push(e)}function zi(){if(!Ui&&null!==Ni){Ui=!0;var e=0,t=yt;try{var n=Ni;for(yt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ni=null,ji=!1}catch(i){throw null!==Ni&&(Ni=Ni.slice(e+1)),Xe($e,zi),i}finally{yt=t,Ui=!1}}return null}var Vi=[],Hi=0,Ji=null,Wi=0,Xi=[],Ki=0,Qi=null,Yi=1,Zi="";function qi(e,t){Vi[Hi++]=Wi,Vi[Hi++]=Ji,Ji=e,Wi=t}function $i(e,t,n){Xi[Ki++]=Yi,Xi[Ki++]=Zi,Xi[Ki++]=Qi,Qi=e;var r=Yi;e=Zi;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var s=32-ot(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Yi=1<<32-ot(t)+i|n<<i|r,Zi=s+e}else Yi=1<<s|n<<i|r,Zi=e}function es(e){null!==e.return&&(qi(e,1),$i(e,1,0))}function ts(e){for(;e===Ji;)Ji=Vi[--Hi],Vi[Hi]=null,Wi=Vi[--Hi],Vi[Hi]=null;for(;e===Qi;)Qi=Xi[--Ki],Xi[Ki]=null,Zi=Xi[--Ki],Xi[Ki]=null,Yi=Xi[--Ki],Xi[Ki]=null}var ns=null,rs=null,is=!1,ss=null;function os(e,t){var n=Ic(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qi?{id:Yi,overflow:Zi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ic(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(is){var t=rs;if(t){var n=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=ci(n.nextSibling);var r=ns;t&&as(e,t)?os(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!is)return us(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw ds(),Error(s(418));for(;t;)os(e,t),t=ci(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ci(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=rs;e;)e=ci(e.nextSibling)}function fs(){rs=ns=null,is=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var gs=A.ReactCurrentBatchConfig;function ms(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bs(e){return(0,e._init)(e._payload)}function ys(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Dc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===C?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===R&&bs(s)===t.type)?((r=i(t,n.props)).ref=ms(e,t,n),r.return=e,r):((r=Lc(n.type,n.key,n.props,null,e.mode,r)).ref=ms(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Nc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,s){return null===t||7!==t.tag?((t=Fc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Dc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=ms(e,null,t),n.return=e,n;case w:return(t=Nc(t,e.mode,n)).return=e,t;case R:return d(e,(0,t._init)(t._payload),n)}if(te(t)||F(t))return(t=Fc(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===i?c(e,t,n,r):null;case w:return n.key===i?u(e,t,n,r):null;case R:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||F(n))return null!==i?null:h(e,t,n,r,null);vs(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case w:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case R:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||F(r))return h(t,e=e.get(n)||null,r,i,null);vs(t,r)}return null}function g(i,s,a,l){for(var c=null,u=null,h=s,g=s=0,m=null;null!==h&&g<a.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var v=f(i,h,a[g],l);if(null===v){null===h&&(h=m);break}e&&h&&null===v.alternate&&t(i,h),s=o(v,s,g),null===u?c=v:u.sibling=v,u=v,h=m}if(g===a.length)return n(i,h),is&&qi(i,g),c;if(null===h){for(;g<a.length;g++)null!==(h=d(i,a[g],l))&&(s=o(h,s,g),null===u?c=h:u.sibling=h,u=h);return is&&qi(i,g),c}for(h=r(i,h);g<a.length;g++)null!==(m=p(h,i,g,a[g],l))&&(e&&null!==m.alternate&&h.delete(null===m.key?g:m.key),s=o(m,s,g),null===u?c=m:u.sibling=m,u=m);return e&&h.forEach((function(e){return t(i,e)})),is&&qi(i,g),c}function m(i,a,l,c){var u=F(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,g=a,m=a=0,v=null,b=l.next();null!==g&&!b.done;m++,b=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var y=f(i,g,b.value,c);if(null===y){null===g&&(g=v);break}e&&g&&null===y.alternate&&t(i,g),a=o(y,a,m),null===h?u=y:h.sibling=y,h=y,g=v}if(b.done)return n(i,g),is&&qi(i,m),u;if(null===g){for(;!b.done;m++,b=l.next())null!==(b=d(i,b.value,c))&&(a=o(b,a,m),null===h?u=b:h.sibling=b,h=b);return is&&qi(i,m),u}for(g=r(i,g);!b.done;m++,b=l.next())null!==(b=p(g,i,m,b.value,c))&&(e&&null!==b.alternate&&g.delete(null===b.key?m:b.key),a=o(b,a,m),null===h?u=b:h.sibling=b,h=b);return e&&g.forEach((function(e){return t(i,e)})),is&&qi(i,m),u}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===C&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case _:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===C){if(7===u.tag){n(r,u.sibling),(s=i(u,o.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&bs(c)===u.type){n(r,u.sibling),(s=i(u,o.props)).ref=ms(r,u,o),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}o.type===C?((s=Fc(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Lc(o.type,o.key,o.props,null,r.mode,l)).ref=ms(r,s,o),l.return=r,r=l)}return a(r);case w:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=i(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Nc(o,r.mode,l)).return=r,r=s}return a(r);case R:return e(r,s,(u=o._init)(o._payload),l)}if(te(o))return g(r,s,o,l);if(F(o))return m(r,s,o,l);vs(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,o)).return=r,r=s):(n(r,s),(s=Dc(o,r.mode,l)).return=r,r=s),a(r)):n(r,s)}}var As=ys(!0),_s=ys(!1),ws=Ei(null),Cs=null,Es=null,Bs=null;function xs(){Bs=Es=Cs=null}function Ss(e){var t=ws.current;Bi(ws),e._currentValue=t}function Ts(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ms(e,t){Cs=e,Bs=Es=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ya=!0),e.firstContext=null)}function Ps(e){var t=e._currentValue;if(Bs!==e)if(e={context:e,memoizedValue:t,next:null},null===Es){if(null===Cs)throw Error(s(308));Es=e,Cs.dependencies={lanes:0,firstContext:e}}else Es=Es.next=e;return t}var Is=null;function Rs(e){null===Is?Is=[e]:Is.push(e)}function Os(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Rs(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ls(e,r)}function Ls(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Fs=!1;function ks(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ds(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ns(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function js(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Tl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ls(e,n)}return null===(i=r.interleaved)?(t.next=t,Rs(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ls(e,n)}function Us(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}function Gs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function zs(e,t,n,r){var i=e.updateQueue;Fs=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=i.baseState;for(o=0,u=c=l=null,a=s;;){var d=a.lane,f=a.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(d=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=g.payload)?p.call(f,h,d):p)||void 0===d)break e;h=D({},h,d);break e;case 2:Fs=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(d=a).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);kl|=o,e.lanes=o,e.memoizedState=h}}function Vs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var Hs={},Js=Ei(Hs),Ws=Ei(Hs),Xs=Ei(Hs);function Ks(e){if(e===Hs)throw Error(s(174));return e}function Qs(e,t){switch(xi(Xs,t),xi(Ws,e),xi(Js,Hs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Bi(Js),xi(Js,t)}function Ys(){Bi(Js),Bi(Ws),Bi(Xs)}function Zs(e){Ks(Xs.current);var t=Ks(Js.current),n=le(t,e.type);t!==n&&(xi(Ws,e),xi(Js,n))}function qs(e){Ws.current===e&&(Bi(Js),Bi(Ws))}var $s=Ei(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var ro=A.ReactCurrentDispatcher,io=A.ReactCurrentBatchConfig,so=0,oo=null,ao=null,lo=null,co=!1,uo=!1,ho=0,fo=0;function po(){throw Error(s(321))}function go(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function mo(e,t,n,r,i,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=null===e||null===e.memoizedState?$o:ea,e=n(r,i),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(s(301));o+=1,lo=ao=null,t.updateQueue=null,ro.current=ta,e=n(r,i)}while(uo)}if(ro.current=qo,t=null!==ao&&null!==ao.next,so=0,lo=ao=oo=null,co=!1,t)throw Error(s(300));return e}function vo(){var e=0!==ho;return ho=0,e}function bo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function yo(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,ao=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function Ao(e,t){return"function"===typeof t?t(e):t}function _o(e){var t=yo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=ao,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((so&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=r):c=c.next=d,oo.lanes|=h,kl|=h}u=u.next}while(null!==u&&u!==o);null===c?a=r:c.next=l,ar(r,t.memoizedState)||(ya=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,oo.lanes|=o,kl|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wo(e){var t=yo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);ar(o,t.memoizedState)||(ya=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Co(){}function Eo(e,t){var n=oo,r=yo(),i=t(),o=!ar(r.memoizedState,i);if(o&&(r.memoizedState=i,ya=!0),r=r.queue,ko(So.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Io(9,xo.bind(null,n,r,i,t),void 0,null),null===Ml)throw Error(s(349));0!==(30&so)||Bo(n,t,i)}return i}function Bo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function xo(e,t,n,r){t.value=n,t.getSnapshot=r,To(t)&&Mo(e)}function So(e,t,n){return n((function(){To(t)&&Mo(e)}))}function To(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function Mo(e){var t=Ls(e,1);null!==t&&nc(t,e,1,-1)}function Po(e){var t=bo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ao,lastRenderedState:e},t.queue=e,e=e.dispatch=Ko.bind(null,oo,e),[t.memoizedState,e]}function Io(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ro(){return yo().memoizedState}function Oo(e,t,n,r){var i=bo();oo.flags|=e,i.memoizedState=Io(1|t,n,void 0,void 0===r?null:r)}function Lo(e,t,n,r){var i=yo();r=void 0===r?null:r;var s=void 0;if(null!==ao){var o=ao.memoizedState;if(s=o.destroy,null!==r&&go(r,o.deps))return void(i.memoizedState=Io(t,n,s,r))}oo.flags|=e,i.memoizedState=Io(1|t,n,s,r)}function Fo(e,t){return Oo(8390656,8,e,t)}function ko(e,t){return Lo(2048,8,e,t)}function Do(e,t){return Lo(4,2,e,t)}function No(e,t){return Lo(4,4,e,t)}function jo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Uo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Lo(4,4,jo.bind(null,t,e),n)}function Go(){}function zo(e,t){var n=yo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&go(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Vo(e,t){var n=yo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&go(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ho(e,t,n){return 0===(21&so)?(e.baseState&&(e.baseState=!1,ya=!0),e.memoizedState=n):(ar(n,t)||(n=gt(),oo.lanes|=n,kl|=n,e.baseState=!0),t)}function Jo(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var r=io.transition;io.transition={};try{e(!1),t()}finally{yt=n,io.transition=r}}function Wo(){return yo().memoizedState}function Xo(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qo(e))Yo(t,n);else if(null!==(n=Os(e,t,n,r))){nc(n,e,r,ec()),Zo(n,t,r)}}function Ko(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qo(e))Yo(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,o)){var l=t.interleaved;return null===l?(i.next=i,Rs(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Os(e,t,i,r))&&(nc(n,e,r,i=ec()),Zo(n,t,r))}}function Qo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Yo(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Zo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}var qo={readContext:Ps,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useInsertionEffect:po,useLayoutEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useMutableSource:po,useSyncExternalStore:po,useId:po,unstable_isNewReconciler:!1},$o={readContext:Ps,useCallback:function(e,t){return bo().memoizedState=[e,void 0===t?null:t],e},useContext:Ps,useEffect:Fo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oo(4194308,4,jo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Oo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oo(4,2,e,t)},useMemo:function(e,t){var n=bo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=bo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Xo.bind(null,oo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},bo().memoizedState=e},useState:Po,useDebugValue:Go,useDeferredValue:function(e){return bo().memoizedState=e},useTransition:function(){var e=Po(!1),t=e[0];return e=Jo.bind(null,e[1]),bo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oo,i=bo();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Ml)throw Error(s(349));0!==(30&so)||Bo(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Fo(So.bind(null,r,o,e),[e]),r.flags|=2048,Io(9,xo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=bo(),t=Ml.identifierPrefix;if(is){var n=Zi;t=":"+t+"R"+(n=(Yi&~(1<<32-ot(Yi)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Ps,useCallback:zo,useContext:Ps,useEffect:ko,useImperativeHandle:Uo,useInsertionEffect:Do,useLayoutEffect:No,useMemo:Vo,useReducer:_o,useRef:Ro,useState:function(){return _o(Ao)},useDebugValue:Go,useDeferredValue:function(e){return Ho(yo(),ao.memoizedState,e)},useTransition:function(){return[_o(Ao)[0],yo().memoizedState]},useMutableSource:Co,useSyncExternalStore:Eo,useId:Wo,unstable_isNewReconciler:!1},ta={readContext:Ps,useCallback:zo,useContext:Ps,useEffect:ko,useImperativeHandle:Uo,useInsertionEffect:Do,useLayoutEffect:No,useMemo:Vo,useReducer:wo,useRef:Ro,useState:function(){return wo(Ao)},useDebugValue:Go,useDeferredValue:function(e){var t=yo();return null===ao?t.memoizedState=e:Ho(t,ao.memoizedState,e)},useTransition:function(){return[wo(Ao)[0],yo().memoizedState]},useMutableSource:Co,useSyncExternalStore:Eo,useId:Wo,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=D({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ra(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:D({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ia={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=Ns(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=js(e,s,i))&&(nc(t,e,i,r),Us(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=Ns(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=js(e,s,i))&&(nc(t,e,i,r),Us(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=Ns(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=js(e,i,r))&&(nc(t,e,r,n),Us(t,e,r))}};function sa(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function oa(e,t,n){var r=!1,i=Si,s=t.contextType;return"object"===typeof s&&null!==s?s=Ps(s):(i=Ri(t)?Pi:Ti.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ii(e,i):Si),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ia,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function aa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ia.enqueueReplaceState(t,t.state,null)}function la(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},ks(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Ps(s):(s=Ri(t)?Pi:Ti.current,i.context=Ii(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ra(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ia.enqueueReplaceState(i,i.state,null),zs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var n="",r=t;do{n+=G(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var da="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Ns(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hl||(Hl=!0,Jl=r),ha(0,t)},n}function pa(e,t,n){(n=Ns(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ha(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ha(0,t),"function"!==typeof r&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ga(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new da;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Bc.bind(null,e,t,n),t.then(e,e))}function ma(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ns(-1,1)).tag=2,js(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ba=A.ReactCurrentOwner,ya=!1;function Aa(e,t,n,r){t.child=null===e?_s(t,null,n,r):As(t,e.child,n,r)}function _a(e,t,n,r,i){n=n.render;var s=t.ref;return Ms(t,i),r=mo(e,t,n,r,s,i),n=vo(),null===e||ya?(is&&n&&es(t),t.flags|=1,Aa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ha(e,t,i))}function wa(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Rc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ca(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return Ha(e,t,i)}return t.flags|=1,(e=Oc(s,r)).ref=t.ref,e.return=t,t.child=e}function Ca(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(ya=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Ha(e,t,i);0!==(131072&e.flags)&&(ya=!0)}}return xa(e,t,n,r,i)}function Ea(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},xi(Ol,Rl),Rl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,xi(Ol,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,xi(Ol,Rl),Rl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,xi(Ol,Rl),Rl|=r;return Aa(e,t,i,n),t.child}function Ba(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function xa(e,t,n,r,i){var s=Ri(n)?Pi:Ti.current;return s=Ii(t,s),Ms(t,i),n=mo(e,t,n,r,s,i),r=vo(),null===e||ya?(is&&r&&es(t),t.flags|=1,Aa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ha(e,t,i))}function Sa(e,t,n,r,i){if(Ri(n)){var s=!0;ki(t)}else s=!1;if(Ms(t,i),null===t.stateNode)Va(e,t),oa(t,n,r),la(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ps(c):c=Ii(t,c=Ri(n)?Pi:Ti.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||l!==c)&&aa(t,o,r,c),Fs=!1;var d=t.memoizedState;o.state=d,zs(t,r,o,i),l=t.memoizedState,a!==r||d!==l||Mi.current||Fs?("function"===typeof u&&(ra(t,n,u,r),l=t.memoizedState),(a=Fs||sa(t,n,a,r,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Ds(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:na(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ps(l):l=Ii(t,l=Ri(n)?Pi:Ti.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&aa(t,o,r,l),Fs=!1,d=t.memoizedState,o.state=d,zs(t,r,o,i);var p=t.memoizedState;a!==h||d!==p||Mi.current||Fs?("function"===typeof f&&(ra(t,n,f,r),p=t.memoizedState),(c=Fs||sa(t,n,c,r,d,p,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Ta(e,t,n,r,s,i)}function Ta(e,t,n,r,i,s){Ba(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Di(t,n,!1),Ha(e,t,s);r=t.stateNode,ba.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=As(t,e.child,null,s),t.child=As(t,null,a,s)):Aa(e,t,a,s),t.memoizedState=r.state,i&&Di(t,n,!0),t.child}function Ma(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),Qs(e,t.containerInfo)}function Pa(e,t,n,r,i){return fs(),ps(i),t.flags|=256,Aa(e,t,n,r),t.child}var Ia,Ra,Oa,La,Fa={dehydrated:null,treeContext:null,retryLane:0};function ka(e){return{baseLanes:e,cachePool:null,transitions:null}}function Da(e,t,n){var r,i=t.pendingProps,o=$s.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),xi($s,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=kc(l,i,0,null),e=Fc(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=ka(n),t.memoizedState=Fa,e):Na(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,ja(e,t,a,r=ua(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=kc({mode:"visible",children:r.children},i,0,null),(o=Fc(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&As(t,e.child,null,a),t.child.memoizedState=ka(a),t.memoizedState=Fa,o);if(0===(1&t.mode))return ja(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,ja(e,t,a,r=ua(o=Error(s(419)),r,void 0))}if(l=0!==(a&e.childLanes),ya||l){if(null!==(r=Ml)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Ls(e,i),nc(r,e,i,-1))}return gc(),ja(e,t,a,r=ua(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Sc.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,rs=ci(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(Xi[Ki++]=Yi,Xi[Ki++]=Zi,Xi[Ki++]=Qi,Yi=e.id,Zi=e.overflow,Qi=t),t=Na(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(a){a=i.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Oc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=Oc(r,a):(a=Fc(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?ka(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Fa,i}return e=(a=e.child).sibling,i=Oc(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Na(e,t){return(t=kc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function ja(e,t,n,r){return null!==r&&ps(r),As(t,e.child,null,n),(e=Na(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ua(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ts(e.return,t,n)}function Ga(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function za(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Aa(e,t,r.children,n),0!==(2&(r=$s.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ua(e,n,t);else if(19===e.tag)Ua(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(xi($s,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ga(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===eo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ga(t,!0,n,null,s);break;case"together":Ga(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Va(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ha(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),kl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ja(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Wa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Xa(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wa(t),null;case 1:case 17:return Ri(t.type)&&Oi(),Wa(t),null;case 3:return r=t.stateNode,Ys(),Bi(Mi),Bi(Ti),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(oc(ss),ss=null))),Ra(e,t),Wa(t),null;case 5:qs(t);var i=Ks(Xs.current);if(n=t.type,null!==e&&null!=t.stateNode)Oa(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Wa(t),null}if(e=Ks(Js.current),hs(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[di]=t,r[fi]=o,e=0!==(1&t.mode),n){case"dialog":jr("cancel",r),jr("close",r);break;case"iframe":case"object":case"embed":jr("load",r);break;case"video":case"audio":for(i=0;i<Fr.length;i++)jr(Fr[i],r);break;case"source":jr("error",r);break;case"img":case"image":case"link":jr("error",r),jr("load",r);break;case"details":jr("toggle",r);break;case"input":Y(r,o),jr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},jr("invalid",r);break;case"textarea":ie(r,o),jr("invalid",r)}for(var l in be(n,o),i=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&qr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&qr(r.textContent,c,e),i=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&jr("scroll",r)}switch(n){case"input":W(r),$(r,o,!0);break;case"textarea":W(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=$r)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[di]=t,e[fi]=r,Ia(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(n,r),n){case"dialog":jr("cancel",e),jr("close",e),i=r;break;case"iframe":case"object":case"embed":jr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Fr.length;i++)jr(Fr[i],e);i=r;break;case"source":jr("error",e),i=r;break;case"img":case"image":case"link":jr("error",e),jr("load",e),i=r;break;case"details":jr("toggle",e),i=r;break;case"input":Y(e,r),i=Q(e,r),jr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=D({},r,{value:void 0}),jr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),jr("invalid",e)}for(o in be(n,i),c=i)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?me(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&jr("scroll",e):null!=u&&y(e,o,u,l))}switch(n){case"input":W(e),$(e,r,!1);break;case"textarea":W(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wa(t),null;case 6:if(e&&null!=t.stateNode)La(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Ks(Xs.current),Ks(Js.current),hs(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(o=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:qr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&qr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return Wa(t),null;case 13:if(Bi($s),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))ds(),fs(),t.flags|=98560,o=!1;else if(o=hs(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[di]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wa(t),o=!1}else null!==ss&&(oc(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&$s.current)?0===Ll&&(Ll=3):gc())),null!==t.updateQueue&&(t.flags|=4),Wa(t),null);case 4:return Ys(),Ra(e,t),null===e&&zr(t.stateNode.containerInfo),Wa(t),null;case 10:return Ss(t.type._context),Wa(t),null;case 19:if(Bi($s),null===(o=t.memoizedState))return Wa(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Ja(o,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,Ja(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return xi($s,1&$s.current|2),t.child}e=e.sibling}null!==o.tail&&Ze()>zl&&(t.flags|=128,r=!0,Ja(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=eo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ja(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!is)return Wa(t),null}else 2*Ze()-o.renderingStartTime>zl&&1073741824!==n&&(t.flags|=128,r=!0,Ja(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ze(),t.sibling=null,n=$s.current,xi($s,r?1&n|2:1&n),t):(Wa(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Rl)&&(Wa(t),6&t.subtreeFlags&&(t.flags|=8192)):Wa(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ka(e,t){switch(ts(t),t.tag){case 1:return Ri(t.type)&&Oi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ys(),Bi(Mi),Bi(Ti),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return qs(t),null;case 13:if(Bi($s),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Bi($s),null;case 4:return Ys(),null;case 10:return Ss(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ia=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ra=function(){},Oa=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ks(Js.current);var s,o=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),o=[];break;case"select":i=D({},i,{value:void 0}),r=D({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(u in be(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&jr("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},La=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qa=!1,Ya=!1,Za="function"===typeof WeakSet?WeakSet:Set,qa=null;function $a(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ec(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Ec(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&el(t,n,s)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[gi],delete t[mi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,hl=!1;function dl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Ya||$a(n,t);case 6:var r=ul,i=hl;ul=null,dl(e,t,n),hl=i,null!==(ul=r)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),zt(e)):li(ul,n.stateNode));break;case 4:r=ul,i=hl,ul=n.stateNode.containerInfo,hl=!0,dl(e,t,n),ul=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Ya&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&el(n,t,o),i=i.next}while(i!==r)}dl(e,t,n);break;case 1:if(!Ya&&($a(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ec(n,t,a)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Ya=(r=Ya)||null!==n.memoizedState,dl(e,t,n),Ya=r):dl(e,t,n);break;default:dl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Za),t.forEach((function(t){var r=Tc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));fl(o,a,i),ul=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Ec(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(m){Ec(e,e.return,m)}try{nl(5,e,e.return)}catch(m){Ec(e,e.return,m)}}break;case 1:gl(t,e),vl(e),512&r&&null!==n&&$a(n,n.return);break;case 5:if(gl(t,e),vl(e),512&r&&null!==n&&$a(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(m){Ec(e,e.return,m)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&Z(i,o),ye(l,a);var u=ye(l,o);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?me(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):y(i,h,d,u)}switch(l){case"input":q(i,o);break;case"textarea":se(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(m){Ec(e,e.return,m)}}break;case 6:if(gl(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(m){Ec(e,e.return,m)}}break;case 3:if(gl(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(m){Ec(e,e.return,m)}break;case 4:default:gl(t,e),vl(e);break;case 13:gl(t,e),vl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Gl=Ze())),4&r&&pl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ya=(u=Ya)||h,gl(t,e),Ya=u):gl(t,e),vl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(qa=e,h=e.child;null!==h;){for(d=qa=h;null!==qa;){switch(p=(f=qa).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:$a(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){r=f,n=f.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Ec(r,n,m)}}break;case 5:$a(f,f.return);break;case 22:if(null!==f.memoizedState){_l(d);continue}}null!==p?(p.return=f,qa=p):_l(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",a))}catch(m){Ec(e,e.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Ec(e,e.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gl(t,e),vl(e),4&r&&pl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),cl(e,al(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;ll(e,al(e),o);break;default:throw Error(s(161))}}catch(a){Ec(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){qa=e,yl(e,t,n)}function yl(e,t,n){for(var r=0!==(1&e.mode);null!==qa;){var i=qa,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Qa;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Ya;a=Qa;var c=Ya;if(Qa=o,(Ya=l)&&!c)for(qa=i;null!==qa;)l=(o=qa).child,22===o.tag&&null!==o.memoizedState?wl(i):null!==l?(l.return=o,qa=l):wl(i);for(;null!==s;)qa=s,yl(s,t,n),s=s.sibling;qa=i,Qa=a,Ya=c}Al(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,qa=s):Al(e)}}function Al(e){for(;null!==qa;){var t=qa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ya||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ya)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Vs(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&zt(d)}}}break;default:throw Error(s(163))}Ya||512&t.flags&&il(t)}catch(f){Ec(t,t.return,f)}}if(t===e){qa=null;break}if(null!==(n=t.sibling)){n.return=t.return,qa=n;break}qa=t.return}}function _l(e){for(;null!==qa;){var t=qa;if(t===e){qa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,qa=n;break}qa=t.return}}function wl(e){for(;null!==qa;){var t=qa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Ec(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Ec(t,i,l)}}var s=t.return;try{il(t)}catch(l){Ec(t,s,l)}break;case 5:var o=t.return;try{il(t)}catch(l){Ec(t,o,l)}}}catch(l){Ec(t,t.return,l)}if(t===e){qa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,qa=a;break}qa=t.return}}var Cl,El=Math.ceil,Bl=A.ReactCurrentDispatcher,xl=A.ReactCurrentOwner,Sl=A.ReactCurrentBatchConfig,Tl=0,Ml=null,Pl=null,Il=0,Rl=0,Ol=Ei(0),Ll=0,Fl=null,kl=0,Dl=0,Nl=0,jl=null,Ul=null,Gl=0,zl=1/0,Vl=null,Hl=!1,Jl=null,Wl=null,Xl=!1,Kl=null,Ql=0,Yl=0,Zl=null,ql=-1,$l=0;function ec(){return 0!==(6&Tl)?Ze():-1!==ql?ql:ql=Ze()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Tl)&&0!==Il?Il&-Il:null!==gs.transition?(0===$l&&($l=gt()),$l):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function nc(e,t,n,r){if(50<Yl)throw Yl=0,Zl=null,Error(s(185));vt(e,n,r),0!==(2&Tl)&&e===Ml||(e===Ml&&(0===(2&Tl)&&(Dl|=n),4===Ll&&ac(e,Il)),rc(e,r),1===n&&0===Tl&&0===(1&t.mode)&&(zl=Ze()+500,ji&&zi()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=ft(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=dt(e,e===Ml?Il:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){ji=!0,Gi(e)}(lc.bind(null,e)):Gi(lc.bind(null,e)),oi((function(){0===(6&Tl)&&zi()})),n=null;else{switch(At(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Mc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(ql=-1,$l=0,0!==(6&Tl))throw Error(s(327));var n=e.callbackNode;if(wc()&&e.callbackNode!==n)return null;var r=dt(e,e===Ml?Il:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mc(e,r);else{t=r;var i=Tl;Tl|=2;var o=pc();for(Ml===e&&Il===t||(Vl=null,zl=Ze()+500,dc(e,t));;)try{bc();break}catch(l){fc(e,l)}xs(),Bl.current=o,Tl=i,null!==Pl?t=0:(Ml=null,Il=0,t=Ll)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=sc(e,i))),1===t)throw n=Fl,dc(e,0),ac(e,r),rc(e,Ze()),n;if(6===t)ac(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ar(s(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=mc(e,r))&&(0!==(o=pt(e))&&(r=o,t=sc(e,o))),1===t))throw n=Fl,dc(e,0),ac(e,r),rc(e,Ze()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:_c(e,Ul,Vl);break;case 3:if(ac(e,r),(130023424&r)===r&&10<(t=Gl+500-Ze())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(_c.bind(null,e,Ul,Vl),t);break}_c(e,Ul,Vl);break;case 4:if(ac(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-ot(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=Ze()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*El(r/1960))-r)){e.timeoutHandle=ri(_c.bind(null,e,Ul,Vl),r);break}_c(e,Ul,Vl);break;default:throw Error(s(329))}}}return rc(e,Ze()),e.callbackNode===n?ic.bind(null,e):null}function sc(e,t){var n=jl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Ul,Ul=n,null!==t&&oc(t)),e}function oc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function ac(e,t){for(t&=~Nl,t&=~Dl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Tl))throw Error(s(327));wc();var t=dt(e,0);if(0===(1&t))return rc(e,Ze()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Fl,dc(e,0),ac(e,t),rc(e,Ze()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_c(e,Ul,Vl),rc(e,Ze()),null}function cc(e,t){var n=Tl;Tl|=1;try{return e(t)}finally{0===(Tl=n)&&(zl=Ze()+500,ji&&zi())}}function uc(e){null!==Kl&&0===Kl.tag&&0===(6&Tl)&&wc();var t=Tl;Tl|=1;var n=Sl.transition,r=yt;try{if(Sl.transition=null,yt=1,e)return e()}finally{yt=r,Sl.transition=n,0===(6&(Tl=t))&&zi()}}function hc(){Rl=Ol.current,Bi(Ol)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Pl)for(n=Pl.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oi();break;case 3:Ys(),Bi(Mi),Bi(Ti),no();break;case 5:qs(r);break;case 4:Ys();break;case 13:case 19:Bi($s);break;case 10:Ss(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Ml=e,Pl=e=Oc(e.current,null),Il=Rl=t,Ll=0,Fl=null,Nl=Dl=kl=0,Ul=jl=null,null!==Is){for(t=0;t<Is.length;t++)if(null!==(r=(n=Is[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}Is=null}return e}function fc(e,t){for(;;){var n=Pl;try{if(xs(),ro.current=qo,co){for(var r=oo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}co=!1}if(so=0,lo=ao=oo=null,uo=!1,ho=0,xl.current=null,null===n||null===n.return){Ll=1,Fl=t,Pl=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Il,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ma(a);if(null!==p){p.flags&=-257,va(p,a,l,0,t),1&p.mode&&ga(o,u,t),c=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){ga(o,u,t),gc();break e}c=Error(s(426))}else if(is&&1&l.mode){var v=ma(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),va(v,a,l,0,t),ps(ca(c,l));break e}}o=c=ca(c,l),4!==Ll&&(Ll=2),null===jl?jl=[o]:jl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Gs(o,fa(0,c,t));break e;case 1:l=c;var b=o.type,y=o.stateNode;if(0===(128&o.flags)&&("function"===typeof b.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Wl||!Wl.has(y)))){o.flags|=65536,t&=-t,o.lanes|=t,Gs(o,pa(o,l,t));break e}}o=o.return}while(null!==o)}Ac(n)}catch(A){t=A,Pl===n&&null!==n&&(Pl=n=n.return);continue}break}}function pc(){var e=Bl.current;return Bl.current=qo,null===e?qo:e}function gc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Ml||0===(268435455&kl)&&0===(268435455&Dl)||ac(Ml,Il)}function mc(e,t){var n=Tl;Tl|=2;var r=pc();for(Ml===e&&Il===t||(Vl=null,dc(e,t));;)try{vc();break}catch(i){fc(e,i)}if(xs(),Tl=n,Bl.current=r,null!==Pl)throw Error(s(261));return Ml=null,Il=0,Ll}function vc(){for(;null!==Pl;)yc(Pl)}function bc(){for(;null!==Pl&&!Qe();)yc(Pl)}function yc(e){var t=Cl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?Ac(e):Pl=t,xl.current=null}function Ac(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xa(n,t,Rl)))return void(Pl=n)}else{if(null!==(n=Ka(n,t)))return n.flags&=32767,void(Pl=n);if(null===e)return Ll=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Ll&&(Ll=5)}function _c(e,t,n){var r=yt,i=Sl.transition;try{Sl.transition=null,yt=1,function(e,t,n,r){do{wc()}while(null!==Kl);if(0!==(6&Tl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,o),e===Ml&&(Pl=Ml=null,Il=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xl||(Xl=!0,Mc(tt,(function(){return wc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Sl.transition,Sl.transition=null;var a=yt;yt=1;var l=Tl;Tl|=4,xl.current=null,function(e,t){if(ei=Ht,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(_){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==o||0!==r&&3!==d.nodeType||(c=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=a),f===o&&++h===r&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Ht=!1,qa=t;null!==qa;)if(e=(t=qa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,qa=e;else for(;null!==qa;){t=qa;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?m:na(t.type,m),v);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var A=t.stateNode.containerInfo;1===A.nodeType?A.textContent="":9===A.nodeType&&A.documentElement&&A.removeChild(A.documentElement);break;default:throw Error(s(163))}}catch(_){Ec(t,t.return,_)}if(null!==(e=t.sibling)){e.return=t.return,qa=e;break}qa=t.return}g=tl,tl=!1}(e,n),ml(n,e),pr(ti),Ht=!!ei,ti=ei=null,e.current=n,bl(n,e,i),Ye(),Tl=l,yt=a,Sl.transition=o}else e.current=n;if(Xl&&(Xl=!1,Kl=e,Ql=i),o=e.pendingLanes,0===o&&(Wl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Ze()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hl)throw Hl=!1,e=Jl,Jl=null,e;0!==(1&Ql)&&0!==e.tag&&wc(),o=e.pendingLanes,0!==(1&o)?e===Zl?Yl++:(Yl=0,Zl=e):Yl=0,zi()}(e,t,n,r)}finally{Sl.transition=i,yt=r}return null}function wc(){if(null!==Kl){var e=At(Ql),t=Sl.transition,n=yt;try{if(Sl.transition=null,yt=16>e?16:e,null===Kl)var r=!1;else{if(e=Kl,Kl=null,Ql=0,0!==(6&Tl))throw Error(s(331));var i=Tl;for(Tl|=4,qa=e.current;null!==qa;){var o=qa,a=o.child;if(0!==(16&qa.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(qa=u;null!==qa;){var h=qa;switch(h.tag){case 0:case 11:case 15:nl(8,h,o)}var d=h.child;if(null!==d)d.return=h,qa=d;else for(;null!==qa;){var f=(h=qa).sibling,p=h.return;if(sl(h),h===u){qa=null;break}if(null!==f){f.return=p,qa=f;break}qa=p}}}var g=o.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}qa=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,qa=a;else e:for(;null!==qa;){if(0!==(2048&(o=qa).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var b=o.sibling;if(null!==b){b.return=o.return,qa=b;break e}qa=o.return}}var y=e.current;for(qa=y;null!==qa;){var A=(a=qa).child;if(0!==(2064&a.subtreeFlags)&&null!==A)A.return=a,qa=A;else e:for(a=y;null!==qa;){if(0!==(2048&(l=qa).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(w){Ec(l,l.return,w)}if(l===a){qa=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,qa=_;break e}qa=l.return}}if(Tl=i,zi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(w){}r=!0}return r}finally{yt=n,Sl.transition=t}}return!1}function Cc(e,t,n){e=js(e,t=fa(0,t=ca(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),rc(e,t))}function Ec(e,t,n){if(3===e.tag)Cc(e,e,n);else for(;null!==t;){if(3===t.tag){Cc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Wl||!Wl.has(r))){t=js(t,e=pa(t,e=ca(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function Bc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Ml===e&&(Il&n)===n&&(4===Ll||3===Ll&&(130023424&Il)===Il&&500>Ze()-Gl?dc(e,0):Nl|=n),rc(e,t)}function xc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Ls(e,t))&&(vt(e,t,n),rc(e,n))}function Sc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),xc(e,n)}function Tc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),xc(e,n)}function Mc(e,t){return Xe(e,t)}function Pc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(e,t,n,r){return new Pc(e,t,n,r)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=Ic(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Rc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case C:return Fc(n.children,i,o,t);case E:a=8,i|=8;break;case B:return(e=Ic(12,n,t,2|i)).elementType=B,e.lanes=o,e;case M:return(e=Ic(13,n,t,i)).elementType=M,e.lanes=o,e;case P:return(e=Ic(19,n,t,i)).elementType=P,e.lanes=o,e;case O:return kc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case x:a=10;break e;case S:a=9;break e;case T:a=11;break e;case I:a=14;break e;case R:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ic(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Fc(e,t,n,r){return(e=Ic(7,e,r,t)).lanes=n,e}function kc(e,t,n,r){return(e=Ic(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Dc(e,t,n){return(e=Ic(6,e,null,t)).lanes=n,e}function Nc(e,t,n){return(t=Ic(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,r,i,s,o,a,l){return e=new jc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ic(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ks(s),e}function Gc(e){if(!e)return Si;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Ri(n))return Fi(e,n,t)}return t}function zc(e,t,n,r,i,s,o,a,l){return(e=Uc(n,r,!0,e,0,s,0,a,l)).context=Gc(null),n=e.current,(s=Ns(r=ec(),i=tc(n))).callback=void 0!==t&&null!==t?t:null,js(n,s,i),e.current.lanes=i,vt(e,i,r),rc(e,r),e}function Vc(e,t,n,r){var i=t.current,s=ec(),o=tc(i);return n=Gc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ns(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=js(i,t,o))&&(nc(e,i,o,s),Us(e,i,o)),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Jc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wc(e,t){Jc(e,t),(e=e.alternate)&&Jc(e,t)}Cl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Mi.current)ya=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ya=!1,function(e,t,n){switch(t.tag){case 3:Ma(t),fs();break;case 5:Zs(t);break;case 1:Ri(t.type)&&ki(t);break;case 4:Qs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;xi(ws,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(xi($s,1&$s.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Da(e,t,n):(xi($s,1&$s.current),null!==(e=Ha(e,t,n))?e.sibling:null);xi($s,1&$s.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return za(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),xi($s,$s.current),r)break;return null;case 22:case 23:return t.lanes=0,Ea(e,t,n)}return Ha(e,t,n)}(e,t,n);ya=0!==(131072&e.flags)}else ya=!1,is&&0!==(1048576&t.flags)&&$i(t,Wi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Va(e,t),e=t.pendingProps;var i=Ii(t,Ti.current);Ms(t,n),i=mo(null,t,r,e,i,n);var o=vo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(r)?(o=!0,ki(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,ks(t),i.updater=ia,t.stateNode=i,i._reactInternals=t,la(t,r,e,n),t=Ta(null,t,r,!0,o,n)):(t.tag=0,is&&o&&es(t),Aa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Va(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Rc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===I)return 14}return 2}(r),e=na(r,e),i){case 0:t=xa(null,t,r,e,n);break e;case 1:t=Sa(null,t,r,e,n);break e;case 11:t=_a(null,t,r,e,n);break e;case 14:t=wa(null,t,r,na(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,xa(e,t,r,i=t.elementType===r?i:na(r,i),n);case 1:return r=t.type,i=t.pendingProps,Sa(e,t,r,i=t.elementType===r?i:na(r,i),n);case 3:e:{if(Ma(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,Ds(e,t),zs(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Pa(e,t,r,n,i=ca(Error(s(423)),t));break e}if(r!==i){t=Pa(e,t,r,n,i=ca(Error(s(424)),t));break e}for(rs=ci(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=_s(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),r===i){t=Ha(e,t,n);break e}Aa(e,t,r,n)}t=t.child}return t;case 5:return Zs(t),null===e&&cs(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==o&&ni(r,o)&&(t.flags|=32),Ba(e,t),Aa(e,t,a,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Da(e,t,n);case 4:return Qs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=As(t,null,r,n):Aa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,_a(e,t,r,i=t.elementType===r?i:na(r,i),n);case 7:return Aa(e,t,t.pendingProps,n),t.child;case 8:case 12:return Aa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,xi(ws,r._currentValue),r._currentValue=a,null!==o)if(ar(o.value,a)){if(o.children===i.children&&!Mi.current){t=Ha(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Ns(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ts(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ts(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}Aa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ms(t,n),r=r(i=Ps(i)),t.flags|=1,Aa(e,t,r,n),t.child;case 14:return i=na(r=t.type,t.pendingProps),wa(e,t,r,i=na(r.type,i),n);case 15:return Ca(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:na(r,i),Va(e,t),t.tag=1,Ri(r)?(e=!0,ki(t)):e=!1,Ms(t,n),oa(t,r,i),la(t,r,i,n),Ta(null,t,r,!0,e,n);case 19:return za(e,t,n);case 22:return Ea(e,t,n)}throw Error(s(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function qc(){}function $c(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=Hc(o);a.call(e)}}Vc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Hc(o);s.call(e)}}var o=zc(t,r,e,0,null,!1,0,"",qc);return e._reactRootContainer=o,e[pi]=o.current,zr(8===e.nodeType?e.parentNode:e),uc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=Hc(l);a.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",qc);return e._reactRootContainer=l,e[pi]=l.current,zr(8===e.nodeType?e.parentNode:e),uc((function(){Vc(t,l,n,r)})),l}(n,t,e,i,r);return Hc(o)}Qc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Vc(e,t,null,null)},Qc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Vc(null,e,null,null)})),t[pi]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Dt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(bt(t,1|n),rc(t,Ze()),0===(6&Tl)&&(zl=Ze()+500,zi()))}break;case 13:uc((function(){var t=Ls(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Wc(e,1)}},wt=function(e){if(13===e.tag){var t=Ls(e,134217728);if(null!==t)nc(t,e,134217728,ec());Wc(e,134217728)}},Ct=function(e){if(13===e.tag){var t=tc(e),n=Ls(e,t);if(null!==n)nc(n,e,t,ec());Wc(e,t)}},Et=function(){return yt},Bt=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},we=function(e,t,n){switch(t){case"input":if(q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=_i(r);if(!i)throw Error(s(90));X(r),q(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=cc,Me=uc;var eu={usingClientEntryPoint:!1,Events:[yi,Ai,_i,xe,Se,cc]},tu={findFiberByHostInstance:bi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Je(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(s(299));var n=!1,r="",i=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,zr(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Je(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Zc(t))throw Error(s(200));return $c(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=zc(t,null,e,1,null!=n?n:null,i,0,o,a),e[pi]=t.current,zr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Qc(t)},t.render=function(e,t,n){if(!Zc(t))throw Error(s(200));return $c(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc((function(){$c(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return $c(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},391:(e,t,n)=>{"use strict";var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},153:(e,t,n)=>{"use strict";var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function b(){}function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var A=y.prototype=new b;A.constructor=y,g(A,v.prototype),A.isPureReactComponent=!0;var _=Array.isArray,w=Object.prototype.hasOwnProperty,C={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function B(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,i)&&!E.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:C.current}}function x(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var S=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function M(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+T(l,0):s,_(o)?(i="",null!=e&&(i=e.replace(S,"$&/")+"/"),M(o,t,i,"",(function(e){return e}))):null!=o&&(x(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(S,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",_(e))for(var c=0;c<e.length;c++){var u=s+T(a=e[c],c);l+=M(a,t,i,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=M(a=a.value,t,i,u=s+T(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,n){if(null==e)return e;var r=[],i=0;return M(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function I(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},O={transition:null},L={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:O,ReactCurrentOwner:C};function F(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,n){P(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!x(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=o,t.PureComponent=y,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.act=F,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=g({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=C.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=B,t.createFactory=function(e){var t=B.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:I}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=F,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},43:(e,t,n)=>{"use strict";e.exports=n(202)},579:(e,t,n)=>{"use strict";e.exports=n(153)},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function A(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function _(e){if(m=!1,A(e),!g)if(null!==r(c))g=!0,O(w);else{var t=r(u);null!==t&&L(_,t.startTime-e)}}function w(e,n){g=!1,m&&(m=!1,b(x),x=-1),p=!0;var s=f;try{for(A(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!M());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===r(c)&&i(c),A(n)}else i(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&L(_,h.startTime-n),l=!1}return l}finally{d=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,E=!1,B=null,x=-1,S=5,T=-1;function M(){return!(t.unstable_now()-T<S)}function P(){if(null!==B){var e=t.unstable_now();T=e;var n=!0;try{n=B(!0,e)}finally{n?C():(E=!1,B=null)}}else E=!1}if("function"===typeof y)C=function(){y(P)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,R=I.port2;I.port1.onmessage=P,C=function(){R.postMessage(null)}}else C=function(){v(P,0)};function O(e){B=e,E||(E=!0,C())}function L(e,n){x=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,O(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(m?(b(x),x=-1):m=!0,L(_,s-o))):(e.sortIndex=a,n(c,e),g||p||(g=!0,O(w))),e},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},853:(e,t,n)=>{"use strict";e.exports=n(234)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".821401fa.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="interior-walkthrough:";n.l=(r,i,s,o)=>{if(e[r])e[r].push(i);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+s){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=r),e[r]=[i];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/interior-walkthrough/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var s=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=s);var o=n.p+n.u(t),a=new Error;n.l(o,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,i[1](a)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,s,o=r[0],a=r[1],l=r[2],c=0;if(o.some((t=>0!==e[t]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)l(n)}for(t&&t(r);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkinterior_walkthrough=self.webpackChunkinterior_walkthrough||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{readFileAsArrayBuffer:()=>kf,readFileAsText:()=>Df,requireFromFile:()=>Nf,requireFromString:()=>jf});var t={};n.r(t),n.d(t,{decode:()=>$p,name:()=>qp});var r={};n.r(r),n.d(r,{name:()=>sg,preprocess:()=>og});var i={};n.r(i),n.d(i,{name:()=>lg,preprocess:()=>cg});var s={};n.r(s),n.d(s,{decode:()=>nm,encode:()=>rm,name:()=>em,preprocess:()=>tm});var o={};n.r(o),n.d(o,{decode:()=>ym,name:()=>gm});var a={};n.r(a),n.d(a,{decode:()=>Bm,encode:()=>xm,name:()=>Em});var l={};n.r(l),n.d(l,{decode:()=>Mm,encode:()=>Pm,name:()=>Tm});var c={};n.r(c),n.d(c,{decode:()=>Om,encode:()=>Lm,name:()=>Rm});var u={};n.r(u),n.d(u,{decode:()=>Nm,name:()=>Dm});var h=n(43),d=n(391);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:t+""}function g(e,t,n){return(t=p(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let m=1,v=1;class b{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:n=Number.POSITIVE_INFINITY,rate:r=1,repeat:i=1}=e,s=m++,o={time:0,delay:t,duration:n,rate:r,repeat:i};return this._setChannelTime(o,this.time),this.channels.set(s,o),s}removeChannel(e){this.channels.delete(e);for(const[t,n]of this.animations)n.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const n=this.animations.values();for(const r of n){const{animation:e,channel:t}=r;e.setTime(this.getTime(t))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const n=v++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const n=t-e.delay;n>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}const y="Awaiting state",A="Matched. State transferred from previous layer",_="Initialized",w="Discarded. Awaiting garbage collection",C="No longer matched. Awaiting garbage collection",E="Finalized! Awaiting garbage collection",B=Symbol.for("component"),x=Symbol.for("propTypes"),S=Symbol.for("deprecatedProps"),T=Symbol.for("asyncPropDefaults"),M=Symbol.for("asyncPropOriginal"),P=Symbol.for("asyncPropResolved");function I(e){if("undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof process&&"object"===typeof process.versions&&Boolean(process.versions.electron))return!0;const t="object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent,n=e||t;return!!(n&&n.indexOf("Electron")>=0)}function R(){return!("object"===typeof process&&"[object process]"===String(process)&&!process.browser)||I()}const O="undefined"!==typeof __VERSION__?__VERSION__:"untranspiled source";R();class L{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";g(this,"storage",void 0),g(this,"id",void 0),g(this,"config",void 0),this.storage=function(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(t){return null}}(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function F(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const i=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>r&&(n=Math.min(n,r/e.width));const s=e.width*n,o=e.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),a]}let k;function D(e){return"string"===typeof e?k[e.toUpperCase()]||k.WHITE:e}function N(e,t){if(!e)throw new Error(t||"Assertion failed")}!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(k||(k={}));const j={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof n.g&&n.g,document:"undefined"!==typeof document&&document,process:"object"===typeof process&&process},U=j.window||j.self||j.global,G=j.process||{};function z(){let e;var t,n;if(R&&"performance"in U)e=null===U||void 0===U||null===(t=U.performance)||void 0===t||null===(n=t.now)||void 0===n?void 0:n.call(t);else if("hrtime"in G){var r;const t=null===G||void 0===G||null===(r=G.hrtime)||void 0===r?void 0:r.call(G);e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}const V={debug:R&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},H={enabled:!0,level:0};function J(){}const W={},X={once:!0};class K{constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};g(this,"id",void 0),g(this,"VERSION",O),g(this,"_startTs",z()),g(this,"_deltaTs",z()),g(this,"_storage",void 0),g(this,"userData",{}),g(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new L("__probe-".concat(this.id,"__"),H),this.timeStamp("".concat(this.id," started")),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(e),r=Object.getOwnPropertyNames(n);for(const i of r)"function"===typeof e[i]&&(t.find((e=>i===e))||(e[i]=e[i].bind(e)))}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((z()-this._startTs).toPrecision(10))}getDelta(){return Number((z()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){N(e,t)}warn(e){return this._getLogFunction(0,e,V.warn,arguments,X)}error(e){return this._getLogFunction(0,e,V.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,V.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,V.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction(e,t,V.debug||V.info,arguments,X)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||J,n&&[n],{tag:Z(t)}):J}image(e){let{logLevel:t,priority:n,image:r,message:i="",scale:s=1}=e;return this._shouldLog(t||n)?R?function(e){let{image:t,message:n="",scale:r=1}=e;if("string"===typeof t){const e=new Image;return e.onload=()=>{const t=F(e,n,r);console.log(...t)},e.src=t,J}const i=t.nodeName||"";if("img"===i.toLowerCase())return console.log(...F(t,n,r)),J;if("canvas"===i.toLowerCase()){const e=new Image;return e.onload=()=>console.log(...F(e,n,r)),e.src=t.toDataURL(),J}return J}({image:r,message:i,scale:s}):function(e){let{image:t,message:n="",scale:r=1}=e;return console.warn("removed"),J}({image:r,message:i,scale:s}):J}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||J)}group(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const r=Y({logLevel:e,message:t,opts:n}),{collapsed:i}=n;return r.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||J)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Q(e)}_getLogFunction(e,t,n,r,i){if(this._shouldLog(e)){i=Y({logLevel:e,message:t,args:r,opts:i}),N(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=z();const s=i.tag||i.message;if(i.once){if(W[s])return J;W[s]=z()}return t=function(e,t,n){if("string"===typeof t){const o=n.time?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(t-e.length,0);return"".concat(" ".repeat(n)).concat(e)}(function(e){let t;return t=e<10?"".concat(e.toFixed(2),"ms"):e<100?"".concat(e.toFixed(1),"ms"):e<1e3?"".concat(e.toFixed(0),"ms"):"".concat((e/1e3).toFixed(2),"s"),t}(n.total)):"";t=n.time?"".concat(e,": ").concat(o,"  ").concat(t):"".concat(e,": ").concat(t),r=t,i=n.color,s=n.background,R||"string"!==typeof r||(i&&(i=D(i),r="\x1b[".concat(i,"m").concat(r,"\x1b[39m")),s&&(i=D(s),r="\x1b[".concat(s+10,"m").concat(r,"\x1b[49m"))),t=r}var r,i,s;return t}(this.id,i.message,i),n.bind(console,t,...i.args)}return J}}function Q(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return N(Number.isFinite(t)&&t>=0),t}function Y(e){const{logLevel:t,message:n}=e;e.logLevel=Q(t);const r=e.args?Array.from(e.args):[];for(;r.length&&r.shift()!==n;);switch(typeof t){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"===typeof e.message&&(e.message=e.message());const i=typeof e.message;return N("string"===i||"object"===i),Object.assign(e,{args:r},e.opts)}function Z(e){for(const t in e)for(const n in e[t])return n||"untitled";return"empty"}g(K,"VERSION",O);const q=new K({id:"deck"});let $={};function ee(e){$=e}function te(e,t,n,r){q.level>0&&$[e]&&$[e].call(null,t,n,r)}function ne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;return Array.isArray(e)?re(e,t,[]):t(e)?[e]:[]}function re(e,t,n){let r=-1;for(;++r<e.length;){const i=e[r];Array.isArray(i)?re(i,t,n):t(i)&&n.push(i)}return n}function ie(e){let{target:t,source:n,start:r=0,count:i=1}=e;const s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)t[l++]=n[a];for(;a<o;)a<o-a?(t.copyWithin(r+a,r,r+a),a*=2):(t.copyWithin(r+a,r,r+o-a),a=o);return t}function se(){let e;if("undefined"!==typeof window&&window.performance)e=window.performance.now();else if("undefined"!==typeof process&&process.hrtime){const t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}class oe{constructor(e,t){g(this,"name",void 0),g(this,"type",void 0),g(this,"sampleSize",1),g(this,"time",void 0),g(this,"count",void 0),g(this,"samples",void 0),g(this,"lastTiming",void 0),g(this,"lastSampleTime",void 0),g(this,"lastSampleCount",void 0),g(this,"_count",0),g(this,"_time",0),g(this,"_samples",0),g(this,"_startTime",0),g(this,"_timerPending",!1),this.name=e,this.type=t,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=se(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(se()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class ae{constructor(e){g(this,"id",void 0),g(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach((t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((e=>this._getOrCreate(e)))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:n}=e;return this.stats[t]||(this.stats[t]=e instanceof oe?e:new oe(t,n)),this.stats[t]}}const le=e=>"boolean"===typeof e,ce=e=>"function"===typeof e,ue=e=>null!==e&&"object"===typeof e,he=e=>ue(e)&&e.constructor==={}.constructor,de=e=>"undefined"!==typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,fe=e=>"undefined"!==typeof Blob&&e instanceof Blob,pe=e=>(e=>"undefined"!==typeof ReadableStream&&e instanceof ReadableStream||ue(e)&&ce(e.tee)&&ce(e.cancel)&&ce(e.getReader))(e)||(e=>ue(e)&&ce(e.read)&&ce(e.pipe)&&le(e.readable))(e);function ge(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function me(e){var t;if(!e)return!1;Array.isArray(e)&&(e=e[0]);return Array.isArray(null===(t=e)||void 0===t?void 0:t.extensions)}function ve(e){var t,n;let r;return ge(e,"null loader"),ge(me(e),"invalid loader"),Array.isArray(e)&&(r=e[1],e=e[0],e={...e,options:{...e.options,...r}}),(null!==(t=e)&&void 0!==t&&t.parseTextSync||null!==(n=e)&&void 0!==n&&n.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}let be="";const ye={};const Ae=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,_e=/^([-\w.]+\/[-\w.+]+)/;function we(e){const t=Ae.exec(e);return t?t[1]:""}const Ce=/\?.*/;function Ee(e){return e.replace(Ce,"")}function Be(e){if(de(e)){return e.url}if(fe(e)){return e.name||""}return"string"===typeof e?e:""}function xe(e){if(de(e)){const t=e,n=t.headers.get("content-type")||"",r=Ee(t.url);return function(e){const t=_e.exec(e);return t?t[1]:e}(n)||we(r)}if(fe(e)){return e.type||""}return"string"===typeof e?we(e):""}async function Se(e){if(de(e))return e;const t={},n=function(e){if(de(e))return e.headers["content-length"]||-1;if(fe(e))return e.size;return"string"===typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);n>=0&&(t["content-length"]=String(n));const r=Be(e),i=xe(e);i&&(t["content-type"]=i);const s=await async function(e){const t=5;if("string"===typeof e)return"data:,".concat(e.slice(0,t));if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const n=new FileReader;n.onload=t=>{var n;return e(null===t||void 0===t||null===(n=t.target)||void 0===n?void 0:n.result)},n.readAsDataURL(t)}))}if(e instanceof ArrayBuffer){const n=function(e){let t="";const n=new Uint8Array(e);for(let r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return btoa(t)}(e.slice(0,t));return"data:base64,".concat(n)}return null}(e);s&&(t["x-first-bytes"]=s),"string"===typeof e&&(e=(new TextEncoder).encode(e));const o=new Response(e,{headers:t});return Object.defineProperty(o,"url",{value:r}),o}async function Te(e,t){if("string"===typeof e){e=function(e){for(const t in ye)if(e.startsWith(t)){const n=ye[t];e=e.replace(t,n)}return e.startsWith("http://")||e.startsWith("https://")||(e="".concat(be).concat(e)),e}(e);let n=t;return null!==t&&void 0!==t&&t.fetch&&"function"!==typeof(null===t||void 0===t?void 0:t.fetch)&&(n=t.fetch),await fetch(e,n)}return await Se(e)}const Me=new K({id:"loaders.gl"});class Pe{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof n.g&&n.g,"undefined"!==typeof document&&document;const Ie=Boolean("object"!==typeof process||"[object process]"!==String(process)||process.browser),Re="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version),Oe=(Re&&parseFloat(Re[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){g(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.log.bind(this.console,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.info.bind(this.console,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.warn.bind(this.console,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.error.bind(this.console,...t)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Ie,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),Le={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Fe(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state=e._state||{},e._state}const ke=()=>{const e=Fe();return e.globalOptions=e.globalOptions||{...Oe},e.globalOptions};function De(e,t,n,r){return n=n||[],function(e,t){Ne(e,null,Oe,Le,t);for(const n of t){const r=e&&e[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};Ne(r,n.id,i,s,t)}}(e,n=Array.isArray(n)?n:[n]),Ue(t,e,r)}function Ne(e,t,n,r,i){const s=t||"Top level",o=t?"".concat(t,"."):"";for(const a in e){const l=!t&&ue(e[a]);if(!(a in n)&&!("baseUri"===a&&!t)&&!("workerUrl"===a&&t))if(a in r)Me.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!l){const e=je(a,i);Me.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(e))()}}}function je(e,t){const n=e.toLowerCase();let r="";for(const i of t)for(const t in i.options){if(e===t)return"Did you mean '".concat(i.id,".").concat(t,"'?");const s=t.toLowerCase();(n.startsWith(s)||s.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(t,"'?"))}return r}function Ue(e,t,n){const r={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(r,n),null===r.log&&(r.log=new Pe),Ge(r,ke()),Ge(r,t),r}function Ge(e,t){for(const n in t)if(n in t){const r=t[n];he(r)&&he(e[n])?e[n]={...e[n],...t[n]}:e[n]=t[n]}}function ze(e,t){const n=ke(),r=e||n;return"function"===typeof r.fetch?r.fetch:ue(r.fetch)?e=>Te(e,r):null!==t&&void 0!==t&&t.fetch?null===t||void 0===t?void 0:t.fetch:Te}function Ve(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}const He={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof n.g&&n.g,document:"undefined"!==typeof document&&document},Je=He.global||He.self||He.window||{},We="object"!==typeof process||"[object process]"!==String(process)||process.browser,Xe="function"===typeof importScripts,Ke="undefined"!==typeof window&&"undefined"!==typeof window.orientation,Qe="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version);Qe&&parseFloat(Qe[1]);class Ye{terminate(){}}const Ze=new Map;function qe(e){Ve(e.source&&!e.url||!e.source&&e.url);let t=Ze.get(e.source||e.url);return t||(e.url&&(t=function(e){if(!e.startsWith("http"))return e;return $e((t=e,"try {\n  importScripts('".concat(t,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")));var t}(e.url),Ze.set(e.url,t)),e.source&&(t=$e(e.source),Ze.set(e.source,t))),Ve(t),t}function $e(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function et(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(e){if(tt(e))r.add(e);else if(tt(e.buffer))r.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"===typeof e)for(const i in e)et(e[i],t,r)}else;return void 0===n?Array.from(r):[]}function tt(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!==typeof MessagePort&&e instanceof MessagePort||("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}const nt=()=>{};class rt{static isSupported(){return"undefined"!==typeof Worker&&We||"undefined"!==typeof Ye&&!We}constructor(e){g(this,"name",void 0),g(this,"source",void 0),g(this,"url",void 0),g(this,"terminated",!1),g(this,"worker",void 0),g(this,"onMessage",void 0),g(this,"onError",void 0),g(this,"_loadableURL","");const{name:t,source:n,url:r}=e;Ve(n||r),this.name=t,this.source=n,this.url=r,this.onMessage=nt,this.onError=e=>console.log(e),this.worker=We?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=nt,this.onError=nt,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||et(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(t+="".concat(e.message," in ")),e.lineno&&(t+=":".concat(e.lineno,":").concat(e.colno)),new Error(t)}_createBrowserWorker(){this._loadableURL=qe({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Ye(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new Ye(this.source,{eval:!0})}return e.on("message",(e=>{this.onMessage(e)})),e.on("error",(e=>{this.onError(e)})),e.on("exit",(e=>{})),e}}class it{constructor(e,t){g(this,"name",void 0),g(this,"workerThread",void 0),g(this,"isRunning",!0),g(this,"result",void 0),g(this,"_resolve",(()=>{})),g(this,"_reject",(()=>{})),this.name=e,this.workerThread=t,this.result=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){Ve(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Ve(this.isRunning),this.isRunning=!1,this._reject(e)}}class st{static isSupported(){return rt.isSupported()}constructor(e){g(this,"name","unnamed"),g(this,"source",void 0),g(this,"url",void 0),g(this,"maxConcurrency",1),g(this,"maxMobileConcurrency",1),g(this,"onDebug",(()=>{})),g(this,"reuseWorkers",!0),g(this,"props",{}),g(this,"jobQueue",[]),g(this,"idleQueue",[]),g(this,"count",0),g(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach((e=>e.destroy())),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t,n)=>e.done(n),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e.error(t);const r=new Promise((r=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:r}),this)));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const n=new it(t.name,e);e.onMessage=e=>t.onMessage(n,e.type,e.payload),e.onError=e=>t.onError(n,e),t.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new rt({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Ke?this.maxMobileConcurrency:this.maxConcurrency}}const ot={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class at{static isSupported(){return rt.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return at._workerFarm=at._workerFarm||new at({}),at._workerFarm.setProps(e),at._workerFarm}constructor(e){g(this,"props",void 0),g(this,"workerPools",new Map),this.props={...ot},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:r}=e;let i=this.workerPools.get(t);return i||(i=new st({name:t,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}g(at,"_workerFarm",void 0);async function lt(e,t,n,r,i){const s=e.id,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t[e.id]||{},r="".concat(e.id,"-worker.js");let i=n.workerUrl;if(i||"compression"!==e.id||(i=t.workerUrl),"test"===t._workerType&&(i="modules/".concat(e.module,"/dist/").concat(r)),!i){let t=e.version;"latest"===t&&(t="latest");const n=t?"@".concat(t):"";i="https://unpkg.com/@loaders.gl/".concat(e.module).concat(n,"/dist/").concat(r)}return Ve(i),i}(e,n),a=at.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const l=await a.startJob("process-on-worker",ct.bind(null,i));l.postMessage("process",{input:t,options:n,context:r});const c=await l.result;return await c.result}async function ct(e,t,n,r){switch(n){case"done":t.done(r);break;case"error":t.error(new Error(r.error));break;case"process":const{id:s,input:o,options:a}=r;try{const n=await e(o,a);t.postMessage("done",{id:s,result:n})}catch(i){const e=i instanceof Error?i.message:"unknown error";t.postMessage("error",{id:s,error:e})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function ut(e,t,n){const r=void 0!==n?new Uint8Array(e).subarray(t,t+n):new Uint8Array(e).subarray(t);return new Uint8Array(r).buffer}async function ht(e){const t=[];for await(const n of e)t.push(n);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.map((e=>e instanceof ArrayBuffer?new Uint8Array(e):e)),i=r.reduce(((e,t)=>e+t.byteLength),0),s=new Uint8Array(i);let o=0;for(const a of r)s.set(a,o),o+=a.byteLength;return s.buffer}(...t)}const dt=262144;function ft(e){if((t=e)&&"object"===typeof t&&t.isBuffer)return e;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"===typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"===typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function pt(e,t){return Ie?async function*(e,t){const n=e.getReader();let r;try{for(;;){const e=r||n.read();null!==t&&void 0!==t&&t._streamReadAhead&&(r=n.read());const{done:i,value:s}=await e;if(i)return;yield ft(s)}}catch(i){n.releaseLock()}}(e,t):async function*(e){for await(const t of e)yield ft(t)}(e)}function gt(e,t){if("string"===typeof e)return function*(e,t){const n=(null===t||void 0===t?void 0:t.chunkSize)||262144;let r=0;const i=new TextEncoder;for(;r<e.length;){const t=Math.min(e.length-r,n),s=e.slice(r,r+t);r+=t,yield i.encode(s)}}(e,t);if(e instanceof ArrayBuffer)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{chunkSize:n=dt}=t;let r=0;for(;r<e.byteLength;){const t=Math.min(e.byteLength-r,n),i=new ArrayBuffer(t),s=new Uint8Array(e,r,t);new Uint8Array(i).set(s),r+=t,yield i}}()}(e,t);if(fe(e))return async function*(e,t){const n=(null===t||void 0===t?void 0:t.chunkSize)||1048576;let r=0;for(;r<e.size;){const t=r+n,i=await e.slice(r,t).arrayBuffer();r=t,yield i}}(e,t);if(pe(e))return pt(e,t);if(de(e)){return pt(e.body,t)}throw new Error("makeIterator")}const mt="Cannot convert supplied data type";async function vt(e,t,n){const r=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"===typeof e||r)return function(e,t){if(t.text&&"string"===typeof e)return e;if((e=>e&&"object"===typeof e&&e.isBuffer)(e)&&(e=e.buffer),e instanceof ArrayBuffer){const n=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let n=e.buffer;const r=e.byteLength||e.length;return 0===e.byteOffset&&r===n.byteLength||(n=n.slice(e.byteOffset,e.byteOffset+r)),n}throw new Error(mt)}(e,t);if(fe(e)&&(e=await Se(e)),de(e)){const n=e;return await async function(e){if(!e.ok){const t=await async function(e){let t="Failed to fetch resource ".concat(e.url," (").concat(e.status,"): ");try{const n=e.headers.get("Content-Type");let r=e.statusText;n.includes("application/json")&&(r+=" ".concat(await e.text())),t+=r,t=t.length>60?"".concat(t.slice(0,60),"..."):t}catch(n){}return t}(e);throw new Error(t)}}(n),t.binary?await n.arrayBuffer():await n.text()}if(pe(e)&&(e=gt(e,n)),(e=>e&&"function"===typeof e[Symbol.iterator])(e)||(e=>e&&"function"===typeof e[Symbol.asyncIterator])(e))return ht(e);throw new Error(mt)}function bt(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function yt(e,t,n){if(n)return n;const r={fetch:ze(t,e),...e};if(r.url){const e=Ee(r.url);r.baseUrl=e,r.queryString=function(e){const t=e.match(Ce);return t&&t[0]}(r.url),r.filename=bt(e),r.baseUrl=function(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}(e)}return Array.isArray(r.loaders)||(r.loaders=null),r}const At=new K({id:"loaders.gl"}),_t=()=>{const e=Fe();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function wt(e){const t=_t();e=Array.isArray(e)?e:[e];for(const n of e){const e=ve(n);t.find((t=>e===t))||t.unshift(e)}}const Ct=/\.([^.]+)$/;function Et(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!Bt(e))return null;if(t&&!Array.isArray(t))return ve(t);let i=[];t&&(i=i.concat(t)),null!==n&&void 0!==n&&n.ignoreRegisteredLoaders||i.push(..._t()),function(e){for(const t of e)ve(t)}(i);const s=function(e,t,n,r){const i=Be(e),s=xe(e),o=Ee(i)||(null===r||void 0===r?void 0:r.url);let a=null,l="";null!==n&&void 0!==n&&n.mimeType&&(a=St(t,null===n||void 0===n?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(null===n||void 0===n?void 0:n.mimeType));var c;a=a||function(e,t){const n=t&&Ct.exec(t),r=n&&n[1];return r?function(e,t){t=t.toLowerCase();for(const n of e)for(const e of n.extensions)if(e.toLowerCase()===t)return n;return null}(e,r):null}(t,o),l=l||(a?"matched url ".concat(o):""),a=a||St(t,s),l=l||(a?"matched MIME type ".concat(s):""),a=a||function(e,t){if(!t)return null;for(const n of e)if("string"===typeof t){if(Tt(t,n))return n}else if(ArrayBuffer.isView(t)){if(Mt(t.buffer,t.byteOffset,n))return n}else if(t instanceof ArrayBuffer){if(Mt(t,0,n))return n}return null}(t,e),l=l||(a?"matched initial data ".concat(Pt(e)):""),a=a||St(t,null===n||void 0===n?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(s):""),l&&At.log(1,"selectLoader selected ".concat(null===(c=a)||void 0===c?void 0:c.name,": ").concat(l,"."));return a}(e,i,n,r);if(!s&&(null===n||void 0===n||!n.nothrow))throw new Error(xt(e));return s}function Bt(e){return!(e instanceof Response&&204===e.status)}function xt(e){const t=Be(e),n=xe(e);let r="No valid loader found (";r+=t?"".concat(bt(t),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=e?Pt(e):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function St(e,t){for(const n of e){if(n.mimeTypes&&n.mimeTypes.includes(t))return n;if(t==="application/x.".concat(n.id))return n}return null}function Tt(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function Mt(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((r=>function(e,t,n,r){if(r instanceof ArrayBuffer)return function(e,t,n){if(n=n||e.byteLength,e.byteLength<n||t.byteLength<n)return!1;const r=new Uint8Array(e),i=new Uint8Array(t);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(r,e,r.byteLength);switch(typeof r){case"function":return r(e,n);case"string":return r===It(e,t,r.length);default:return!1}}(e,t,n,r)))}function Pt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"===typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return It(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return It(e,0,t)}return""}function It(e,t,n){if(e.byteLength<t+n)return"";const r=new DataView(e);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(t+s));return i}async function Rt(e,t,n,r){Ve(!r||"object"===typeof r),!t||Array.isArray(t)||me(t)||(r=void 0,n=t,t=void 0),n=n||{};const i=Be(e=await e),s=function(e,t){if(!t&&e&&!Array.isArray(e))return e;let n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[...n,...e]:e}return n&&n.length?n:null}(t,r),o=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!Bt(e))return null;let i=Et(e,t,{...n,nothrow:!0},r);if(i)return i;if(fe(e)&&(i=Et(e=await e.slice(0,10).arrayBuffer(),t,n,r)),!i&&(null===n||void 0===n||!n.nothrow))throw new Error(xt(e));return i}(e,s,n);return o?(r=yt({url:i,parse:Rt,loaders:s},n=De(n,o,s,i),r||null),await async function(e,t,n,r){if(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"3.4.15";Ve(e,"no worker provided");const n=e.version}(e),de(t)){const e=t,{ok:n,redirected:i,status:s,statusText:o,type:a,url:l}=e,c=Object.fromEntries(e.headers.entries());r.response={headers:c,ok:n,redirected:i,status:s,statusText:o,type:a,url:l}}if(t=await vt(t,e,n),e.parseTextSync&&"string"===typeof t)return n.dataType="text",e.parseTextSync(t,n,r,e);if(function(e,t){return!!at.isSupported()&&!!(We||null!==t&&void 0!==t&&t._nodeWorkers)&&e.worker&&(null===t||void 0===t?void 0:t.worker)}(e,n))return await lt(e,t,n,r,Rt);if(e.parseText&&"string"===typeof t)return await e.parseText(t,n,r,e);if(e.parse)return await e.parse(t,n,r,e);throw Ve(!e.parseSync),new Error("".concat(e.id," loader - no parser found and worker is disabled"))}(o,e,n,r)):null}async function Ot(e,t,n,r){Array.isArray(t)||me(t)||(n=t,t=void 0);const i=ze(n);let s=e;return"string"===typeof e&&(s=await i(e)),fe(e)&&(s=await i(e)),await Rt(s,t,n)}class Lt{constructor(e,t,n){g(this,"id",void 0),g(this,"context",void 0),g(this,"isLoaded",void 0),g(this,"persistent",void 0),g(this,"_loadCount",0),g(this,"_subscribers",new Set),g(this,"_data",void 0),g(this,"_loader",void 0),g(this,"_error",void 0),g(this,"_content",void 0),this.id=e,this.context=n,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(e,t){if(e===this._data&&!t)return;this._data=e;const n=++this._loadCount;let r=e;"string"===typeof e&&(r=Ot(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then((e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=e)})).catch((e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=e||!0)}))):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const i of this._subscribers)i.onChange(this.getData())}}class Ft{constructor(e){let{gl:t,protocol:n}=e;g(this,"protocol",void 0),g(this,"_context",void 0),g(this,"_resources",void 0),g(this,"_consumers",void 0),g(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add(e){let{resourceId:t,data:n,forceUpdate:r=!1,persistent:i=!0}=e,s=this._resources[t];s?s.setData(n,r):(s=new Lt(t,n,this._context),this._resources[t]=s),s.persistent=i}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe(e){let{consumerId:t}=e;const n=this._consumers[t];if(n){for(const e in n){const t=n[e],r=this._resources[t.resourceId];r&&r.unsubscribe(t)}delete this._consumers[t],this.prune()}}subscribe(e){let{resourceId:t,onChange:n,consumerId:r,requestId:i="default"}=e;const{_resources:s,protocol:o}=this;t.startsWith(o)&&(t=t.replace(o,""),s[t]||this.add({resourceId:t,data:null,persistent:!1}));const a=s[t];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,n,r){const i=this._consumers,s=i[e]=i[e]||{},o=s[t]||{},a=o.resourceId&&this._resources[o.resourceId];a&&(a.unsubscribe(o),this.prune()),n&&(s[t]=o,o.onChange=r,o.resourceId=n.id,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];t.persistent||t.inUse()||(t.delete(),delete this._resources[e])}}}const kt=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g(this,"_pool",[]),g(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,n){let{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}=n;const c=i||e&&e.constructor||Float32Array,u=t*r+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let h=1/0;l&&(h=l*r+s);const d=this._allocate(c,u,a,h);return e&&o?d.set(e):a||d.fill(0,0,4),this._release(e),d}release(e){this._release(e)}_allocate(e,t,n,r){let i=Math.max(Math.ceil(t*this.opts.overAlloc),1);i>r&&(i=r);const s=this._pool,o=e.BYTES_PER_ELEMENT*i,a=s.findIndex((e=>e.byteLength>=o));if(a>=0){const t=new e(s.splice(a,1)[0],0,i);return n&&t.fill(0),t}return new e(i)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:n}=e,{byteLength:r}=n,i=t.findIndex((e=>e.byteLength>=r));i<0?t.push(n):(i>0||t.length<this.opts.poolSize)&&t.splice(i,0,n),t.length>this.opts.poolSize&&t.shift()}},Dt=(Math.PI,Math.PI,{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0});function Nt(e){let{precision:t=Dt.precision}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=function(e){return Math.round(e/Dt.EPSILON)*Dt.EPSILON}(e),"".concat(parseFloat(e.toPrecision(t)))}function jt(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ut(e,t,n){return Vt(e,(e=>Math.max(t,Math.min(n,e))))}function Gt(e,t,n){return jt(e)?e.map(((e,r)=>Gt(e,t[r],n))):n*t+(1-n)*e}function zt(e,t,n){const r=Dt.EPSILON;n&&(Dt.EPSILON=n);try{if(e===t)return!0;if(jt(e)&&jt(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!zt(e[n],t[n]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):"number"===typeof e&&"number"===typeof t&&Math.abs(e-t)<=Dt.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{Dt.EPSILON=r}}function Vt(e,t,n){if(jt(e)){const r=e;n=n||function(e){return e.clone?e.clone():new Array(e.length)}(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=t(e[i],i,n);return n}return t(e)}class Ht extends(function(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:jt(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Dt)}formatString(e){let t="";for(let n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+Nt(this[n],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!zt(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,n){if(void 0===n)return this.lerp(this,e,t);for(let r=0;r<this.ELEMENTS;++r){const i=e[r];this[r]=i+n*(t[r]-i)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]+=r[e];return this.check()}subtract(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]-=r[e];return this.check()}scale(e){if("number"===typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(Dt.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}get elements(){return this}}function Jt(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(e));return e}function Wt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(Dt.debug&&!function(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e,t))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return e}function Xt(e,t){if(!e)throw new Error("math.gl assertion ".concat(t))}class Kt extends Ht{get x(){return this[0]}set x(e){this[0]=Jt(e)}get y(){return this[1]}set y(e){this[1]=Jt(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-e[n];t+=r*r}return Jt(t)}dot(e){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return Jt(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=r[e];return this.check()}divide(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=r[e];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Xt(e>=0&&e<this.ELEMENTS,"index is out of range"),Jt(this[e])}setComponent(e,t){return Xt(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var Qt=1e-6,Yt="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI,Math.PI;function Zt(){var e=new Yt(3);return Yt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function qt(e,t,n){var r=new Yt(3);return r[0]=e,r[1]=t,r[2]=n,r}function $t(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function en(e,t,n){var r=t[0],i=t[1],s=t[2],o=n[0],a=n[1],l=n[2];return e[0]=i*l-s*a,e[1]=s*o-r*l,e[2]=r*a-i*o,e}function tn(e,t,n){var r=t[0],i=t[1],s=t[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,e[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,e[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,e[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,e}function nn(e,t,n){var r=t[0],i=t[1],s=t[2];return e[0]=r*n[0]+i*n[3]+s*n[6],e[1]=r*n[1]+i*n[4]+s*n[7],e[2]=r*n[2]+i*n[5]+s*n[8],e}function rn(e,t,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=t[0],l=t[1],c=t[2],u=i*c-s*l,h=s*a-r*c,d=r*l-i*a;return u+=u,h+=h,d+=d,e[0]=a+o*u+i*d-s*h,e[1]=l+o*h+s*u-r*d,e[2]=c+o*d+r*h-i*u,e}var sn=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},on=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)};!function(){var e=Zt()}();function an(e,t,n){const r=t[0],i=t[1],s=t[2],o=n[3]*r+n[7]*i+n[11]*s||1;return e[0]=(n[0]*r+n[4]*i+n[8]*s)/o,e[1]=(n[1]*r+n[5]*i+n[9]*s)/o,e[2]=(n[2]*r+n[6]*i+n[10]*s)/o,e}function ln(e,t,n){const r=t[0],i=t[1],s=t[2];return e[0]=n[0]*r+n[3]*i+n[6]*s,e[1]=n[1]*r+n[4]*i+n[7]*s,e[2]=n[2]*r+n[5]*i+n[8]*s,e[3]=t[3],e}const cn=[0,0,0];let un;class hn extends Kt{static get ZERO(){return un||(un=new hn(0,0,0),Object.freeze(un)),un}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(-0,-0,-0),1===arguments.length&&jt(e)?this.copy(e):(Dt.debug&&(Jt(e),Jt(t),Jt(n)),this[0]=e,this[1]=t,this[2]=n)}set(e,t,n){return this[0]=e,this[1]=t,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Dt.debug&&(Jt(e.x),Jt(e.y),Jt(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Jt(e)}angle(e){return function(e,t){var n=e[0],r=e[1],i=e[2],s=t[0],o=t[1],a=t[2],l=Math.sqrt((n*n+r*r+i*i)*(s*s+o*o+a*a)),c=l&&$t(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))}(this,e)}cross(e){return en(this,this,e),this.check()}rotateX(e){let{radians:t,origin:n=cn}=e;return function(e,t,n,r){var i=[],s=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2]}(this,this,n,t),this.check()}rotateY(e){let{radians:t,origin:n=cn}=e;return function(e,t,n,r){var i=[],s=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2]}(this,this,n,t),this.check()}rotateZ(e){let{radians:t,origin:n=cn}=e;return function(e,t,n,r){var i=[],s=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2]}(this,this,n,t),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return tn(this,this,e),this.check()}transformAsVector(e){return an(this,this,e),this.check()}transformByMatrix3(e){return nn(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const r=t[0],i=t[1];e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e[2]=t[2]}(this,this,e),this.check()}transformByQuaternion(e){return rn(this,this,e),this.check()}}const dn=new hn;function fn(e,t,n,r){dn.set(e,t,n);const i=dn.len();return{distance:r/i,normal:new hn(-e/i,-t/i,-n/i)}}function pn(e){return e-Math.fround(e)}let gn;function mn(e,t){const{size:n=1,startIndex:r=0}=t,i=void 0!==t.endIndex?t.endIndex:e.length,s=(i-r)/n;gn=kt.allocate(gn,s,{type:Float32Array,size:2*n});let o=r,a=0;for(;o<i;){for(let t=0;t<n;t++){const r=e[o++];gn[a+t]=r,gn[a+t+n]=pn(r)}a+=2*n}return gn.subarray(0,s*n*2)}function vn(e){let t=null,n=!1;for(const r of e)r&&(t?(n||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],n=!0),t[0][0]=Math.min(t[0][0],r[0][0]),t[0][1]=Math.min(t[0][1],r[0][1]),t[1][0]=Math.max(t[1][0],r[1][0]),t[1][1]=Math.max(t[1][1],r[1][1])):t=r);return t}class bn extends Ht{toString(){let e="[";if(Dt.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let n=0;n<this.RANK;++n)e+=" ".concat(this[n*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,n){return this[t*this.RANK+e]=Jt(n),this}getColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0);const n=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[n+r];return t}setColumn(e,t){const n=e*this.RANK;for(let r=0;r<this.RANK;++r)this[n+r]=t[r];return this}}function yn(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],m=t[14],v=t[15],b=n*a-r*o,y=n*l-i*o,A=n*c-s*o,_=r*l-i*a,w=r*c-s*a,C=i*c-s*l,E=u*g-h*p,B=u*m-d*p,x=u*v-f*p,S=h*m-d*g,T=h*v-f*g,M=d*v-f*m,P=b*M-y*T+A*S+_*x-w*B+C*E;return P?(P=1/P,e[0]=(a*M-l*T+c*S)*P,e[1]=(i*T-r*M-s*S)*P,e[2]=(g*C-m*w+v*_)*P,e[3]=(d*w-h*C-f*_)*P,e[4]=(l*x-o*M-c*B)*P,e[5]=(n*M-i*x+s*B)*P,e[6]=(m*A-p*C-v*y)*P,e[7]=(u*C-d*A+f*y)*P,e[8]=(o*T-a*x+c*E)*P,e[9]=(r*x-n*T-s*E)*P,e[10]=(p*w-g*A+v*b)*P,e[11]=(h*A-u*w-f*b)*P,e[12]=(a*B-o*S-l*E)*P,e[13]=(n*S-r*B+i*E)*P,e[14]=(g*y-p*_-m*b)*P,e[15]=(u*_-h*y+d*b)*P,e):null}function An(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],g=t[12],m=t[13],v=t[14],b=t[15],y=n[0],A=n[1],_=n[2],w=n[3];return e[0]=y*r+A*a+_*h+w*g,e[1]=y*i+A*l+_*d+w*m,e[2]=y*s+A*c+_*f+w*v,e[3]=y*o+A*u+_*p+w*b,y=n[4],A=n[5],_=n[6],w=n[7],e[4]=y*r+A*a+_*h+w*g,e[5]=y*i+A*l+_*d+w*m,e[6]=y*s+A*c+_*f+w*v,e[7]=y*o+A*u+_*p+w*b,y=n[8],A=n[9],_=n[10],w=n[11],e[8]=y*r+A*a+_*h+w*g,e[9]=y*i+A*l+_*d+w*m,e[10]=y*s+A*c+_*f+w*v,e[11]=y*o+A*u+_*p+w*b,y=n[12],A=n[13],_=n[14],w=n[15],e[12]=y*r+A*a+_*h+w*g,e[13]=y*i+A*l+_*d+w*m,e[14]=y*s+A*c+_*f+w*v,e[15]=y*o+A*u+_*p+w*b,e}function _n(e,t,n){var r,i,s,o,a,l,c,u,h,d,f,p,g=n[0],m=n[1],v=n[2];return t===e?(e[12]=t[0]*g+t[4]*m+t[8]*v+t[12],e[13]=t[1]*g+t[5]*m+t[9]*v+t[13],e[14]=t[2]*g+t[6]*m+t[10]*v+t[14],e[15]=t[3]*g+t[7]*m+t[11]*v+t[15]):(r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=s,e[3]=o,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=f,e[11]=p,e[12]=r*g+a*m+h*v+t[12],e[13]=i*g+l*m+d*v+t[13],e[14]=s*g+c*m+f*v+t[14],e[15]=o*g+u*m+p*v+t[15]),e}function wn(e,t,n){var r=n[0],i=n[1],s=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Cn(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+c*r,e[5]=o*i+u*r,e[6]=a*i+h*r,e[7]=l*i+d*r,e[8]=c*i-s*r,e[9]=u*i-o*r,e[10]=h*i-a*r,e[11]=d*i-l*r,e}function En(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+c*r,e[1]=o*i+u*r,e[2]=a*i+h*r,e[3]=l*i+d*r,e[4]=c*i-s*r,e[5]=u*i-o*r,e[6]=h*i-a*r,e[7]=d*i-l*r,e}var Bn=function(e,t,n,r,i){var s=1/Math.tan(t/2);if(e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0){var o=1/(r-i);e[10]=(i+r)*o,e[14]=2*i*r*o}else e[10]=-1,e[14]=-2*r;return e};var xn=function(e,t,n,r,i,s,o){var a=1/(t-n),l=1/(r-i),c=1/(s-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*a,e[13]=(i+r)*l,e[14]=(o+s)*c,e[15]=1,e};function Sn(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function Tn(e,t,n,r){var i=t[0],s=t[1];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e}!function(){var e=function(){var e=new Yt(2);return Yt!=Float32Array&&(e[0]=0,e[1]=0),e}()}();function Mn(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function Pn(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)}function In(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function Rn(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,e[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,e[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,e[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,e}var On;!function(){var e=function(){var e=new Yt(4);return Yt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();!function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"}(On||(On={}));const Ln=45*Math.PI/180,Fn=1,kn=.1,Dn=500,Nn=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class jn extends bn{static get IDENTITY(){return function(){Gn||(Gn=new jn,Object.freeze(Gn));return Gn}()}static get ZERO(){return function(){Un||(Un=new jn([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Un));return Un}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return On}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,n,r,i,s,o,a,l,c,u,h,d,f,p,g){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=l,this[9]=c,this[10]=u,this[11]=h,this[12]=d,this[13]=f,this[14]=p,this[15]=g,this.check()}setRowMajor(e,t,n,r,i,s,o,a,l,c,u,h,d,f,p,g){return this[0]=e,this[1]=i,this[2]=l,this[3]=d,this[4]=t,this[5]=s,this[6]=c,this[7]=f,this[8]=n,this[9]=o,this[10]=u,this[11]=p,this[12]=r,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Nn)}fromObject(e){return this.check()}fromQuaternion(e){return function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,h=r*a,d=i*o,f=i*a,p=i*l,g=s*o,m=s*a,v=s*l;e[0]=1-h-p,e[1]=u+v,e[2]=d-m,e[3]=0,e[4]=u-v,e[5]=1-c-p,e[6]=f+g,e[7]=0,e[8]=d+m,e[9]=f-g,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this.check()}frustum(e){const{left:t,right:n,bottom:r,top:i,near:s=kn,far:o=Dn}=e;return o===1/0?function(e,t,n,r,i,s){const o=2*s/(n-t),a=2*s/(i-r),l=(n+t)/(n-t),c=(i+r)/(i-r),u=-1,h=-1,d=-2*s;e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=l,e[9]=c,e[10]=u,e[11]=h,e[12]=0,e[13]=0,e[14]=d,e[15]=0}(this,t,n,r,i,s):function(e,t,n,r,i,s,o){var a=1/(n-t),l=1/(i-r),c=1/(s-o);e[0]=2*s*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*l,e[6]=0,e[7]=0,e[8]=(n+t)*a,e[9]=(i+r)*l,e[10]=(o+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*s*2*c,e[15]=0}(this,t,n,r,i,s,o),this.check()}lookAt(e){const{eye:t,center:n=[0,0,0],up:r=[0,1,0]}=e;return function(e,t,n,r){var i,s,o,a,l,c,u,h,d,f,p=t[0],g=t[1],m=t[2],v=r[0],b=r[1],y=r[2],A=n[0],_=n[1],w=n[2];Math.abs(p-A)<Qt&&Math.abs(g-_)<Qt&&Math.abs(m-w)<Qt?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(e):(u=p-A,h=g-_,d=m-w,i=b*(d*=f=1/Math.sqrt(u*u+h*h+d*d))-y*(h*=f),s=y*(u*=f)-v*d,o=v*h-b*u,(f=Math.sqrt(i*i+s*s+o*o))?(i*=f=1/f,s*=f,o*=f):(i=0,s=0,o=0),a=h*o-d*s,l=d*i-u*o,c=u*s-h*i,(f=Math.sqrt(a*a+l*l+c*c))?(a*=f=1/f,l*=f,c*=f):(a=0,l=0,c=0),e[0]=i,e[1]=a,e[2]=u,e[3]=0,e[4]=s,e[5]=l,e[6]=h,e[7]=0,e[8]=o,e[9]=c,e[10]=d,e[11]=0,e[12]=-(i*p+s*g+o*m),e[13]=-(a*p+l*g+c*m),e[14]=-(u*p+h*g+d*m),e[15]=1)}(this,t,n,r),this.check()}ortho(e){const{left:t,right:n,bottom:r,top:i,near:s=kn,far:o=Dn}=e;return xn(this,t,n,r,i,s,o),this.check()}orthographic(e){const{fovy:t=Ln,aspect:n=Fn,focalDistance:r=1,near:i=kn,far:s=Dn}=e;zn(t);const o=t/2,a=r*Math.tan(o),l=a*n;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:i,far:s})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}=e;return zn(t),Bn(this,t,n,r,i),this.check()}determinant(){return function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],g=e[14],m=t*o-n*s,v=t*a-r*s,b=n*a-r*o,y=c*p-u*f,A=c*g-h*f,_=u*g-h*p;return l*(t*_-n*A+r*y)-i*(s*_-o*A+a*y)+e[15]*(c*b-u*v+h*m)-d*(f*b-p*v+g*m)}(this)}getScale(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),r=1/n[0],i=1/n[1],s=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*i,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*i,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*i,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),r=1/n[0],i=1/n[1],s=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*i,e[2]=this[2]*s,e[3]=this[4]*r,e[4]=this[5]*i,e[5]=this[6]*s,e[6]=this[8]*r,e[7]=this[9]*i,e[8]=this[10]*s,e}transpose(){return function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],s=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=s,e[11]=t[14],e[12]=i,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]}(this,this),this.check()}invert(){return yn(this,this),this.check()}multiplyLeft(e){return An(this,e,this),this.check()}multiplyRight(e){return An(this,this,e),this.check()}rotateX(e){return Cn(this,this,e),this.check()}rotateY(e){return function(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],a=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-c*r,e[1]=o*i-u*r,e[2]=a*i-h*r,e[3]=l*i-d*r,e[8]=s*r+c*i,e[9]=o*r+u*i,e[10]=a*r+h*i,e[11]=l*r+d*i}(this,this,e),this.check()}rotateZ(e){return En(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return function(e,t,n,r){var i,s,o,a,l,c,u,h,d,f,p,g,m,v,b,y,A,_,w,C,E,B,x,S,T=r[0],M=r[1],P=r[2],I=Math.sqrt(T*T+M*M+P*P);I<Qt||(T*=I=1/I,M*=I,P*=I,i=Math.sin(n),o=1-(s=Math.cos(n)),a=t[0],l=t[1],c=t[2],u=t[3],h=t[4],d=t[5],f=t[6],p=t[7],g=t[8],m=t[9],v=t[10],b=t[11],y=T*T*o+s,A=M*T*o+P*i,_=P*T*o-M*i,w=T*M*o-P*i,C=M*M*o+s,E=P*M*o+T*i,B=T*P*o+M*i,x=M*P*o-T*i,S=P*P*o+s,e[0]=a*y+h*A+g*_,e[1]=l*y+d*A+m*_,e[2]=c*y+f*A+v*_,e[3]=u*y+p*A+b*_,e[4]=a*w+h*C+g*E,e[5]=l*w+d*C+m*E,e[6]=c*w+f*C+v*E,e[7]=u*w+p*C+b*E,e[8]=a*B+h*x+g*S,e[9]=l*B+d*x+m*S,e[10]=c*B+f*x+v*S,e[11]=u*B+p*x+b*S,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,this,e,t),this.check()}scale(e){return wn(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return _n(this,this,e),this.check()}transform(e,t){return 4===e.length?(Wt(t=Rn(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:n}=e;let r;switch(n){case 2:r=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}(t||[-0,-0],e,this);break;case 3:r=tn(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Wt(r,e.length),r}transformAsVector(e,t){let n;switch(e.length){case 2:n=function(e,t,n){const r=t[0],i=t[1],s=n[3]*r+n[7]*i||1;return e[0]=(n[0]*r+n[4]*i)/s,e[1]=(n[1]*r+n[5]*i)/s,e}(t||[-0,-0],e,this);break;case 3:n=an(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Wt(n,e.length),n}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,n){return this.identity().translate([e,t,n])}}let Un,Gn;function zn(e){if(e>2*Math.PI)throw Error("expected radians")}function Vn(e,t){const n=Rn([],t,e);return Mn(n,n,1/n[3]),n}function Hn(e,t){const n=e%t;return n<0?t+n:n}function Jn(e,t,n){return e<t?t:e>n?n:e}const Wn=Math.log2||function(e){return Math.log(e)*Math.LOG2E};function Xn(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const Kn=Math.PI,Qn=Kn/4,Yn=Kn/180,Zn=180/Kn,qn=512,$n=4003e4,er=85.051129,tr=1.5;function nr(e){const[t,n]=e;Xn(Number.isFinite(t)),Xn(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=n*Yn;return[qn*(t*Yn+Kn)/(2*Kn),qn*(Kn+Math.log(Math.tan(Qn+.5*r)))/(2*Kn)]}function rr(e){const[t,n]=e,r=t/qn*(2*Kn)-Kn,i=2*(Math.atan(Math.exp(n/qn*(2*Kn)-Kn))-Qn);return[r*Zn,i*Zn]}function ir(e){const{latitude:t}=e;Xn(Number.isFinite(t));const n=Math.cos(t*Yn);return function(e){return Wn(e)}($n*n)-9}function sr(e){return 12790407194604047e-21/Math.cos(e*Yn)}function or(e){const{latitude:t,longitude:n,highPrecision:r=!1}=e;Xn(Number.isFinite(t)&&Number.isFinite(n));const i=qn,s=Math.cos(t*Yn),o=i/360,a=o/s,l=12790407194604047e-21/s,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[.703125,1/a,1/l]};if(r){const e=Yn*Math.tan(t*Yn)/s,n=o*e/2,r=12790407194604047e-21*e,i=r/a*l;c.unitsPerDegree2=[0,n,r],c.unitsPerMeter2=[i,0,i]}return c}function ar(e,t){const[n,r,i]=e,[s,o,a]=t,{unitsPerMeter:l,unitsPerMeter2:c}=or({longitude:n,latitude:r,highPrecision:!0}),u=nr(e);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const h=rr(u),d=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],d]:h}function lr(e){const{width:t,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=e;let{fovy:u=cr(tr)}=e;void 0!==r&&(u=cr(r));const h=u*Yn,d=i*Yn,f=ur(u);let p=f;o&&(p+=o[2]*a/Math.cos(d)/n);const g=h*(.5+(s?s[1]:0)/n),m=Math.sin(g)*p/Math.sin(Jn(Math.PI/2-d-g,.01,Math.PI-.01)),v=Math.sin(d)*m+p,b=10*p;return{fov:h,aspect:t/n,focalDistance:f,near:l,far:Math.min(v*c,b)}}function cr(e){return 2*Math.atan(.5/e)*Zn}function ur(e){return.5/Math.tan(.5*e*Yn)}function hr(e,t){const[n,r,i=0]=e;return Xn(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Vn(t,[n,r,i,1])}function dr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const[r,i,s]=e;if(Xn(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s)){return Vn(t,[r,i,s,1])}const o=Vn(t,[r,i,0,1]),a=Vn(t,[r,i,1,1]),l=o[2],c=a[2];return Tn([],o,a,l===c?0:((n||0)-l)/(c-l))}function fr(e){const{width:t,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=e,[[a,l],[c,u]]=r,h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("number"===typeof e)return{top:e,bottom:e,left:e,right:e};return Xn(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e}(e.padding),d=nr([a,Jn(u,-85.051129,er)]),f=nr([c,Jn(l,-85.051129,er)]),p=[Math.max(Math.abs(f[0]-d[0]),i),Math.max(Math.abs(f[1]-d[1]),i)],g=[t-h.left-h.right-2*Math.abs(o[0]),n-h.top-h.bottom-2*Math.abs(o[1])];Xn(g[0]>0&&g[1]>0);const m=g[0]/p[0],v=g[1]/p[1],b=(h.right-h.left)/2/m,y=(h.top-h.bottom)/2/v,A=rr([(f[0]+d[0])/2+b,(f[1]+d[1])/2+y]),_=Math.min(s,Wn(Math.abs(Math.min(m,v))));return Xn(Number.isFinite(_)),{longitude:A[0],latitude:A[1],zoom:_}}const pr=Math.PI/180;function gr(e,t,n){const{pixelUnprojectionMatrix:r}=e,i=Vn(r,[t,0,1,1]),s=Vn(r,[t,e.height,1,1]),o=rr(Tn([],i,s,(n*e.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2])));return o.push(n),o}const mr={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(mr,"IDENTITY",{get:()=>(q.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const vr={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},br={common:0,meters:1,pixels:2},yr={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Ar=Math.PI/180,_r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],wr=[0,0,0],Cr={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class Er{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g(this,"id",void 0),g(this,"x",void 0),g(this,"y",void 0),g(this,"width",void 0),g(this,"height",void 0),g(this,"padding",void 0),g(this,"isGeospatial",void 0),g(this,"zoom",void 0),g(this,"focalDistance",void 0),g(this,"position",void 0),g(this,"modelMatrix",void 0),g(this,"distanceScales",void 0),g(this,"scale",void 0),g(this,"center",void 0),g(this,"cameraPosition",void 0),g(this,"projectionMatrix",void 0),g(this,"viewMatrix",void 0),g(this,"viewMatrixUncentered",void 0),g(this,"viewMatrixInverse",void 0),g(this,"viewProjectionMatrix",void 0),g(this,"pixelProjectionMatrix",void 0),g(this,"pixelUnprojectionMatrix",void 0),g(this,"resolution",void 0),g(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||Cr,this.focalDistance=e.focalDistance||1,this.position=e.position||wr,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?vr.WEB_MERCATOR:vr.WEB_MERCATOR_AUTO_OFFSET:vr.IDENTITY}equals(e){return e instanceof Er&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&zt(e.projectionMatrix,this.projectionMatrix)&&zt(e.viewMatrix,this.viewMatrix))}project(e){let{topLeft:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=hr(this.projectPosition(e),this.pixelProjectionMatrix),[r,i]=n,s=t?i:this.height-i;return 2===e.length?[r,s]:[r,s,n[2]]}unproject(e){let{topLeft:t=!0,targetZ:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[r,i,s]=e,o=t?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],l=dr([r,o,s],this.pixelUnprojectionMatrix,a),[c,u,h]=this.unprojectPosition(l);return Number.isFinite(s)?[c,u,h]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(e){const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){if(this.isGeospatial){const t=nr(e);return t[1]=Ut(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?rr(e):e}getBounds(){const e={targetZ:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0},t=this.unproject([0,0],e),n=this.unproject([this.width,0],e),r=this.unproject([0,this.height],e),i=this.unproject([this.width,this.height],e);return[Math.min(t[0],n[0],r[0],i[0]),Math.min(t[1],n[1],r[1],i[1]),Math.max(t[0],n[0],r[0],i[0]),Math.max(t[1],n[1],r[1],i[1])]}getDistanceScales(e){return e?or({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel(e){let{x:t,y:n,width:r=1,height:i=1}=e;return t<this.x+this.width&&this.x<t+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,{left:fn((e=this.viewProjectionMatrix)[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),right:fn(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),bottom:fn(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),top:fn(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),near:fn(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),far:fn(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14])}),this._frustumPlanes;var e}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=ir({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||or({latitude:n,longitude:t}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:i,modelMatrix:s}=e;let o=wr;if(i&&(o=s?new jn(s).transformAsVector(i,[]):i),this.isGeospatial){const e=this.projectPosition([t,n,0]);this.center=new hn(o).scale(this.distanceScales.unitsPerMeter).add(e)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:t=_r,projectionMatrix:n=null,orthographic:r=!1,fovyRadians:i,fovy:s=75,near:o=.1,far:a=1e3,padding:l=null,focalDistance:c=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=(new jn).multiplyRight(t).translate(new hn(this.center).negate()),this.projectionMatrix=n||function(e){let{width:t,height:n,orthographic:r,fovyRadians:i,focalDistance:s,padding:o,near:a,far:l}=e;const c=t/n,u=r?(new jn).orthographic({fovy:i,aspect:c,focalDistance:s,near:a,far:l}):(new jn).perspective({fovy:i,aspect:c,near:a,far:l});if(o){const{left:e=0,right:r=0,top:i=0,bottom:s=0}=o,a=Ut((e+t-r)/2,0,t)-t/2,l=Ut((i+n-s)/2,0,n)-n/2;u[8]-=2*a/t,u[9]+=2*l/n}return u}({width:this.width,height:this.height,orthographic:r,fovyRadians:i||s*Ar,focalDistance:c,padding:l,near:o,far:a});const u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var h;An(u,u,this.projectionMatrix),An(u,u,this.viewMatrix),this.viewProjectionMatrix=u,this.viewMatrixInverse=yn([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(h=this.viewMatrixInverse)[12],h[13],h[14]];const d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];wn(d,d,[this.width/2,-this.height/2,1]),_n(d,d,[1,-1,0]),An(f,d,this.viewProjectionMatrix),this.pixelProjectionMatrix=f,this.pixelUnprojectionMatrix=yn([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||q.warn("Pixel project matrix not invertible")()}}g(Er,"displayName","Viewport");const Br="vs",xr="fs";function Sr(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}const Tr={number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},array:{validate:(e,t)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function Mr(e){let t=Pr(e);return"object"===t?e?"type"in e?Object.assign({},e,Tr[e.type]):"value"in e?(t=Pr(e.value),Object.assign({type:t},e,Tr[t])):{type:"object",value:e}:{type:"object",value:null}:Object.assign({type:t,value:e},Tr[t])}function Pr(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}class Ir{constructor(e){let{name:t,vs:n,fs:r,dependencies:i=[],uniforms:s,getUniforms:o,deprecations:a=[],defines:l={},inject:c={},vertexShader:u,fragmentShader:h}=e;Sr("string"===typeof t),this.name=t,this.vs=n||u,this.fs=r||h,this.getModuleUniforms=o,this.dependencies=i,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(e){const t={vs:{},fs:{}};for(const n in e){let r=e[n];"string"===typeof r&&(r={order:0,injection:r}),t[n.slice(0,2)][n]=r}return t}(c),s&&(this.uniforms=function(e){const t={};for(const n in e){const r=Mr(e[n]);t[n]=r}return t}(s))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:Sr(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(t,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach((n=>{n.regex.test(e)&&(n.deprecated?t.deprecated(n.old,n.new)():t.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(e){return e.forEach((e=>{if("function"===e.type)e.regex=new RegExp("\\b".concat(e.old,"\\("));else e.regex=new RegExp("".concat(e.type," ").concat(e.old,";"))})),e}_defaultGetUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},n=this.uniforms;for(const r in n){const i=n[r];r in e&&!i.private?(i.validate&&Sr(i.validate(e[r],i),"".concat(this.name,": invalid ").concat(r)),t[r]=e[r]):t[r]=i.value}return t}}function Rr(e){return Or(Fr(e))}function Or(e){const t={},n={};return Lr({modules:e,level:0,moduleMap:t,moduleDepth:n}),Object.keys(n).sort(((e,t)=>n[t]-n[e])).map((e=>t[e]))}function Lr(e){let{modules:t,level:n,moduleMap:r,moduleDepth:i}=e;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of t)r[s.name]=s,(void 0===i[s.name]||i[s.name]<n)&&(i[s.name]=n);for(const s of t)s.dependencies&&Lr({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function Fr(e,t){return e.map((e=>(e instanceof Ir||(Sr("string"!==typeof e,"Shader module use by name is deprecated. Import shader module '".concat(e,"' and use it directly.")),Sr(e.name,"shader module has no name"),(e=new Ir(e)).dependencies=Fr(e.dependencies)),e)))}const kr={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Dr={};Object.keys(kr).forEach((e=>{Dr[e]=e}));const Nr={};function jr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=kr[t];if(Sr(r,t),!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t="undefined"!==typeof window&&window.navigator||{},n=e.userAgent||t.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}(n))return!0;if(t in Nr)return Nr[t];const i=r[0],s=n.behavior||"enable",o="#extension GL_".concat(i," : ").concat(s,"\nvoid main(void) {}"),a=e.createShader(35633);e.shaderSource(a,o),e.compileShader(a);const l=e.getShaderParameter(a,35713);return e.deleteShader(a),Nr[t]=l,l}function Ur(e,t){const n=kr[t];Sr(n,t);const r=function(e){return"undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}(e)&&n[1]||n[0],i="string"===typeof r?Boolean(e.getExtension(r)):r;return Sr(!1===i||!0===i),i}function Gr(e,t){return(t=Array.isArray(t)?t:[t]).every((t=>Ur(e,t)))}const zr={[Br]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[xr]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},Vr="__LUMA_INJECT_DECLARATIONS__",Hr=/void\s+main\s*\([^)]*\)\s*\{\n?/,Jr=/}\n?[^{}]*$/,Wr=[];function Xr(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=t===Br;for(const s in n){const t=n[s];t.sort(((e,t)=>e.order-t.order)),Wr.length=t.length;for(let e=0,n=t.length;e<n;++e)Wr[e]=t[e].injection;const r="".concat(Wr.join("\n"),"\n");switch(s){case"vs:#decl":i&&(e=e.replace(Vr,r));break;case"vs:#main-start":i&&(e=e.replace(Hr,(e=>e+r)));break;case"vs:#main-end":i&&(e=e.replace(Jr,(e=>r+e)));break;case"fs:#decl":i||(e=e.replace(Vr,r));break;case"fs:#main-start":i||(e=e.replace(Hr,(e=>e+r)));break;case"fs:#main-end":i||(e=e.replace(Jr,(e=>r+e)));break;default:e=e.replace(s,(e=>e+r))}}return e=e.replace(Vr,""),r&&(e=e.replace(/\}\s*$/,(e=>e+zr[t]))),e}function Kr(e){const t={};return Sr(Array.isArray(e)&&e.length>1),e.forEach((e=>{for(const n in e)t[n]=t[n]?"".concat(t[n],"\n").concat(e[n]):e[n]})),t}function Qr(e){return new RegExp("\\b".concat(e,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const Yr=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Zr=[...Yr,[Qr("attribute"),"in $1"],[Qr("varying"),"out $1"]],qr=[...Yr,[Qr("varying"),"in $1"]],$r=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],ei=[...$r,[Qr("in"),"attribute $1"],[Qr("out"),"varying $1"]],ti=[...$r,[Qr("in"),"varying $1"]],ni="gl_FragColor",ri=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,ii=/void\s+main\s*\([^)]*\)\s*\{\n?/;function si(e,t,n){switch(t){case 300:return n?oi(e,Zr):function(e){e=oi(e,qr);const t=e.match(ri);if(t){const n=t[1];e=e.replace(new RegExp("\\b".concat(ni,"\\b"),"g"),n)}else{const t="fragmentColor";e=e.replace(ii,(e=>"out vec4 ".concat(t,";\n").concat(e))).replace(new RegExp("\\b".concat(ni,"\\b"),"g"),t)}return e}(e);case 100:return n?oi(e,ei):function(e){e=oi(e,ti);const t=e.match(ri);if(t){const n=t[1];e=e.replace(ri,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),ni)}return e}(e);default:throw new Error("unknown GLSL version ".concat(t))}}function oi(e,t){for(const[n,r]of t)e=e.replace(n,r);return e}const ai="\n\n".concat(Vr,"\n\n"),li={[Br]:"vertex",[xr]:"fragment"};function ci(e,t){let{id:n,source:r,type:i,modules:s,defines:o={},hookFunctions:a=[],inject:l={},transpileToGLSL100:c=!1,prologue:u=!0,log:h}=t;Sr("string"===typeof r,"shader source must be a string");const d=i===Br,f=r.split("\n");let p=100,g="",m=r;0===f[0].indexOf("#version ")?(p=300,g=f[0],m=f.slice(1).join("\n")):g="#version ".concat(p);const v={};s.forEach((e=>{Object.assign(v,e.getDefines())})),Object.assign(v,o);let b=u?"".concat(g,"\n").concat(function(e){let{id:t,source:n,type:r}=e;const i=t&&"string"===typeof t&&-1===n.indexOf("SHADER_NAME");return i?"\n#define SHADER_NAME ".concat(t,"_").concat(li[r],"\n\n"):""}({id:n,source:r,type:i}),"\n").concat(function(e){let{type:t}=e;return"\n#define SHADER_TYPE_".concat(li[t].toUpperCase(),"\n")}({type:i}),"\n").concat(function(e){const t=function(e){const t=e.getExtension("WEBGL_debug_renderer_info"),n=e.getParameter(t&&t.UNMASKED_VENDOR_WEBGL||7936),r=e.getParameter(t&&t.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:function(e,t){return e.match(/NVIDIA/i)||t.match(/NVIDIA/i)?"NVIDIA":e.match(/INTEL/i)||t.match(/INTEL/i)?"INTEL":e.match(/AMD/i)||t.match(/AMD/i)||e.match(/ATI/i)||t.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,r),vendor:n,renderer:r,version:e.getParameter(7938),shadingLanguageVersion:e.getParameter(35724)}}(e);switch(t.gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(e),"\n").concat(function(e){let t="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return Gr(e,Dr.GLSL_FRAG_DEPTH)&&(t+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),Gr(e,Dr.GLSL_DERIVATIVES)&&jr(e,Dr.GLSL_DERIVATIVES)&&(t+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),Gr(e,Dr.GLSL_FRAG_DATA)&&jr(e,Dr.GLSL_FRAG_DATA,{behavior:"require"})&&(t+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),Gr(e,Dr.GLSL_TEXTURE_LOD)&&(t+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),t}(e),"\n").concat(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=0,n="";for(const r in e){0===t&&(n+="\n// APPLICATION DEFINES\n"),t++;const i=e[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(e[r],"\n"))}0===t&&(n+="\n");return n}(v),"\n").concat(d?"":"precision highp float;\n\n","\n"):"".concat(g,"\n");const y=function(e){const t={vs:{},fs:{}};return e.forEach((e=>{let n;"string"!==typeof e?(n=e,e=n.hook):n={},e=e.trim();const[r,i]=e.split(":"),s=e.replace(/\(.+/,"");t[r][s]=Object.assign(n,{signature:i})})),t}(a),A={},_={},w={};for(const C in l){const e="string"===typeof l[C]?{injection:l[C],order:0}:l[C],t=C.match(/^(v|f)s:(#)?([\w-]+)$/);if(t){const n=t[2],r=t[3];n?"decl"===r?_[C]=[e]:w[C]=[e]:A[C]=[e]}else w[C]=[e]}for(const C of s){h&&C.checkDeprecations(m,h);b+=C.getModuleSource(i,p);const e=C.injections[i];for(const t in e){const n=t.match(/^(v|f)s:#([\w-]+)$/);if(n){const r="decl"===n[2]?_:w;r[t]=r[t]||[],r[t].push(e[t])}else A[t]=A[t]||[],A[t].push(e[t])}}return b+=ai,b=Xr(b,i,_),b+=function(e,t){let n="";for(const r in e){const i=e[r];if(n+="void ".concat(i.signature," {\n"),i.header&&(n+="  ".concat(i.header)),t[r]){const e=t[r];e.sort(((e,t)=>e.order-t.order));for(const t of e)n+="  ".concat(t.injection,"\n")}i.footer&&(n+="  ".concat(i.footer)),n+="}\n"}return n}(y[i],A),b+=m,b=Xr(b,i,w),b=si(b,c?100:p,d),b}function ui(e){return function(t){const n={};for(const r of e){const e=r.getUniforms(t,n);Object.assign(n,e)}return n}}const hi=new K({id:"luma.gl"});function di(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}const fi="Invalid WebGLRenderingContext";function pi(e){return"undefined"!==typeof WebGLRenderingContext&&e instanceof WebGLRenderingContext||("undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&Number.isFinite(e._version)))}function gi(e){return"undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}function mi(e){return di(pi(e),fi),e}function vi(e){return di(gi(e),"Requires WebGL2"),e}const bi={};function yi(e,t){var n;bi[e]=!0,void 0!==t&&(n=t,globalThis.console&&globalThis.console.error&&globalThis.console.error(n))}const Ai=function e(t){const n=t.gl;this.ext=t,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(t.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const t=new e.VertexAttrib(n);this.attribs[r]=t}this.maxAttrib=0};(Ai.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const _i=function(e){const t=this;this.gl=e,function(e){const t=e.getError;e.getError=function(){let n;do{n=t.apply(e),0!==n&&(bi[n]=!0)}while(0!==n);for(n in bi)if(bi[n])return delete bi[n],parseInt(n,10);return 0}}(e);const n=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(e){return e===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:n.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(e){const r=t.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,e);return r.attribs[e].enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(e){const r=t.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,e);return r.attribs[e].enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(e,r){switch(e){case 34962:t.currentArrayBuffer=r;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=r}return n.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(e,r){const i=t.currentVertexArrayObject.attribs[e];switch(r){case 34975:return i.buffer;case 34338:return i.enabled;case 34339:return i.size;case 34340:return i.stride;case 34341:return i.type;case 34922:return i.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(e,r,i,s,o,a){const l=t.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,e);const c=l.attribs[e];return c.buffer=t.currentArrayBuffer,c.size=r,c.type=i,c.normalized=s,c.stride=o,c.offset=a,c.recache(),n.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",(()=>{var e;e="OESVertexArrayObject emulation library context restored",globalThis.console&&globalThis.console.log&&globalThis.console.log(e),t.reset_()}),!0),this.reset_()};_i.prototype.VERTEX_ARRAY_BINDING_OES=34229,_i.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;const e=this.gl;this.maxVertexAttribs=e.getParameter(34921),this.defaultVertexArrayObject=new Ai(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},_i.prototype.createVertexArrayOES=function(){const e=new Ai(this);return this.vertexArrayObjects.push(e),e},_i.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},_i.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Ai&&e.hasBeenBound&&e.ext===this)},_i.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void yi(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const n=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const i=this.currentVertexArrayObject;if(r===i)return;r&&i.elementArrayBuffer===r.elementArrayBuffer||n.bindBuffer.call(t,34963,i.elementArrayBuffer);let s=this.currentArrayBuffer;const o=Math.max(r?r.maxAttrib:0,i.maxAttrib);for(let a=0;a<=o;a++){const e=i.attribs[a],o=r?r.attribs[a]:null;if(r&&e.enabled===o.enabled||(e.enabled?n.enableVertexAttribArray.call(t,a):n.disableVertexAttribArray.call(t,a)),e.enabled){let i=!1;r&&e.buffer===o.buffer||(s!==e.buffer&&(n.bindBuffer.call(t,34962,e.buffer),s=e.buffer),i=!0),(i||e.cached!==o.cached)&&n.vertexAttribPointer.call(t,a,e.size,e.type,e.normalized,e.stride,e.offset)}}this.currentArrayBuffer!==s&&n.bindBuffer.call(t,34962,this.currentArrayBuffer)};const wi="OES_element_index",Ci="WEBGL_draw_buffers",Ei="WEBGL_debug_renderer_info",Bi=35723,xi=36795,Si=34047,Ti=37445,Mi=37446,Pi=e=>gi(e)?void 0:0,Ii={3074:e=>gi(e)?void 0:36064,[Bi]:e=>gi(e)?void 0:4352,35977:Pi,32937:Pi,[xi]:(e,t)=>{const n=gi(e)?e.getExtension("EXT_disjoint_timer_query_webgl2"):e.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?t(n.GPU_DISJOINT_EXT):0},[Ti]:(e,t)=>{const n=e.getExtension(Ei);return t(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[Mi]:(e,t)=>{const n=e.getExtension(Ei);return t(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[Si]:(e,t)=>{const n=e.luma.extensions.EXT_texture_filter_anisotropic;return n?t(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Pi,35071:Pi,37447:Pi,36063:(e,t)=>{if(!gi(e)){const n=e.getExtension(Ci);return n?t(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Pi,35374:Pi,35377:Pi,34852:e=>{if(!gi(e)){const t=e.getExtension(Ci);return t?t.MAX_DRAW_BUFFERS_WEBGL:0}},36203:e=>e.getExtension(wi)?2147483647:65535,33001:e=>e.getExtension(wi)?16777216:65535,33e3:e=>16777216,37157:Pi,35373:Pi,35657:Pi,36183:Pi,37137:Pi,34045:Pi,35978:Pi,35979:Pi,35968:Pi,35376:Pi,35375:Pi,35659:Pi,37154:Pi,35371:Pi,35658:Pi,35076:Pi,35077:Pi,35380:Pi};const Ri="OES_vertex_array_object",Oi="ANGLE_instanced_arrays",Li="WEBGL_draw_buffers",Fi="EXT_disjoint_timer_query";const ki={[Ri]:{meta:{suffix:"OES"},createVertexArray:()=>{di(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[Oi]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(e,t){di(0===t,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[Li]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{di(!1)}},[Fi]:{meta:{suffix:"EXT"},createQuery:()=>{di(!1)},deleteQuery:()=>{di(!1)},beginQuery:()=>{di(!1)},endQuery:()=>{},getQuery(e,t){return this.getQueryObject(e,t)},getQueryParameter(e,t){return this.getQueryObject(e,t)},getQueryObject:()=>{}}},Di={readBuffer:(e,t,n)=>{gi(e)&&t(n)},getVertexAttrib:(e,t,n,r)=>{const{webgl2:i,ext:s}=function(e,t){return{webgl2:gi(e),ext:e.getExtension(t)}}(e,Oi);let o;switch(r){case 35069:o=!!i&&void 0;break;case 35070:o=i||s?void 0:0}return void 0!==o?o:t(n,r)},getProgramParameter:(e,t,n,r)=>{if(!gi(e))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return t(n,r)},getInternalformatParameter:(e,t,n,r,i)=>gi(e)||32937!==i?e.getInternalformatParameter(n,r,i):new Int32Array([0]),getTexParameter(e,t,n,r){if(34046===r){const{extensions:t}=e.luma,n=t.EXT_texture_filter_anisotropic;r=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return t(n,r)},getParameter:function(e,t,n){const r=Ii[n],i="function"===typeof r?r(e,t,n):r;return void 0!==i?i:t(n)},hint:(e,t,n,r)=>t(n,r)};function Ni(e,t){let{extension:n,target:r,target2:i}=t;const s=ki[n];di(s);const{meta:o={}}=s,{suffix:a=""}=o,l=e.getExtension(n);for(const c of Object.keys(s)){const t="".concat(c).concat(a);let n=null;"meta"===c||"function"===typeof e[c]||(l&&"function"===typeof l[t]?n=function(){return l[t](...arguments)}:"function"===typeof s[c]&&(n=s[c].bind(r))),n&&(r[c]=n,i[c]=n)}}globalThis.polyfillContext=function(e){e.luma=e.luma||{};const{luma:t}=e;return t.polyfilled||(!function(e){if("function"===typeof e.createVertexArray)return;const t=e.getSupportedExtensions;e.getSupportedExtensions=function(){const e=t.call(this)||[];return e.indexOf("OES_vertex_array_object")<0&&e.push("OES_vertex_array_object"),e};const n=e.getExtension;e.getExtension=function(t){return n.call(this,t)||("OES_vertex_array_object"!==t?null:(e.__OESVertexArrayObject||(this.__OESVertexArrayObject=new _i(this)),this.__OESVertexArrayObject))}}(e),function(e){e.luma.extensions={};const t=e.getSupportedExtensions()||[];for(const n of t)e.luma[n]=e.getExtension(n)}(e),function(e,t){for(const n of Object.getOwnPropertyNames(t))"overrides"!==n&&Ni(e,{extension:n,target:e.luma,target2:e})}(e,ki),function(e,t){let{target:n,target2:r}=t;Object.keys(Di).forEach((t=>{if("function"===typeof Di[t]){const i=e[t]?e[t].bind(e):()=>{},s=Di[t].bind(null,e,i);n[t]=s,r[t]=s}}))}(e,{target:t,target2:e}),t.polyfilled=!0),e};const ji={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Ui=(e,t,n)=>t?e.enable(n):e.disable(n),Gi=(e,t,n)=>e.hint(n,t),zi=(e,t,n)=>e.pixelStorei(n,t);function Vi(e){return Array.isArray(e)||ArrayBuffer.isView(e)}const Hi={3042:Ui,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:Ui,2885:(e,t)=>e.cullFace(t),2929:Ui,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:Ui,35723:Gi,36006:(e,t)=>{const n=gi(e)?36009:36160;return e.bindFramebuffer(n,t)},2886:(e,t)=>e.frontFace(t),33170:Gi,2849:(e,t)=>e.lineWidth(t),32823:Ui,32824:"polygonOffset",10752:"polygonOffset",35977:Ui,32938:"sampleCoverage",32939:"sampleCoverage",3089:Ui,3088:(e,t)=>e.scissor(...t),2960:Ui,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),3333:zi,3317:zi,37440:zi,37441:zi,37443:zi,3330:zi,3332:zi,3331:zi,36010:(e,t)=>e.bindFramebuffer(36008,t),3314:zi,32878:zi,3316:zi,3315:zi,32877:zi,framebuffer:(e,t)=>{const n=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,n)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{t=Vi(t)?t:[t,t],e.blendEquationSeparate(...t)},blendFunc:(e,t)=>{t=Vi(t)&&2===t.length?[...t,...t]:t,e.blendFuncSeparate(...t)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(...t),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=Vi(t)?t:[t,t];const[n,r]=t;e.stencilMaskSeparate(1028,n),e.stencilMaskSeparate(1029,r)},stencilFunc:(e,t)=>{t=Vi(t)&&3===t.length?[...t,...t]:t;const[n,r,i,s,o,a]=t;e.stencilFuncSeparate(1028,n,r,i),e.stencilFuncSeparate(1029,s,o,a)},stencilOp:(e,t)=>{t=Vi(t)&&3===t.length?[...t,...t]:t;const[n,r,i,s,o,a]=t;e.stencilOpSeparate(1028,n,r,i),e.stencilOpSeparate(1029,s,o,a)},viewport:(e,t)=>e.viewport(...t)};function Ji(e,t,n){return void 0!==t[e]?t[e]:n[e]}const Wi={blendEquation:(e,t,n)=>e.blendEquationSeparate(Ji(32777,t,n),Ji(34877,t,n)),blendFunc:(e,t,n)=>e.blendFuncSeparate(Ji(32969,t,n),Ji(32968,t,n),Ji(32971,t,n),Ji(32970,t,n)),polygonOffset:(e,t,n)=>e.polygonOffset(Ji(32824,t,n),Ji(10752,t,n)),sampleCoverage:(e,t,n)=>e.sampleCoverage(Ji(32938,t,n),Ji(32939,t,n)),stencilFuncFront:(e,t,n)=>e.stencilFuncSeparate(1028,Ji(2962,t,n),Ji(2967,t,n),Ji(2963,t,n)),stencilFuncBack:(e,t,n)=>e.stencilFuncSeparate(1029,Ji(34816,t,n),Ji(36003,t,n),Ji(36004,t,n)),stencilOpFront:(e,t,n)=>e.stencilOpSeparate(1028,Ji(2964,t,n),Ji(2965,t,n),Ji(2966,t,n)),stencilOpBack:(e,t,n)=>e.stencilOpSeparate(1029,Ji(34817,t,n),Ji(34818,t,n),Ji(34819,t,n))},Xi={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,n)=>e({[t]:n}),hint:(e,t,n)=>e({[t]:n}),bindFramebuffer:(e,t,n)=>{switch(t){case 36160:return e({36006:n,36010:n});case 36009:return e({36006:n});case 36008:return e({36010:n});default:return null}},blendColor:(e,t,n,r,i)=>e({32773:new Float32Array([t,n,r,i])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,n)=>e({32777:t,34877:n}),blendFunc:(e,t,n)=>e({32969:t,32968:n,32971:t,32970:n}),blendFuncSeparate:(e,t,n,r,i)=>e({32969:t,32968:n,32971:r,32970:i}),clearColor:(e,t,n,r,i)=>e({3106:new Float32Array([t,n,r,i])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,n,r,i)=>e({3107:[t,n,r,i]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,n)=>e({2928:new Float32Array([t,n])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,n)=>e({32824:t,10752:n}),sampleCoverage:(e,t,n)=>e({32938:t,32939:n}),scissor:(e,t,n,r,i)=>e({3088:new Int32Array([t,n,r,i])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,n)=>e({[1028===t?2968:36005]:n}),stencilFunc:(e,t,n,r)=>e({2962:t,2967:n,2963:r,34816:t,36003:n,36004:r}),stencilFuncSeparate:(e,t,n,r,i)=>e({[1028===t?2962:34816]:n,[1028===t?2967:36003]:r,[1028===t?2963:36004]:i}),stencilOp:(e,t,n,r)=>e({2964:t,2965:n,2966:r,34817:t,34818:n,34819:r}),stencilOpSeparate:(e,t,n,r,i)=>e({[1028===t?2964:34817]:n,[1028===t?2965:34818]:r,[1028===t?2966:34819]:i}),viewport:(e,t,n,r,i)=>e({2978:[t,n,r,i]})},Ki=(e,t)=>e.isEnabled(t),Qi={3042:Ki,2884:Ki,2929:Ki,3024:Ki,32823:Ki,32926:Ki,32928:Ki,3089:Ki,2960:Ki,35977:Ki};function Yi(e){for(const t in e)return!1;return!0}function Zi(e,t){if(e===t)return!0;const n=Array.isArray(e)||ArrayBuffer.isView(e),r=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&r&&e.length===t.length){for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}return!1}function qi(e,t){const n=e[t].bind(e);e[t]=function(){const t=arguments.length<=0?void 0:arguments[0];return t in e.state.cache&&e.state.enable?e.state.cache[t]:n(...arguments)},Object.defineProperty(e[t],"name",{value:"".concat(t,"-from-cache"),configurable:!1})}function $i(e,t,n){const r=e[t].bind(e);e[t]=function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];const{valueChanged:o,oldValue:a}=n(e.state._updateCache,...i);return o&&r(...i),a},Object.defineProperty(e[t],"name",{value:"".concat(t,"-to-cache"),configurable:!1})}class es{constructor(e){let{copyState:t=!1,log:n=()=>{}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(e,t){if("number"===typeof(t=t||ji)){const n=t,r=Qi[n];return r?r(e,n):e.getParameter(n)}const n=Array.isArray(t)?t:Object.keys(t),r={};for(const i of n){const t=Qi[i];r[i]=t?t(e,Number(i)):e.getParameter(Number(i))}return r}(e):Object.assign({},ji),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){di(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];rs(this.gl,e),this.stateStack.pop()}_updateCache(e){let t,n=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const i in e){di(void 0!==i);const s=e[i],o=this.cache[i];Zi(s,o)||(n=!0,t=o,r&&!(i in r)&&(r[i]=o),this.cache[i]=s)}return{valueChanged:n,oldValue:t}}}function ts(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:n=!0,copyState:r}=t;if(di(void 0!==r),!e.state){const{polyfillContext:t}=globalThis;t&&t(e),e.state=new es(e,{copyState:r}),function(e){const t=e.useProgram.bind(e);e.useProgram=function(n){e.state.program!==n&&(t(n),e.state.program=n)}}(e);for(const n in Xi){$i(e,n,Xi[n])}qi(e,"getParameter"),qi(e,"isEnabled")}return e.state.enable=n,e}function ns(e){di(e.state),e.state.pop()}function rs(e,t){if(di(pi(e),"setParameters requires a WebGL context"),Yi(t))return;const n={};for(const i in t){const r=Number(i),s=Hi[i];s&&("string"===typeof s?n[s]=!0:s(e,t[i],r))}const r=e.state&&e.state.cache;if(r)for(const i in n){(0,Wi[i])(e,t,r)}}function is(e,t,n){if(Yi(t))return n(e);const{nocatch:r=!0}=t;let i;if(function(e){e.state||ts(e,{copyState:!1}),e.state.push()}(e),rs(e,t),r)i=n(e),ns(e);else try{i=n(e)}finally{ns(e)}return i}function ss(e){const{luma:t}=e;if(e.canvas&&t){const n=t.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:e.canvas.clientWidth;return r?e.drawingBufferWidth/r:1}return 1}function os(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(e,t,n,r,i){const s=as(e[0],t,n);let o=ls(e[1],t,r,i),a=as(e[0]+1,t,n);const l=a===n-1?a:a-1;let c;a=ls(e[1]+1,t,r,i),i?(a=0===a?a:a+1,c=o,o=a):c=a===r-1?a:a-1;return{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}(t,ss(e),e.drawingBufferWidth,e.drawingBufferHeight,n)}function as(e,t,n){return Math.min(Math.round(e*t),n-1)}function ls(e,t,n,r){return r?Math.max(0,n-1-Math.round(e*t)):Math.min(Math.round(e*t),n-1)}const cs=R(),us=cs&&"undefined"!==typeof document,hs={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function ds(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};di(cs,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),e=Object.assign({},hs,e);const{width:t,height:n}=e;function r(t){if(e.throwOnError)throw new Error(t);return console.error(t),null}let i;e.onError=r;const{canvas:s}=e,o=function(e){let t,{canvas:n,width:r=800,height:i=600,onError:s}=e;if("string"===typeof n){us&&"complete"===document.readyState||s("createGLContext called on canvas '".concat(n,"' before page was loaded")),t=document.getElementById(n)}else n?t=n:(t=document.createElement("canvas"),t.id="lumagl-canvas",t.style.width=Number.isFinite(r)?"".concat(r,"px"):"100%",t.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",document.body.insertBefore(t,document.body.firstChild));return t}({canvas:s,width:t,height:n,onError:r});return i=function(e,t){const{onError:n}=t;let r=null;const i=e=>r=e.statusMessage||r;e.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:o=!0}=t;let a=null;o&&(a=a||e.getContext("webgl2",t),a=a||e.getContext("experimental-webgl2",t));s&&(a=a||e.getContext("webgl",t),a=a||e.getContext("experimental-webgl",t));if(e.removeEventListener("webglcontextcreationerror",i,!1),!a)return n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"));t.onContextLost&&e.addEventListener("webglcontextlost",t.onContextLost,!1);t.onContextRestored&&e.addEventListener("webglcontextrestored",t.onContextRestored,!1);return a}(o,e),i?(i=fs(i,e),function(e){const t=gi(e)?"WebGL2":"WebGL1",n=function(e){const t=e.getParameter(7936),n=e.getParameter(7937),r=e.getExtension("WEBGL_debug_renderer_info"),i=r&&e.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&e.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||t,renderer:s||n,vendorMasked:t,rendererMasked:n,version:e.getParameter(7938),shadingLanguageVersion:e.getParameter(35724)}}(e),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=e.debug?" debug":"";hi.info(1,"".concat(t).concat(i," context ").concat(r))()}(i),i):null}function fs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||e._instrumented)return e;e._version=e._version||function(e){if("undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)return 2;return 1}(e),e.luma=e.luma||{},e.luma.canvasSizeInfo=e.luma.canvasSizeInfo||{},t=Object.assign({},hs,t);const{manageState:n,debug:r}=t;return n&&ts(e,{copyState:!1,log:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return hi.log(1,...t)()}}),cs&&r&&(globalThis.makeDebugContext?(e=globalThis.makeDebugContext(e,t),hi.level=Math.max(hi.level,1)):hi.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),e._instrumented=!0,e}function ps(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.canvas){return void function(e,t,n){let r="width"in n?n.width:e.canvas.clientWidth,i="height"in n?n.height:e.canvas.clientHeight;r&&i||(hi.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,r=e.canvas.width||1,i=e.canvas.height||1);e.luma=e.luma||{},e.luma.canvasSizeInfo=e.luma.canvasSizeInfo||{};const s=e.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==t){let n=t;const s=Math.floor(r*n),o=Math.floor(i*n);e.canvas.width=s,e.canvas.height=o,e.drawingBufferWidth===s&&e.drawingBufferHeight===o||(hi.warn("Device pixel ratio clamped")(),n=Math.min(e.drawingBufferWidth/r,e.drawingBufferHeight/i),e.canvas.width=Math.floor(r*n),e.canvas.height=Math.floor(i*n)),Object.assign(e.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:t})}}(e,function(e){const t="undefined"===typeof window?1:window.devicePixelRatio||1;return Number.isFinite(e)?e<=0?1:e:e?t:1}(t.useDevicePixels),t)}const n=e.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in t&&"height"in t&&n.resize(t.width,t.height)}const gs="8.5.21";const ms=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new ae({id:e})),this.stats.get(e)}};if(globalThis.luma&&globalThis.luma.VERSION!==gs)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(gs));globalThis.luma||(R()&&hi.log(1,"luma.gl ".concat(gs," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:gs,version:gs,log:hi,stats:ms,globals:{modules:{},nodeIO:{}}});globalThis.luma;function vs(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}function bs(e,t){if("string"!==typeof t)return t;const n=Number(t);if(!isNaN(n))return n;const r=e[t=t.replace(/^.*\./,"")];return vs(void 0!==r,"Accessing undefined constant GL.".concat(t)),r}function ys(e,t){t=Number(t);for(const n in e)if(e[n]===t)return"GL.".concat(n);return String(t)}const As={};function _s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";As[e]=As[e]||1;const t=As[e]++;return"".concat(e,"-").concat(t)}function ws(e){return vs("number"===typeof e,"Input must be a number"),e&&0===(e&e-1)}function Cs(e){let t=!0;for(const n in e){t=!1;break}return t}function Es(e,t,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(e);r.forEach((e=>{s.methodName||(s[e]=()=>{throw hi.removed("Calling removed method ".concat(t,".").concat(e,": "),i)(),new Error(e)})}))}const Bs="Resource subclass must define virtual methods";class xs{get[Symbol.toStringTag](){return"Resource"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};mi(e);const{id:n,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=n||_s(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach((e=>e.delete())),this}bind(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!==typeof t?(this._bindHandle(t),this):(this._bound?e=t():(this._bindHandle(this.handle),this._bound=!0,e=t(),this._bound=!1,this._bindHandle(null)),e)}unbind(){this.bind(null)}getParameter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vs(e=bs(this.gl,e));const n=(this.constructor.PARAMETERS||{})[e];if(n){const e=gi(this.gl);if(!((!("webgl2"in n)||e)&&(!("extension"in n)||this.gl.getExtension(n.extension)))){const t=n.webgl1,r="webgl2"in n?n.webgl2:n.webgl1;return e?r:t}}return this._getParameter(e,t)}getParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:t,keys:n}=e,r=this.constructor.PARAMETERS||{},i=gi(this.gl),s={},o=t||Object.keys(r);for(const a of o){const t=r[a];if(t&&(!("webgl2"in t)||i)&&(!("extension"in t)||this.gl.getExtension(t.extension))){const r=n?ys(this.gl,a):a;s[r]=this.getParameter(a,e),n&&"GLenum"===t.type&&(s[r]=ys(this.gl,s[r]))}}return s}setParameter(e,t){vs(e=bs(this.gl,e));const n=(this.constructor.PARAMETERS||{})[e];if(n){const e=gi(this.gl);if(!((!("webgl2"in n)||e)&&(!("extension"in n)||this.gl.getExtension(n.extension))))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(t=bs(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,n){return Es(this,e,t,n)}initialize(e){}_createHandle(){throw new Error(Bs)}_deleteHandle(){throw new Error(Bs)}_bindHandle(e){throw new Error(Bs)}_getOptsFromHandle(){throw new Error(Bs)}_getParameter(e,t){throw new Error(Bs)}_setParameter(e,t){throw new Error(Bs)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],t=ms.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get("".concat(e,"s Created")).incrementCount(),t.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];ms.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,t),this._trackAllocatedMemoryForContext(e,t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const r=ms.get("Memory Usage".concat(n));r.get("GPU Memory").addCount(e),r.get("".concat(t," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=ms.get("Memory Usage".concat(t));n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(e," Memory")).subtractCount(this.byteLength)}}function Ss(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function Ts(e){let{clamped:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return t?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Ms(e){let{data:t,width:n,height:r}=e;const i=Math.round(n/2),s=Math.round(r/2),o=new Uint8Array(i*s*4);for(let a=0;a<s;a++)for(let e=0;e<i;e++)for(let r=0;r<4;r++)o[4*(a*i+e)+r]=t[4*(2*a*n+2*e)+r];return{data:o,width:i,height:s}}function Ps(e,t,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in t){const t=r[a]?"".concat(e,".").concat(r[a]):"N/A";hi.removed("".concat(e,".").concat(a),t)()}for(const a in i)if(a in t){const t=i[a];hi.deprecated("".concat(e,".").concat(a),"".concat(e,".").concat(t))()}let o=null;for(const a in s)if(a in t){const n=s[a];hi.deprecated("".concat(e,".").concat(a),"".concat(e,".").concat(n))(),o=o||Object.assign({},t),o[n]=t[a],delete o[a]}return o||t}const Is={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Rs={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Os{static getBytesPerElement(e){return Ts(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){vs(e.size);return Ts(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Os(...[Is,...t])}constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>this._assign(e))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Os.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Os.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=Ps("Accessor",e,Rs),void 0!==e.type&&(this.type=e.type,5124!==e.type&&5125!==e.type||(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&("boolean"===typeof e.index?this.index=e.index?1:0:this.index=e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const Ls={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Fs={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:Ls},ks={removedProps:Ls};class Ds extends xs{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/Os.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/Os.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=Ps("Buffer",e,Fs),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=Ps("Buffer",e,ks))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new Os(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:n=0,srcOffset:r=0}=e,i=e.byteLength||e.length;vs(t);const s=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(s,this.handle),0!==r||void 0!==i?(vi(this.gl),this.gl.bufferSubData(this.target,n,t,r,i)):this.gl.bufferSubData(s,n,t),this.gl.bindBuffer(s,null),this.debugData=null,this._inferType(t),this}copyData(e){let{sourceBuffer:t,readOffset:n=0,writeOffset:r=0,size:i}=e;const{gl:s}=this;return vi(s),s.bindBuffer(36662,t.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,n,r,i),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:t=0,dstOffset:n=0,length:r=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};vi(this.gl);const i=Ts(this.accessor.type||5126,{clamped:!1}),s=this._getAvailableElementCount(t),o=n;let a,l;e?(l=e.length,a=l-o):(a=Math.min(s,r||s),l=o+a);const c=Math.min(s,a);return r=r||c,vs(r<=c),e=e||new i(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,n,r),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:n=0,size:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,n,r):(vs(0===n),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength+t;vs(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const i=Ss(e);return vs(i),this.setAccessor(new Os(this.accessor,{type:i})),this}_setByteLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;vs(e>=0),this._trackDeallocatedMemory();let n=e;0===e&&(n=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const t=e/Ts(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-t}_inferType(e){this.accessor.type||this.setAccessor(new Os(this.accessor,{type:Ss(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return hi.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return hi.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return hi.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return hi.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Os(this.accessor,e),this}}const Ns={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},js={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},Us={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};const Gs=[9729,9728],zs=globalThis.WebGLBuffer||function(){};class Vs extends xs{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:n,linearFiltering:r}=t;let i=!0;return n&&(i=i&&function(e,t){const n=Ns[t];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const r=gi(e)&&n.gl2||n.gl1;return"string"===typeof r?e.getExtension(r):r}(e,n),i=i&&(!r||function(e,t){const n=Ns[t];switch(n&&n.types[0]){case 5126:return e.getExtension("OES_texture_float_linear");case 5131:return e.getExtension("OES_texture_half_float_linear");default:return!0}}(e,n))),i}constructor(e,t){const{id:n=_s("texture"),handle:r,target:i}=t;super(e,{id:n,handle:r}),this.target=i,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data;if(t instanceof Promise)return t.then((t=>this.initialize(Object.assign({},e,{pixels:t,data:t})))),this;const n="undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(n&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",(()=>this.initialize(e))),this;const{pixels:r=null,format:i=6408,border:s=0,recreate:o=!1,parameters:a={},pixelStore:l={},textureUnit:c}=e;t||(t=r);let{width:u,height:h,dataFormat:d,type:f,compressed:p=!1,mipmaps:g=!0}=e;const{depth:m=0}=e;return({width:u,height:h,compressed:p,dataFormat:d,type:f}=this._deduceParameters({format:i,type:f,dataFormat:d,compressed:p,data:t,width:u,height:h})),this.width=u,this.height=h,this.depth=m,this.format=i,this.type=f,this.dataFormat=d,this.border=s,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),g&&this._isNPOT()&&(hi.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),g=!1,this._updateForNPOT(a)),this.mipmaps=g,this.setImageData({data:t,width:u,height:h,depth:m,format:i,type:f,dataFormat:d,border:s,mipmaps:g,parameters:l,compressed:p}),g&&this.generateMipmap(),this.setParameters(a),o&&(this.data=t),n&&(this._video={video:t,parameters:a,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:n}=this._video;if(n===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:t,width:n,mipmaps:r=!1}=e;return n!==this.width||t!==this.height?this.initialize({width:n,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(hi.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),is(this.gl,e,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:n=null,level:r=0,format:i=this.format,border:s=this.border,offset:o=0,parameters:a={}}=e;let{data:l=null,type:c=this.type,width:u=this.width,height:h=this.height,dataFormat:d=this.dataFormat,compressed:f=!1}=e;l||(l=n),({type:c,dataFormat:d,compressed:f,width:u,height:h}=this._deduceParameters({format:i,type:c,dataFormat:d,compressed:f,data:l,width:u,height:h}));const{gl:p}=this;p.bindTexture(this.target,this.handle);let g,m=null;({data:l,dataType:m}=this._getDataType({data:l,compressed:f}));let v=0;if(is(this.gl,a,(()=>{switch(m){case"null":p.texImage2D(t,r,i,u,h,s,d,c,l);break;case"typed-array":p.texImage2D(t,r,i,u,h,s,d,c,l,o);break;case"buffer":g=vi(p),g.bindBuffer(35052,l.handle||l),g.texImage2D(t,r,i,u,h,s,d,c,o),g.bindBuffer(35052,null);break;case"browser-object":gi(p)?p.texImage2D(t,r,i,u,h,s,d,c,l):p.texImage2D(t,r,i,d,c,l);break;case"compressed":for(const[e,n]of l.entries())p.compressedTexImage2D(t,e,n.format,n.width,n.height,s,n.data),v+=n.levelSize;break;default:vs(!1,"Unknown image data type")}})),"compressed"===m)this._trackAllocatedMemory(v,"Texture");else if(l&&l.byteLength)this._trackAllocatedMemory(l.byteLength,"Texture");else{const e=js[this.dataFormat]||4,t=Us[this.type]||1;this._trackAllocatedMemory(this.width*this.height*e*t,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:t=this.target,pixels:n=null,data:r=null,x:i=0,y:s=0,width:o=this.width,height:a=this.height,level:l=0,format:c=this.format,type:u=this.type,dataFormat:h=this.dataFormat,compressed:d=!1,offset:f=0,border:p=this.border,parameters:g={}}=e;if(({type:u,dataFormat:h,compressed:d,width:o,height:a}=this._deduceParameters({format:c,type:u,dataFormat:h,compressed:d,data:r,width:o,height:a})),vs(0===this.depth,"texSubImage not supported for 3D textures"),r||(r=n),r&&r.data){const e=r;r=e.data,o=e.shape[0],a=e.shape[1]}r instanceof Ds&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),is(this.gl,g,(()=>{if(d)this.gl.compressedTexSubImage2D(t,l,i,s,o,a,c,r);else if(null===r)this.gl.texSubImage2D(t,l,i,s,o,a,h,u,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(t,l,i,s,o,a,h,u,r,f);else if(r instanceof zs){const e=vi(this.gl);e.bindBuffer(35052,r),e.texSubImage2D(t,l,i,s,o,a,h,u,f),e.bindBuffer(35052,null)}else if(gi(this.gl)){vi(this.gl).texSubImage2D(t,l,i,s,o,a,h,u,r)}else this.gl.texSubImage2D(t,l,i,s,h,u,r)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return hi.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType(e){let{data:t,compressed:n=!1}=e;return n?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof Ds?{data:t.handle,dataType:"buffer"}:t instanceof zs?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:n}=e;let{width:r,height:i,dataFormat:s,type:o,compressed:a}=e;const l=Ns[t];return s=s||l&&l.dataFormat,o=o||l&&l.types[0],a=a||l&&l.compressed,({width:r,height:i}=this._deduceImageSize(n,r,i)),{dataFormat:s,type:o,compressed:a,width:r,height:i,format:t,data:n}}_deduceImageSize(e,t,n){let r;return r="undefined"!==typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:n}:{width:t>=0?t:1,height:n>=0?n:1},vs(r,"Could not deduced texture size"),vs(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),vs(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:vs(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!gi(this.gl)&&(!(!this.width||!this.height)&&(!ws(this.width)||!ws(this.height)))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===Gs.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}let Hs="";class Js extends Vs{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,t){return Vs.isSupported(e,t)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,r;mi(e),(t instanceof Promise||"string"===typeof t)&&(t={data:t}),"string"===typeof t.data&&(t=Object.assign({},t,{data:(n=t.data,vs("string"===typeof n),n=Hs+n,new Promise(((e,t)=>{try{const i=new Image;i.onload=()=>e(i),i.onerror=()=>t(new Error("Could not load image ".concat(n,"."))),i.crossOrigin=r&&r.crossOrigin||"anonymous",i.src=n}catch(i){t(i)}})))})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const Ws="EXT_color_buffer_float",Xs={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Ws,bpp:2},33327:{gl2:Ws,bpp:4},34842:{gl2:Ws,bpp:8},33326:{gl2:Ws,bpp:4},33328:{gl2:Ws,bpp:8},34836:{gl2:Ws,bpp:16},35898:{gl2:Ws,bpp:4}};class Ks extends xs{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!t||function(e,t,n){const r=n[t];if(!r)return!1;const i=gi(e)&&r.gl2||r.gl1;return"string"===typeof i?e.getExtension(i):i}(e,t,Xs)}static getSamplesForFormat(e,t){let{format:n}=t;return e.getInternalformatParameter(36161,n,32937)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.initialize(t),Object.seal(this)}initialize(e){let{format:t,width:n=1,height:r=1,samples:i=0}=e;return vs(t,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==i&&gi(this.gl)?this.gl.renderbufferStorageMultisample(36161,i,t,n,r):this.gl.renderbufferStorage(36161,t,n,r),this.format=t,this.width=n,this.height=r,this.samples=i,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Xs[this.format].bpp),this}resize(e){let{width:t,height:n}=e;return t!==this.width||n!==this.height?this.initialize({width:t,height:n,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){this.gl.bindRenderbuffer(36161,this.handle);return this.gl.getRenderbufferParameter(36161,e)}}const Qs=6144,Ys="clear: bad arguments";function Zs(e){let{framebuffer:t=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s={};t&&(s.framebuffer=t);let o=0;n&&(o|=16384,!0!==n&&(s.clearColor=n)),r&&(o|=256,!0!==r&&(s.clearDepth=r)),i&&(o|=1024,!0!==r&&(s.clearStencil=r)),vs(0!==o,Ys),is(e,s,(()=>{e.clear(o)}))}const qs=[34069,34070,34071,34072,34073,34074];class $s extends Vs{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};mi(e),super(e,Object.assign({},t,{target:34067})),this.initialize(t),Object.seal(this)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:t=!0,parameters:n={}}=e;return this.opts=e,this.setCubeMapImageData(e).then((()=>{this.loaded=!0,t&&this.generateMipmap(e),this.setParameters(n)})),this}subImage(e){let{face:t,data:n,x:r=0,y:i=0,mipmapLevel:s=0}=e;return this._subImage({target:t,data:n,x:r,y:i,mipmapLevel:s})}async setCubeMapImageData(e){let{width:t,height:n,pixels:r,data:i,border:s=0,format:o=6408,type:a=5121}=e;const{gl:l}=this,c=r||i,u=await Promise.all(qs.map((e=>{const t=c[e];return Promise.all(Array.isArray(t)?t:[t])})));this.bind(),qs.forEach(((e,r)=>{u[r].length>1&&!1!==this.opts.mipmaps&&hi.warn("".concat(this.id," has mipmap and multiple LODs."))(),u[r].forEach(((r,i)=>{t&&n?l.texImage2D(e,i,o,t,n,s,o,a,r):l.texImage2D(e,i,o,o,a,r)}))})),this.unbind()}setImageDataForFace(e){const{face:t,width:n,height:r,pixels:i,data:s,border:o=0,format:a=6408,type:l=5121}=e,{gl:c}=this,u=i||s;return this.bind(),u instanceof Promise?u.then((n=>this.setImageDataForFace(Object.assign({},e,{face:t,data:n,pixels:n})))):this.width||this.height?c.texImage2D(t,0,a,n,r,o,a,l,u):c.texImage2D(t,0,a,a,l,u),this}}$s.FACES=qs;class eo extends Vs{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return gi(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vi(e),t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1}),super(e,t),this.initialize(t),Object.seal(this)}setImageData(e){let{level:t=0,dataFormat:n=6408,width:r,height:i,depth:s=1,border:o=0,format:a,type:l=5121,offset:c=0,data:u,parameters:h={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),is(this.gl,h,(()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,t,n,r,i,s,o,a,l,u),u instanceof Ds&&(this.gl.bindBuffer(35052,u.handle),this.gl.texImage3D(this.target,t,n,r,i,s,o,a,l,c))})),u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const e=js[this.dataFormat]||4,t=Us[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*e*t,"Texture")}return this.loaded=!0,this}}function to(e,t){const{gl:n,width:r,height:i,id:s}=e;return new Oo(n,Object.assign({},t,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{36064:e}}))}function no(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=t;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=t;const{framebuffer:u,deleteFramebuffer:h}=io(e);vs(u);const{gl:d,handle:f,attachments:p}=u;a=a||u.width,l=l||u.height,36064===s&&null===f&&(s=1028),vs(p[s]),c=c||p[s].type,o=function(e,t,n,r,i){if(e)return e;const s=Ts(t=t||5121,{clamped:!1}),o=function(e){switch(e){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return vs(!1),0}}(n);return new s(r*i*o)}(o,c,i,a,l),c=c||Ss(o);const g=d.bindFramebuffer(36160,f);return d.readPixels(n,r,a,l,i,c,o),d.bindFramebuffer(36160,g||null),h&&u.delete(),o}function ro(e){let{sourceAttachment:t=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=no(e,{sourceAttachment:t}),{width:i,height:s}=e;for(;s>n;)({data:r,width:i,height:s}=Ms({data:r,width:i,height:s}));!function(e){let{data:t,width:n,height:r,bytesPerPixel:i=4,temp:s}=e;const o=n*i;s=s||new Uint8Array(o);for(let a=0;a<r/2;++a){const e=a*o,n=(r-a-1)*o;s.set(t.subarray(e,e+o)),t.copyWithin(e,n,n+o),t.set(s,n)}}({data:r,width:i,height:s});const o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d"),l=a.createImageData(i,s);return l.data.set(r),a.putImageData(l,0,0),o.toDataURL()}function io(e){return e instanceof Oo?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:to(e),deleteFramebuffer:!0}}const so="WEBGL2",oo="VERTEX_ARRAY_OBJECT",ao="TIMER_QUERY",lo="INSTANCED_RENDERING",co="MULTIPLE_RENDER_TARGETS",uo="ELEMENT_INDEX_UINT32",ho="BLEND_EQUATION_MINMAX",fo="FLOAT_BLEND",po="COLOR_ENCODING_SRGB",go="TEXTURE_DEPTH",mo="TEXTURE_FLOAT",vo="TEXTURE_HALF_FLOAT",bo="TEXTURE_FILTER_LINEAR_FLOAT",yo="TEXTURE_FILTER_LINEAR_HALF_FLOAT",Ao="TEXTURE_FILTER_ANISOTROPIC",_o="COLOR_ATTACHMENT_RGBA32F",wo="COLOR_ATTACHMENT_FLOAT",Co="COLOR_ATTACHMENT_HALF_FLOAT",Eo="GLSL_FRAG_DATA",Bo="GLSL_FRAG_DEPTH",xo="GLSL_DERIVATIVES",So="GLSL_TEXTURE_LOD";const To={[so]:[!1,!0],[oo]:["OES_vertex_array_object",!0],[ao]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[lo]:["ANGLE_instanced_arrays",!0],[co]:["WEBGL_draw_buffers",!0],[uo]:["OES_element_index_uint",!0],[ho]:["EXT_blend_minmax",!0],[fo]:["EXT_float_blend"],[po]:["EXT_sRGB",!0],[go]:["WEBGL_depth_texture",!0],[mo]:["OES_texture_float",!0],[vo]:["OES_texture_half_float",!0],[bo]:["OES_texture_float_linear"],[yo]:["OES_texture_half_float_linear"],[Ao]:["EXT_texture_filter_anisotropic"],[_o]:[function(e){const t=new Js(e,{format:6408,type:5126,dataFormat:6408}),n=new Oo(e,{id:"test-framebuffer",check:!1,attachments:{36064:t}}),r=n.getStatus();return t.delete(),n.delete(),36053===r},"EXT_color_buffer_float"],[wo]:[!1,"EXT_color_buffer_float"],[Co]:["EXT_color_buffer_half_float"],[Eo]:["WEBGL_draw_buffers",!0],[Bo]:["EXT_frag_depth",!0],[xo]:["OES_standard_derivatives",!0],[So]:["EXT_shader_texture_lod",!0]};function Mo(e,t){return Po(e,t)}function Po(e,t){return(t=Array.isArray(t)?t:[t]).every((t=>Io(e,t)))}function Io(e,t){return e.luma=e.luma||{},e.luma.caps=e.luma.caps||{},void 0===e.luma.caps[t]&&(e.luma.caps[t]=function(e,t){const n=To[t];let r;vs(n,t);const i=gi(e)&&n[1]||n[0];if("function"===typeof i)r=i(e);else if(Array.isArray(i)){r=!0;for(const t of i)r=r&&Boolean(e.getExtension(t))}else"string"===typeof i?r=Boolean(e.getExtension(i)):"boolean"===typeof i?r=i:vs(!1);return r}(e,t)),e.luma.caps[t]||hi.log(2,"Feature: ".concat(t," not supported"))(),e.luma.caps[t]}const Ro="Multiple render targets not supported";class Oo extends xs{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:n,colorBufferHalfFloat:r}=t;let i=!0;return n&&(i=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(i=i&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),i}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Oo(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=vi(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=vi(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:t=1,height:n=1,attachments:r=null,color:i=!0,depth:s=!0,stencil:o=!1,check:a=!0,readBuffer:l,drawBuffers:c}=e;if(vs(t>=0&&n>=0,"Width and height need to be integers"),this.width=t,this.height=n,r)for(const u in r){const e=r[u];(Array.isArray(e)?e[0]:e).resize({width:t,height:n})}else r=this._createDefaultAttachments(i,s,o,t,n);this.update({clearAttachments:!0,attachments:r,readBuffer:l,drawBuffers:c}),r&&a&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:t={},readBuffer:n,drawBuffers:r,clearAttachments:i=!1,resizeAttachments:s=!0}=e;this.attach(t,{clearAttachments:i,resizeAttachments:s});const{gl:o}=this,a=o.bindFramebuffer(36160,this.handle);return n&&this._setReadBuffer(n),r&&this._setDrawBuffers(r),o.bindFramebuffer(36160,a||null),this}resize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:t,height:n}=e;if(null===this.handle)return vs(void 0===t&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),t!==this.width&&n!==this.height&&hi.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(t,"x").concat(n))();for(const r in this.attachments)this.attachments[r].resize({width:t,height:n});return this.width=t,this.height=n,this}attach(e){let{clearAttachments:t=!1,resizeAttachments:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={};t&&Object.keys(this.attachments).forEach((e=>{r[e]=null})),Object.assign(r,e);const i=this.gl.bindFramebuffer(36160,this.handle);for(const s in r){vs(void 0!==s,"Misspelled framebuffer binding point?");const e=Number(s),t=r[e];let i=t;if(i)if(i instanceof Ks)this._attachRenderbuffer({attachment:e,renderbuffer:i});else if(Array.isArray(t)){const[n,r=0,s=0]=t;i=n,this._attachTexture({attachment:e,texture:n,layer:r,level:s})}else this._attachTexture({attachment:e,texture:i,layer:0,level:0});else this._unattach(e);n&&i&&i.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,i||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter((e=>!this.attachments[e])).forEach((e=>{delete this.attachments[e]}))}checkStatus(){const{gl:e}=this,t=this.getStatus();if(36053!==t)throw new Error(function(e){return(Oo.STATUS||{})[e]||"Framebuffer error ".concat(e)}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),n=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),n}clear(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:t,depth:n,stencil:r,drawBuffers:i=[]}=e,s=this.gl.bindFramebuffer(36160,this.handle);return(t||n||r)&&Zs(this.gl,{color:t,depth:n,stencil:r}),i.forEach(((e,t)=>{!function(e){let{framebuffer:t=null,buffer:n=Qs,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vi(e),is(e,{framebuffer:t},(()=>{switch(n){case Qs:switch(i.constructor){case Int32Array:e.clearBufferiv(n,r,i);break;case Uint32Array:e.clearBufferuiv(n,r,i);break;case Float32Array:default:e.clearBufferfv(n,r,i)}break;case 6145:e.clearBufferfv(6145,0,[i]);break;case 6146:e.clearBufferiv(6146,0,[i]);break;case 34041:const[t,s]=i;e.clearBufferfi(34041,0,t,s);break;default:vs(!1,Ys)}}))}(this.gl,{drawBuffer:t,value:e})})),this.gl.bindFramebuffer(36160,s||null),this}readPixels(){return hi.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return hi.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return hi.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return hi.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return hi.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return hi.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:t=[],x:n=0,y:r=0,width:i,height:s}=e;const o=vi(this.gl),a=o.bindFramebuffer(36008,this.handle);return 0===n&&0===r&&void 0===i&&void 0===s?o.invalidateFramebuffer(36008,t):o.invalidateFramebuffer(36008,t,n,r,i,s),o.bindFramebuffer(36008,a),this}getAttachmentParameter(e,t,n){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=ys(this.gl,r)),r}getAttachmentParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const r={};for(const i of n){r[t?ys(this.gl,i):i]=this.getAttachmentParameter(e,i,t)}return r}getParameters(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=Object.keys(this.attachments),n={};for(const r of t){const t=Number(r);n[e?ys(this.gl,t):t]=this.getAttachmentParameters(t,e)}return n}show(){return"undefined"!==typeof window&&window.open(ro(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e>hi.level||"undefined"===typeof window)return this;t=t||"Framebuffer ".concat(this.id);const n=ro(this,{targetMaxHeight:100});return hi.image({logLevel:e,message:t,image:n},t)(),this}bind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,n,r,i){let s=null;return e&&(s=s||{},s[36064]=new Js(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:i,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(s[36064])),t&&n?(s=s||{},s[33306]=new Ks(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(s[33306])):t?(s=s||{},s[36096]=new Ks(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:i}),this.ownResources.push(s[36096])):n&&vs(!1),s}_unattach(e){const t=this.attachments[e];t&&(t instanceof Ks?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:t=36064,renderbuffer:n}=e;const{gl:r}=this;r.framebufferRenderbuffer(36160,t,36161,n.handle),this.attachments[t]=n}_attachTexture(e){let{attachment:t=36064,texture:n,layer:r,level:i}=e;const{gl:s}=this;switch(s.bindTexture(n.target,n.handle),n.target){case 35866:case 32879:vi(s).framebufferTextureLayer(36160,t,n.target,i,r);break;case 34067:const e=function(e){return e<34069?e+34069:e}(r);s.framebufferTexture2D(36160,t,e,n.handle,i);break;case 3553:s.framebufferTexture2D(36160,t,3553,n.handle,i);break;default:vs(!1,"Illegal texture type")}s.bindTexture(n.target,null),this.attachments[t]=n}_setReadBuffer(e){const t=gi(n=this.gl)?n:null;var n;t?t.readBuffer(e):vs(36064===e||1029===e,Ro),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,n=vi(t);if(n)n.drawBuffers(e);else{const n=t.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(e):vs(1===e.length&&(36064===e[0]||1029===e[0]),Ro)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(e){e.luma=e.luma||{},e.luma.caps=e.luma.caps||{};for(const t in To)void 0===e.luma.caps[t]&&(e.luma.caps[t]=Io(e,t));return e.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}Oo.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const Lo={5126:Ko.bind(null,"uniform1fv",Uo,1,Qo),35664:Ko.bind(null,"uniform2fv",Uo,2,Qo),35665:Ko.bind(null,"uniform3fv",Uo,3,Qo),35666:Ko.bind(null,"uniform4fv",Uo,4,Qo),5124:Ko.bind(null,"uniform1iv",Go,1,Qo),35667:Ko.bind(null,"uniform2iv",Go,2,Qo),35668:Ko.bind(null,"uniform3iv",Go,3,Qo),35669:Ko.bind(null,"uniform4iv",Go,4,Qo),35670:Ko.bind(null,"uniform1iv",Go,1,Qo),35671:Ko.bind(null,"uniform2iv",Go,2,Qo),35672:Ko.bind(null,"uniform3iv",Go,3,Qo),35673:Ko.bind(null,"uniform4iv",Go,4,Qo),35674:Ko.bind(null,"uniformMatrix2fv",Uo,4,Yo),35675:Ko.bind(null,"uniformMatrix3fv",Uo,9,Yo),35676:Ko.bind(null,"uniformMatrix4fv",Uo,16,Yo),35678:Xo,35680:Xo,5125:Ko.bind(null,"uniform1uiv",zo,1,Qo),36294:Ko.bind(null,"uniform2uiv",zo,2,Qo),36295:Ko.bind(null,"uniform3uiv",zo,3,Qo),36296:Ko.bind(null,"uniform4uiv",zo,4,Qo),35685:Ko.bind(null,"uniformMatrix2x3fv",Uo,6,Yo),35686:Ko.bind(null,"uniformMatrix2x4fv",Uo,8,Yo),35687:Ko.bind(null,"uniformMatrix3x2fv",Uo,6,Yo),35688:Ko.bind(null,"uniformMatrix3x4fv",Uo,12,Yo),35689:Ko.bind(null,"uniformMatrix4x2fv",Uo,8,Yo),35690:Ko.bind(null,"uniformMatrix4x3fv",Uo,12,Yo),35678:Xo,35680:Xo,35679:Xo,35682:Xo,36289:Xo,36292:Xo,36293:Xo,36298:Xo,36299:Xo,36300:Xo,36303:Xo,36306:Xo,36307:Xo,36308:Xo,36311:Xo},Fo={},ko={},Do={},No=[0];function jo(e,t,n,r){1===t&&"boolean"===typeof e&&(e=e?1:0),Number.isFinite(e)&&(No[0]=e,e=No);const i=e.length;if(i%t&&hi.warn("Uniform size should be multiples of ".concat(t),e)(),e instanceof n)return e;let s=r[i];s||(s=new n(i),r[i]=s);for(let o=0;o<i;o++)s[o]=e[o];return s}function Uo(e,t){return jo(e,t,Float32Array,Fo)}function Go(e,t){return jo(e,t,Int32Array,ko)}function zo(e,t){return jo(e,t,Uint32Array,Do)}function Vo(e,t,n){const r=Lo[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,e,t)}function Ho(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=e.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(e));return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function Jo(e){return Array.isArray(e)||ArrayBuffer.isView(e)?function(e){if(0===e.length)return!1;const t=Math.min(e.length,16);for(let n=0;n<t;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e):!!isFinite(e)||(!0===e||!1===e||(e instanceof Vs||(e instanceof Ks||e instanceof Oo&&Boolean(e.texture))))}function Wo(e,t,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(e[t]){const r=e[t];for(let e=0,t=n.length;e<t;++e)r[e]=n[e]}else e[t]=n.slice();else e[t]=n}function Xo(){let e=null;return(t,n,r)=>{const i=e!==r;return i&&(t.uniform1i(n,r),e=r),i}}function Ko(e,t,n,r){let i=null,s=null;return(o,a,l)=>{const c=t(l,n),u=c.length;let h=!1;if(null===i)i=new Float32Array(u),s=u,h=!0;else{vs(s===u,"Uniform length cannot change.");for(let e=0;e<u;++e)if(c[e]!==i[e]){h=!0;break}}return h&&(r(o,e,a,c),i.set(c)),h}}function Qo(e,t,n,r){e[t](n,r)}function Yo(e,t,n,r){e[t](n,!1,r)}function Zo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=e.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:t}function qo(e,t,n,r){const i=e.split(/\r?\n/),s={},o={},a=r||Zo(t)||"(unnamed)",l="".concat(function(e){switch(e){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)," shader ").concat(a);for(let u=0;u<i.length;u++){const t=i[u];if(t.length<=1)continue;const n=t.split(":"),r=n[0],a=parseInt(n[2],10);if(isNaN(a))throw new Error("GLSL compilation error in ".concat(l,": ").concat(e));"WARNING"!==r?s[a]=t:o[a]=t}const c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const r=e.split(/\r?\n/),i=String(r.length+t-1).length;return r.map(((e,r)=>{const s=String(r+t),o=s.length;return ea(s,i-o)+n+e}))}(t);return{shaderName:l,errors:$o(s,c),warnings:$o(o,c)}}function $o(e,t){let n="";for(let r=0;r<t.length;r++){const i=t[r];if((e[r+3]||e[r+2]||e[r+1])&&(n+="".concat(i,"\n"),e[r+1])){const t=e[r+1],i=t.split(":",3),s=i[0],o=parseInt(i[1],10)||0,a=t.substring(i.join(":").length+1).trim();n+=ea("^^^ ".concat(s,": ").concat(a,"\n\n"),o)}}return n}function ea(e,t){let n="";for(let r=0;r<t;++r)n+=" ";return"".concat(n).concat(e)}class ta extends xs{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return vs(!1),"unknown"}}constructor(e,t){mi(e),vs("string"===typeof t.source,"Shader: GLSL source code must be a JavaScript string");super(e,{id:Zo(t.source,null)||t.id||_s("unnamed ".concat(ta.getTypeName(t.shaderType)))}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize(e){let{source:t}=e;const n=Zo(t,null);n&&(this.id=_s(n)),this._compile(t)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(ta.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Zo(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;e.startsWith("#version ")||(e="#version 100\n".concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle);if(!this.getParameter(35713)){const e=this.gl.getShaderInfoLog(this.handle),{shaderName:t,errors:n,warnings:r}=qo(e,this.source,this.shaderType,this.id);throw hi.error("GLSL compilation errors in ".concat(t,"\n").concat(n))(),hi.warn("GLSL compilation warnings in ".concat(t,"\n").concat(r))(),new Error("GLSL compilation errors in ".concat(t))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class na extends ta{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,t){"string"===typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class ra extends ta{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,t){"string"===typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const ia=5126,sa=35664,oa=35665,aa=35666,la=5124,ca=35667,ua=35668,ha=35669,da=5125,fa=36294,pa=36295,ga=36296,ma=35670,va=35671,ba=35672,ya=35673,Aa=35674,_a=35675,wa=35676,Ca=35685,Ea=35686,Ba=35687,xa=35688,Sa=35689,Ta=35690,Ma={[ia]:[ia,1,"float"],[sa]:[ia,2,"vec2"],[oa]:[ia,3,"vec3"],[aa]:[ia,4,"vec4"],[la]:[la,1,"int"],[ca]:[la,2,"ivec2"],[ua]:[la,3,"ivec3"],[ha]:[la,4,"ivec4"],[da]:[da,1,"uint"],[fa]:[da,2,"uvec2"],[pa]:[da,3,"uvec3"],[ga]:[da,4,"uvec4"],[ma]:[ia,1,"bool"],[va]:[ia,2,"bvec2"],[ba]:[ia,3,"bvec3"],[ya]:[ia,4,"bvec4"],[Aa]:[ia,8,"mat2"],[Ca]:[ia,8,"mat2x3"],[Ea]:[ia,8,"mat2x4"],[_a]:[ia,12,"mat3"],[Ba]:[ia,12,"mat3x2"],[xa]:[ia,12,"mat3x4"],[wa]:[ia,16,"mat4"],[Sa]:[ia,16,"mat4x2"],[Ta]:[ia,16,"mat4x3"]};function Pa(e){switch(e){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return vs(!1),0}}function Ia(e){const t=Ma[e];if(!t)return null;const[n,r]=t;return{type:n,components:r}}function Ra(e,t){switch(e){case 5120:case 5121:case 5122:case 5123:e=ia}for(const n in Ma){const[r,i,s]=Ma[n];if(r===e&&i===t)return{glType:n,name:s}}return null}class Oa{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,n=t.getProgramParameter(e.handle,35721);for(let r=0;r<n;r++){const{name:n,type:i,size:s}=t.getActiveAttrib(e.handle,r),o=t.getAttribLocation(e.handle,n);o>=0&&this._addAttribute(o,n,i,s)}this.attributeInfos.sort(((e,t)=>e.location-t.location))}_readVaryingsFromProgram(e){const{gl:t}=e;if(!gi(t))return;const n=t.getProgramParameter(e.handle,35971);for(let r=0;r<n;r++){const{name:n,type:i,size:s}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,n,i,s)}this.varyingInfos.sort(((e,t)=>e.location-t.location))}_addAttribute(e,t,n,r){const{type:i,components:s}=Ia(n),o={type:i,size:r*s};this._inferProperties(e,t,o);const a={location:e,name:t,accessor:new Os(o)};this.attributeInfos.push(a),this.attributeInfosByLocation[e]=a,this.attributeInfosByName[a.name]=a}_inferProperties(e,t,n){/instance/i.test(t)&&(n.divisor=1)}_addVarying(e,t,n,r){const{type:i,components:s}=Ia(n),o={location:e,name:t,accessor:new Os({type:i,size:r*s})};this.varyingInfos.push(o),this.varyingInfosByName[o.name]=o}}const La=35981,Fa=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class ka extends xs{get[Symbol.toStringTag](){return"Program"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.stubRemovedMethods("Program","v6.0",Fa),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:t,vs:n,fs:r,varyings:i,bufferMode:s=La}=e;return this.hash=t||"",this.vs="string"===typeof n?new na(this.gl,{id:"".concat(e.id,"-vs"),source:n}):n,this.fs="string"===typeof r?new ra(this.gl,{id:"".concat(e.id,"-fs"),source:r}):r,vs(this.vs instanceof na),vs(this.fs instanceof ra),this.uniforms={},this._textureUniforms={},i&&i.length>0&&(vi(this.gl),this.varyings=i,this.gl2.transformFeedbackVaryings(this.handle,i,s)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Oa(this),this.setProps(e)}delete(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:t,drawMode:n=4,vertexCount:r,offset:i=0,start:s,end:o,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:u=c>0,vertexArray:h=null,transformFeedback:d,framebuffer:f,parameters:p={},uniforms:g,samplers:m}=e;if((g||m)&&(hi.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(g||{})),hi.priority>=t){const e=f?f.id:"default",i="mode=".concat(ys(this.gl,n)," verts=").concat(r," ")+"instances=".concat(c," indexType=").concat(ys(this.gl,l)," ")+"isInstanced=".concat(u," isIndexed=").concat(a," ")+"Framebuffer=".concat(e);hi.log(t,i)()}return vs(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===r||u&&0===c)&&(h.bindForDraw(r,c,(()=>{if(void 0!==f&&(p=Object.assign({},p,{framebuffer:f})),d){const e=Pa(n);d.begin(e)}this._bindTextures(),is(this.gl,p,(()=>{a&&u?this.gl2.drawElementsInstanced(n,r,l,i,c):a&&gi(this.gl)&&!isNaN(s)&&!isNaN(o)?this.gl2.drawRangeElements(n,s,o,r,l,i):a?this.gl.drawElements(n,r,l,i):u?this.gl2.drawArraysInstanced(n,i,r,c):this.gl.drawArrays(n,i,r)})),d&&d.end()})),!0)}setUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};hi.priority>=2&&function(e,t,n){for(const r in e){const i=e[r];if((!n||Boolean(n[r]))&&!Jo(i))throw t=t?"".concat(t," "):"",console.error("".concat(t," Bad uniform ").concat(r),i),new Error("".concat(t," Bad uniform ").concat(r))}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const n=e[t],r=this._uniformSetters[t];if(r){let e=n,i=!1;if(e instanceof Oo&&(e=e.texture),e instanceof Vs)if(i=this.uniforms[t]!==n,i){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const n=e,{textureIndex:i}=r;n.bind(i),e=i,this._textureUniforms[t]=n}else e=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(e)||i)&&Wo(this.uniforms,t,n)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const n=this._textureUniforms[t];n.update(),e=e&&n.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const t=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(t)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),n={};for(const r of t){switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new na({handle:r});break;case 35632:n.fs=new ra({handle:r})}}return n}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const e=this._getName();this.id=_s(e)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),hi.time(4,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),hi.timeEnd(4,"linkProgram for ".concat(this._getName()))(),e.debug||hi.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));e.validateProgram(this.handle);if(!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const n=this.gl.getActiveUniform(this.handle,t),{name:r}=Ho(n.name);let i=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=Vo(e,i,n),n.size>1)for(let t=0;t<n.size;t++)i=e.getUniformLocation(this.handle,"".concat(r,"[").concat(t,"]")),this._uniformSetters["".concat(r,"[").concat(t,"]")]=Vo(e,i,n)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class Da{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Da(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find((t=>t.name===e.name))||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"===typeof e?e:e.name;this._defaultModules=this._defaultModules.filter((e=>e.name!==t)),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:t="",fs:n="",defines:r={},inject:i={},varyings:s=[],bufferMode:o=35981,transpileToGLSL100:a=!1}=e,l=this._getModuleList(e.modules),c=this._getHash(t),u=this._getHash(n),h=l.map((e=>this._getHash(e.name))).sort(),d=s.map((e=>this._getHash(e))),f=Object.keys(r).sort(),p=Object.keys(i).sort(),g=[],m=[];for(const b of f)g.push(this._getHash(b)),g.push(this._getHash(r[b]));for(const b of p)m.push(this._getHash(b)),m.push(this._getHash(i[b]));const v="".concat(c,"/").concat(u,"D").concat(g.join("/"),"M").concat(h.join("/"),"I").concat(m.join("/"),"V").concat(d.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(a?"T":"");if(!this._programCache[v]){const e=function(e,t){const{vs:n,fs:r}=t,i=Rr(t.modules||[]);return{gl:e,vs:ci(e,Object.assign({},t,{source:n,type:Br,modules:i})),fs:ci(e,Object.assign({},t,{source:r,type:xr,modules:i})),getUniforms:ui(i)}}(this.gl,{vs:t,fs:n,modules:l,inject:i,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:a});this._programCache[v]=new ka(this.gl,{hash:v,vs:e.vs,fs:e.fs,varyings:s,bufferMode:o}),this._getUniforms[v]=e.getUniforms||(e=>{}),this._useCounts[v]=0}return this._useCounts[v]++,this._programCache[v]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Array(this._defaultModules.length+e.length),n={};let r=0;for(let i=0,s=this._defaultModules.length;i<s;++i){const e=this._defaultModules[i],s=e.name;t[r++]=e,n[s]=!0}for(let i=0,s=e.length;i<s;++i){const s=e[i],o=s.name;n[o]||(t[r++]=s,n[o]=!0)}return t.length=r,t}}const Na={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},ja="#define SMOOTH_EDGE_RADIUS 0.5",Ua={name:"geometry",vs:"\n".concat(ja,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(ja,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},Ga=Object.keys(mr).map((e=>"const int COORDINATE_SYSTEM_".concat(e," = ").concat(mr[e],";"))).join(""),za=Object.keys(vr).map((e=>"const int PROJECTION_MODE_".concat(e," = ").concat(vr[e],";"))).join(""),Va=Object.keys(br).map((e=>"const int UNIT_".concat(e.toUpperCase()," = ").concat(br[e],";"))).join(""),Ha="".concat(Ga,"\n").concat(za,"\n").concat(Va,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n");function Ja(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return!1}function Wa(e){let t,n={};return r=>{for(const i in r)if(!Ja(r[i],n[i])){t=e(r),n=r;break}return t}}const Xa=[0,0,0,0],Ka=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Qa=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ya=[0,0,0],Za=[0,0,0],qa=Wa((function(e){let{viewport:t,devicePixelRatio:n,coordinateSystem:r,coordinateOrigin:i}=e;const{projectionCenter:s,viewProjectionMatrix:o,originCommon:a,cameraPosCommon:l,shaderCoordinateOrigin:c,geospatialOrigin:u}=function(e,t,n){const{viewMatrixUncentered:r,projectionMatrix:i}=e;let{viewMatrix:s,viewProjectionMatrix:o}=e,a=Xa,l=Xa,c=e.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:d}=$a(e,t,n);d&&(l=e.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=Rn([],l,o),s=r||s,o=An([],i,s),o=An([],o,Ka));return{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(t,r,i),h=t.getDistanceScales(),d=[t.width*n,t.height*n],f=Rn([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,p={project_uCoordinateSystem:r,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:c,project_uCommonOrigin:a.slice(0,3),project_uCenter:s,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:d,project_uDevicePixelRatio:n,project_uFocalDistance:f,project_uCommonUnitsPerMeter:h.unitsPerMeter,project_uCommonUnitsPerWorldUnit:h.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Ya,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:o,project_uModelMatrix:Qa,project_uCameraPosition:l};if(u){const e=t.getDistanceScales(u);switch(r){case mr.METER_OFFSETS:p.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,p.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case mr.LNGLAT:case mr.LNGLAT_OFFSETS:t._pseudoMeters||(p.project_uCommonUnitsPerMeter=e.unitsPerMeter),p.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,p.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case mr.CARTESIAN:p.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],p.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return p}));function $a(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Za;n.length<3&&(n=[n[0],n[1],0]);let r,i=n,s=!0;switch(r=t===mr.LNGLAT_OFFSETS||t===mr.METER_OFFSETS?n:e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case vr.WEB_MERCATOR:t!==mr.LNGLAT&&t!==mr.CARTESIAN||(r=[0,0,0],s=!1);break;case vr.WEB_MERCATOR_AUTO_OFFSET:t===mr.LNGLAT?i=r:t===mr.CARTESIAN&&(i=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],r=e.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case vr.IDENTITY:i=e.position.map(Math.fround),i[2]=i[2]||0;break;case vr.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}const el={};const tl={name:"project",dependencies:[Na,Ua],vs:Ha,getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:el;return"viewport"in e?function(e){let{viewport:t,devicePixelRatio:n=1,modelMatrix:r=null,coordinateSystem:i=mr.DEFAULT,coordinateOrigin:s=Za,autoWrapLongitude:o=!1}=e;i===mr.DEFAULT&&(i=t.isGeospatial?mr.LNGLAT:mr.CARTESIAN);const a=qa({viewport:t,devicePixelRatio:n,coordinateSystem:i,coordinateOrigin:s});return a.project_uWrapLongitude=o,a.project_uModelMatrix=r||Qa,a}(e):{}}},nl=[tl],rl=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function il(e){const t=Da.getDefaultProgramManager(e);for(const n of nl)t.addDefaultModule(n);for(const n of rl)t.addShaderHook(n);return t}class sl{constructor(e){let{deck:t,stats:n,viewport:r,timeline:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};g(this,"layers",void 0),g(this,"context",void 0),g(this,"resourceManager",void 0),g(this,"_lastRenderedLayers",[]),g(this,"_needsRedraw",!1),g(this,"_needsUpdate",!1),g(this,"_nextLayers",null),g(this,"_debug",!1),g(this,"activateViewport",(e=>{te("layerManager.activateViewport",this,e),e&&(this.context.viewport=e)})),this.layers=[],this.resourceManager=new Ft({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:t,programManager:e&&il(e),stats:n||new ae({id:"deck.gl"}),viewport:r||new Er({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:i||new b,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers(){let{layerIds:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?this.layers.filter((t=>e.find((e=>0===t.id.indexOf(e))))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){te("layerManager.setLayers",this,t,e),this._lastRenderedLayers=e;const n=ne(e,Boolean);for(const r of n)r.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,t,n){n.raiseError(t,"".concat(e," of ").concat(n))}_updateLayers(e,t){const n={};for(const s of e)n[s.id]?q.warn("Multiple old layers with same id ".concat(s.id))():n[s.id]=s;const r=[];this._updateSublayersRecursively(t,n,r),this._finalizeOldLayers(n);let i=!1;for(const s of r)if(s.hasUniformTransition()){i="Uniform transition in ".concat(s);break}this._needsUpdate=i,this.layers=r}_updateSublayersRecursively(e,t,n){for(const i of e){i.context=this.context;const e=t[i.id];null===e&&q.warn("Multiple new layers with same id ".concat(i.id))(),t[i.id]=null;let s=null;try{this._debug&&e!==i&&i.validateProps(),e?(this._transferLayerState(e,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),s=i.isComposite?i.getSubLayers():null}catch(r){this._handleError("matching",r,i)}s&&this._updateSublayersRecursively(s,t,n)}}_finalizeOldLayers(e){for(const t in e){const n=e[t];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=_}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=A,t!==e&&(e.lifecycle=w)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=C;try{e._finalize(),e.lifecycle=E}catch(t){this._handleError("finalization",t,e)}}}function ol(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!ol(e[r],t[r],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const s of r){if(!t.hasOwnProperty(s))return!1;if(!ol(e[s],t[s],n-1))return!1}return!0}return!1}class al{constructor(e){g(this,"width",void 0),g(this,"height",void 0),g(this,"views",void 0),g(this,"viewState",void 0),g(this,"controllers",void 0),g(this,"timeline",void 0),g(this,"_viewports",void 0),g(this,"_viewportMap",void 0),g(this,"_isUpdating",void 0),g(this,"_needsRedraw",void 0),g(this,"_needsUpdate",void 0),g(this,"_eventManager",void 0),g(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter((t=>t.containsPixel(e))):this._viewports}getViews(){const e={};return this.views.forEach((t=>{e[t.id]=t})),e}getView(e){return this.views.find((t=>t.id===e))}getViewState(e){const t="string"===typeof e?this.getView(e):e,n=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,t){const n=this.getViewports(),r={x:e[0],y:e[1]};for(let i=n.length-1;i>=0;--i){const s=n[i];if(s.containsPixel(r)){const n=e.slice();return n[0]-=s.x,n[1]-=s.y,s.unproject(n,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=ne(e,Boolean);this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){if(e){!ol(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e}else q.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...t,viewId:e})}_createController(e,t){return new(0,t.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:t=>{var n;return null===(n=this.getView(e.id))||void 0===n?void 0:n.makeViewport({viewState:t,width:this.width,height:this.height})}})}_updateController(e,t,n,r){const i=e.controller;if(i&&n){const s={...t,...i,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height};return r&&r.constructor===i.type||(r=this._createController(e,s)),r&&r.setProps(s),r}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let r=e.length;r--;){const i=e[r],s=this.getViewState(i),o=i.makeViewport({viewState:s,width:this.width,height:this.height});let a=t[i.id];const l=Boolean(i.controller);l&&!a&&(n=!0),!n&&l||!a||(a.finalize(),a=null),this.controllers[i.id]=this._updateController(i,s,o,a),o&&this._viewports.unshift(o)}for(const r in t){const e=t[r];e&&!this.controllers[r]&&e.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)}))}_diffViews(e,t){return e.length!==t.length||e.some(((n,r)=>!e[r].equals(t[r])))}}const ll=/([0-9]+\.?[0-9]*)(%|px)/;function cl(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":const t=ll.exec(e);if(t&&t.length>=3){const e="%"===t[2],n=parseFloat(t[1]);return{position:e?n/100:n,relative:e}}default:throw new Error("Could not parse position string ".concat(e))}}function ul(e,t){return e.relative?Math.round(e.position*t):e.position}function hl(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}class dl{constructor(e){g(this,"id",void 0),g(this,"viewportInstance",void 0),g(this,"_x",void 0),g(this,"_y",void 0),g(this,"_width",void 0),g(this,"_height",void 0),g(this,"_padding",void 0),g(this,"props",void 0);const{id:t,x:n=0,y:r=0,width:i="100%",height:s="100%",padding:o=null,viewportInstance:a}=e||{};hl(!a||a instanceof Er),this.viewportInstance=a,this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=cl(n),this._y=cl(r),this._width=cl(i),this._height=cl(s),this._padding=o&&{left:cl(o.left||0),right:cl(o.right||0),top:cl(o.top||0),bottom:cl(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?!!e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):this.ViewportType===e.ViewportType&&ol(this.props,e.props,2))}makeViewport(e){let{width:t,height:n,viewState:r}=e;if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:t,height:n});return i.height&&i.width?new this.ViewportType({...r,...this.props,...i}):null}getViewStateId(){const{viewState:e}=this.props;return"string"===typeof e?e:(null===e||void 0===e?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&"object"===typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const e in this.props.viewState)"id"!==e&&(t[e]=this.props.viewState[e]);return t}return e}getDimensions(e){let{width:t,height:n}=e;const r={x:ul(this._x,t),y:ul(this._y,n),width:ul(this._width,t),height:ul(this._height,n)};return this._padding&&(r.padding={left:ul(this._padding.left,t),top:ul(this._padding.top,n),right:ul(this._padding.right,t),bottom:ul(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?!0===e?{type:this.ControllerType}:"function"===typeof e?{type:e}:{type:this.ControllerType,...e}:null}}class fl extends Er{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{latitude:t=0,longitude:n=0,zoom:r=0,pitch:i=0,bearing:s=0,nearZMultiplier:o=.1,farZMultiplier:a=1.01,nearZ:l,farZ:c,orthographic:u=!1,projectionMatrix:h,repeat:d=!1,worldOffset:f=0,position:p,padding:m,legacyMeterSizes:v=!1}=e;let{width:b,height:y,altitude:A=1.5}=e;const _=Math.pow(2,r);let w;b=b||1,y=y||1;let C=null;if(h)A=h[5]/2,w=cr(A);else{let n;if(e.fovy?(w=e.fovy,A=ur(w)):w=cr(A),m){const{top:e=0,bottom:t=0}=m;n=[0,Ut((e+y-t)/2,0,y)-y/2]}C=lr({width:b,height:y,scale:_,center:p&&[0,0,p[2]*sr(t)],offset:n,pitch:i,fovy:w,nearZMultiplier:o,farZMultiplier:a}),Number.isFinite(l)&&(C.near=l),Number.isFinite(c)&&(C.far=c)}let E=function(e){const{height:t,pitch:n,bearing:r,altitude:i,scale:s,center:o}=e,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];_n(a,a,[0,0,-i]),Cn(a,a,-n*Yn),En(a,a,r*Yn);const l=s/t;return wn(a,a,[l,l,l]),o&&_n(a,a,function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}([],o)),a}({height:y,pitch:i,bearing:s,scale:_,altitude:A});if(f){E=(new jn).translate([512*f,0,0]).multiplyLeft(E)}super({...e,width:b,height:y,viewMatrix:E,longitude:n,latitude:t,zoom:r,...C,fovy:w,focalDistance:A}),g(this,"longitude",void 0),g(this,"latitude",void 0),g(this,"pitch",void 0),g(this,"bearing",void 0),g(this,"altitude",void 0),g(this,"fovy",void 0),g(this,"orthographic",void 0),g(this,"_subViewports",void 0),g(this,"_pseudoMeters",void 0),this.latitude=t,this.longitude=n,this.zoom=r,this.pitch=i,this.bearing=s,this.altitude=A,this.fovy=w,this.orthographic=u,this._subViewports=d?[]:null,this._pseudoMeters=v,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let r=t;r<=n;r++){const e=r?new fl({...this,worldOffset:r}):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*sr(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)/sr(n)]}addMetersToLngLat(e,t){return ar(e,t)}panByPosition(e,t){const n=dr(t,this.pixelUnprojectionMatrix),r=Sn([],this.projectFlat(e),function(e,t){return e[0]=-t[0],e[1]=-t[1],e}([],n)),i=Sn([],this.center,r),[s,o]=this.unprojectFlat(i);return{longitude:s,latitude:o}}getBounds(){const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:n,height:r,unproject:i}=e,s={targetZ:t},o=i([0,r],s),a=i([n,r],s);let l,c;return(e.fovy?.5*e.fovy*pr:Math.atan(.5/e.altitude))>(90-e.pitch)*pr-.01?(l=gr(e,0,t),c=gr(e,n,t)):(l=i([0,0],s),c=i([n,0],s)),[o,a,c,l]}(this,(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{width:n,height:r}=this,{longitude:i,latitude:s,zoom:o}=fr({width:n,height:r,bounds:e,...t});return new fl({width:n,height:r,longitude:i,latitude:s,zoom:o})}}g(fl,"displayName","WebMercatorViewport");class pl{constructor(e){g(this,"_inProgress",void 0),g(this,"_handle",void 0),g(this,"_timeline",void 0),g(this,"time",void 0),g(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var t,n;this.cancel(),this.settings=e,this._inProgress=!0,null===(t=(n=this.settings).onStart)||void 0===t||t.call(n,this)}end(){var e,t;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(e=(t=this.settings).onEnd)||void 0===e||e.call(t,this))}cancel(){var e,t;this._inProgress&&(null===(e=(t=this.settings).onInterrupt)||void 0===e||e.call(t,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,t;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(e=(t=this.settings).onUpdate)||void 0===e||e.call(t,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const gl=()=>{},ml=2,vl=3,bl=e=>e,yl=1;class Al{constructor(e){g(this,"getControllerState",void 0),g(this,"props",void 0),g(this,"propsInTransition",void 0),g(this,"transition",void 0),g(this,"onViewStateChange",void 0),g(this,"onStateChange",void 0),g(this,"_onTransitionUpdate",(e=>{const{time:t,settings:{interpolator:n,startProps:r,endProps:i,duration:s,easing:o}}=e,a=o(t/s),l=n.interpolateProps(r,i,a);this.propsInTransition=this.getControllerState({...this.props,...l}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})})),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new pl(e.timeline),this.onViewStateChange=e.onViewStateChange||gl,this.onStateChange=e.onStateChange||gl}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let r=n;if(this.transition.inProgress){const{interruption:e,endProps:t}=this.transition.settings;r={...n,...e===ml?t:this.propsInTransition||n}}this._triggerTransition(r,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:n}=e;return(t>0||"auto"===t)&&Boolean(n)}_isUpdateDueToCurrentTransition(e){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?this.transition.settings.interruption===vl||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const n=this.getControllerState(e),r=this.getControllerState(t).shortestPathFrom(n),i=t.transitionInterpolator,s=i.getDuration?i.getDuration(e,t):t.transitionDuration;if(0===s)return;const o=i.initializeProps(e,r);this.propsInTransition={};const a={duration:s,easing:t.transitionEasing||bl,interpolator:i,interruption:t.transitionInterruption||yl,startProps:o.start,endProps:o.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(a),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null===e||void 0===e||e(t)}}}class _l{constructor(e){g(this,"_propsToCompare",void 0),g(this,"_propsToExtract",void 0),g(this,"_requiredProps",void 0);const{compare:t,extract:n,required:r}=e;this._propsToCompare=t,this._propsToExtract=n||t,this._requiredProps=r}arePropsEqual(e,t){for(const n of this._propsToCompare)if(!(n in e)||!(n in t)||!zt(e[n],t[n]))return!1;return!0}initializeProps(e,t){const n={},r={};for(const i of this._propsToExtract)(i in e||i in t)&&(n[i]=e[i],r[i]=t[i]);return this._checkRequiredProps(n),this._checkRequiredProps(r),{start:n,end:r}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach((t=>{const n=e[t];hl(Number.isFinite(n)||Array.isArray(n),"".concat(t," is required for transition"))}))}}const wl=["longitude","latitude","zoom","bearing","pitch"],Cl=["longitude","latitude","zoom"];class El extends _l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:wl,required:Cl},super(n.transitionProps),g(this,"opts",void 0),this.opts=n}initializeProps(e,t){const n=super.initializeProps(e,t),{makeViewport:r,around:i}=this.opts;if(r&&i){const s=r(e),o=r(t),a=s.unproject(i);n.start.around=i,Object.assign(n.end,{around:o.project(a),aroundPosition:a,width:t.width,height:t.height})}return n}interpolateProps(e,t,n){const r={};for(const i of this._propsToExtract)r[i]=Gt(e[i]||0,t[i]||0,n);if(t.aroundPosition&&this.opts.makeViewport){const i=this.opts.makeViewport({...t,...r});Object.assign(r,i.panByPosition(t.aroundPosition,Gt(e.around,t.around,n)))}return r}}const Bl={transitionDuration:0},xl=e=>1-(1-e)*(1-e),Sl=["wheel"],Tl=["panstart","panmove","panend"],Ml=["pinchstart","pinchmove","pinchend"],Pl=["tripanstart","tripanmove","tripanend"],Il=["doubletap"],Rl=["keydown"],Ol={};class Ll{constructor(e){g(this,"props",void 0),g(this,"state",{}),g(this,"transitionManager",void 0),g(this,"eventManager",void 0),g(this,"onViewStateChange",void 0),g(this,"onStateChange",void 0),g(this,"makeViewport",void 0),g(this,"_controllerState",void 0),g(this,"_events",{}),g(this,"_interactionState",{isDragging:!1}),g(this,"_customEvents",[]),g(this,"_eventStartBlocked",null),g(this,"_panMove",!1),g(this,"invertPan",!1),g(this,"dragMode","rotate"),g(this,"inertia",0),g(this,"scrollZoom",!0),g(this,"dragPan",!0),g(this,"dragRotate",!0),g(this,"doubleClickZoom",!0),g(this,"touchZoom",!0),g(this,"touchRotate",!1),g(this,"keyboard",!0),this.transitionManager=new Al({...e,getControllerState:e=>new this.ControllerState(e),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const t in this._events){var e;if(this._events[t])null===(e=this.eventManager)||void 0===e||e.off(t,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!t&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:n}=this.props,{offsetCenter:r}=e;return[r.x-t,r.y-n]}isPointInBounds(e,t){const{width:n,height:r}=this.props;if(t&&t.handled)return!1;const i=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=r;return i&&t&&t.stopPropagation(),i}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout((()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)}),e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:!0===t?300:0;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:i=!0,doubleClickZoom:s=!0,touchZoom:o=!0,touchRotate:a=!1,keyboard:l=!0}=e,c=Boolean(this.onViewStateChange);this.toggleEvents(Sl,c&&n),this.toggleEvents(Tl,c),this.toggleEvents(Ml,c&&(o||a)),this.toggleEvents(Pl,c&&a),this.toggleEvents(Il,c&&s),this.toggleEvents(Rl,c&&l),this.scrollZoom=n,this.dragPan=r,this.dragRotate=i,this.doubleClickZoom=s,this.touchZoom=o,this.touchRotate=a,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach((e=>{this._events[e]!==t&&(this._events[e]=t,t?this.eventManager.on(e,this.handleEvent):this.eventManager.off(e,this.handleEvent))}))}updateViewport(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={...e.getViewportProps(),...t},i=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),i){const e=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:e})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:t});return this._panMove=n,this.updateViewport(r,Bl,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),n=this.controllerState.pan({pos:t});return this.updateViewport(n,Bl,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],i=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:xl},{isDragging:!1,isPanning:!0})}else{const e=this.controllerState.panEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),n=this.controllerState.rotate({pos:t});return this.updateViewport(n,Bl,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],i=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:xl},{isDragging:!1,isRotating:!0})}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:r=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:i}=e;let s=2/(1+Math.exp(-Math.abs(i*n)));i<0&&0!==s&&(s=1/s);const o=this.controllerState.zoom({pos:t,scale:s});return this.updateViewport(o,{...this._getTransitionProps({around:t}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.rotateStart({pos:t});return this.updateViewport(n,Bl,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const n=this.controllerState.rotate({pos:t});return this.updateViewport(n,Bl,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const n=this.getCenter(e),r=[n[0],n[1]+=e.velocityY*t/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:xl},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return Ol._startPinchRotation=e.rotation,Ol._lastPinchEvent=e,this.updateViewport(n,Bl,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:n}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=e;t=t.rotate({deltaAngleX:Ol._startPinchRotation-n})}return this.updateViewport(t,Bl,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Ol._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:n}=Ol;if(this.touchZoom&&t&&n&&e.scale!==n.scale){const r=this.getCenter(e);let i=this.controllerState.rotateEnd();const s=Math.log2(e.scale),o=(s-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),a=Math.pow(2,s+o*t/2);i=i.zoom({pos:r,scale:a}).zoomEnd(),this.updateViewport(i,{...this._getTransitionProps({around:r}),transitionDuration:t,transitionEasing:xl},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const e=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Ol._startPinchRotation=null,Ol._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:i,rotateSpeedY:s}=!0===this.keyboard?{}:this.keyboard,{controllerState:o}=this;let a;const l={};switch(e.srcEvent.code){case"Minus":a=t?o.zoomOut(n).zoomOut(n):o.zoomOut(n),l.isZooming=!0;break;case"Equal":a=t?o.zoomIn(n).zoomIn(n):o.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":t?(a=o.rotateLeft(i),l.isRotating=!0):(a=o.moveLeft(r),l.isPanning=!0);break;case"ArrowRight":t?(a=o.rotateRight(i),l.isRotating=!0):(a=o.moveRight(r),l.isPanning=!0);break;case"ArrowUp":t?(a=o.rotateUp(s),l.isRotating=!0):(a=o.moveUp(r),l.isPanning=!0);break;case"ArrowDown":t?(a=o.rotateDown(s),l.isRotating=!0):(a=o.moveDown(r),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{transition:t}=this;return t&&t.transitionInterpolator?e?{...t,transitionInterpolator:new El({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t:Bl}}class Fl{constructor(e,t){g(this,"_viewportProps",void 0),g(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}class kl extends Fl{constructor(e){const{width:t,height:n,latitude:r,longitude:i,zoom:s,bearing:o=0,pitch:a=0,altitude:l=1.5,position:c=[0,0,0],maxZoom:u=20,minZoom:h=0,maxPitch:d=60,minPitch:f=0,startPanLngLat:p,startZoomLngLat:m,startRotatePos:v,startBearing:b,startPitch:y,startZoom:A,normalize:_=!0}=e;hl(Number.isFinite(i)),hl(Number.isFinite(r)),hl(Number.isFinite(s)),super({width:t,height:n,latitude:r,longitude:i,zoom:s,bearing:o,pitch:a,altitude:l,maxZoom:u,minZoom:h,maxPitch:d,minPitch:f,normalize:_,position:c},{startPanLngLat:p,startZoomLngLat:m,startRotatePos:v,startBearing:b,startPitch:y,startZoom:A}),g(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart(e){let{pos:t}=e;return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan(e){let{pos:t,startPos:n}=e;const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(r,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart(e){let{pos:t}=e;return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate(e){let{pos:t,deltaAngleX:n=0,deltaAngleY:r=0}=e;const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||void 0===s||void 0===o)return this;let a;return a=t?this._getNewRotation(t,i,o,s):{bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart(e){let{pos:t}=e;return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom(e){let{pos:t,startPos:n,scale:r}=e,{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(t)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=Ut(l,a,o);const c=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...c.panByPosition(s,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(e)}zoomOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(1/e)}moveLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([e,0])}moveRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([-e,0])}moveUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,e])}moveDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,-e])}rotateLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),n={...this.getViewportProps()},{bearing:r,longitude:i}=n;return Math.abs(r-t.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-t.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:r}=e;e.zoom=Ut(r,n,t);const{maxPitch:i,minPitch:s,pitch:o}=e;e.pitch=Ut(o,s,i);const{normalize:a=!0}=e;return a&&Object.assign(e,function(e){const{width:t,height:n,pitch:r=0}=e;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=e;(i<-180||i>180)&&(i=Hn(i+180,360)-180),(a<-180||a>180)&&(a=Hn(a+180,360)-180);const l=Wn(n/512);if(o<=l)o=l,s=0;else{const e=n/2/Math.pow(2,o),t=rr([0,e])[1];if(s<t)s=t;else{const t=rr([0,512-e])[1];s>t&&(s=t)}}return{width:t,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}(e)),e}_zoomFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.zoom({pos:[t/2,n/2],scale:e})}_panFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.pan({startPos:[t/2,n/2],pos:[t/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,n,r){const i=e[0]-t[0],s=e[1]-t[1],o=e[1],a=t[1],{width:l,height:c}=this.getViewportProps(),u=i/l;let h=0;s>0?Math.abs(c-a)>5&&(h=s/(a-c)*1.2):s<0&&a>5&&(h=1-o/a),h=Ut(h,-1,1);const{minPitch:d,maxPitch:f}=this.getViewportProps();let p=n;return h>0?p=n+h*(f-n):h<0&&(p=n-h*(d-n)),{pitch:p,bearing:r+180*u}}}class Dl extends Ll{constructor(){super(...arguments),g(this,"ControllerState",kl),g(this,"transition",{transitionDuration:300,transitionInterpolator:new El({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),g(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e);(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Nl extends dl{get ViewportType(){return fl}get ControllerType(){return Dl}}g(Nl,"displayName","MapView");const jl=[255,255,255],Ul=1;let Gl=0;class zl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g(this,"id",void 0),g(this,"color",void 0),g(this,"intensity",void 0),g(this,"type","ambient");const{color:t=jl}=e,{intensity:n=Ul}=e;this.id=e.id||"ambient-".concat(Gl++),this.color=t,this.intensity=n}}const Vl=[255,255,255],Hl=1,Jl=[0,0,-1];let Wl=0;class Xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g(this,"id",void 0),g(this,"color",void 0),g(this,"intensity",void 0),g(this,"type","directional"),g(this,"direction",void 0),g(this,"shadow",void 0);const{color:t=Vl}=e,{intensity:n=Hl}=e,{direction:r=Jl}=e,{_shadow:i=!1}=e;this.id=e.id||"directional-".concat(Wl++),this.color=t,this.intensity=n,this.type="directional",this.direction=new hn(r).normalize().toArray(),this.shadow=i}getProjectedLight(e){return this}}class Kl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:"pass"};g(this,"id",void 0),g(this,"gl",void 0),g(this,"props",void 0);const{id:n}=t;this.id=n,this.gl=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class Ql extends Kl{constructor(){super(...arguments),g(this,"_lastRenderIndex",-1)}render(e){return rs(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:t,moduleParameters:n,viewports:r,views:i,onViewportActive:s,clearStack:o=!0,clearCanvas:a=!0}=e;e.pass=e.pass||"unknown";const l=this.gl;a&&function(e,t){const n=t?t.width:e.drawingBufferWidth,r=t?t.height:e.drawingBufferHeight;rs(e,{viewport:[0,0,n,r]}),e.clear(16640)}(l,t),o&&(this._lastRenderIndex=-1);const c=[];for(const u of r){const r=i&&i[u.id];null===s||void 0===s||s(u);const o=this._getDrawLayerParams(u,e),a=u.subViewports||[u];for(const i of a){const s=this._drawLayersInViewport(l,{target:t,moduleParameters:n,viewport:i,view:r,pass:e.pass,layers:e.layers},o);c.push(s)}}return c}_getDrawLayerParams(e,t){let{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,moduleParameters:l}=t,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const u=[],h=Yl(this._lastRenderIndex+1),d={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},f={};for(let p=0;p<n.length;p++){const t=n[p],i=this._shouldDrawLayer(t,d,s,f),o={shouldDrawLayer:i};i&&!c&&(o.layerRenderIndex=h(t,i),o.moduleParameters=this._getModuleParameters(t,a,r,l),o.layerParameters=this.getLayerParameters(t,p,e)),u[p]=o}return u}_drawLayersInViewport(e,t,n){let{layers:r,moduleParameters:i,pass:s,target:o,viewport:a,view:l}=t;const c=function(e,t){let{moduleParameters:n,target:r,viewport:i}=t;const s=r&&"default-framebuffer"!==r.id,o=n&&n.devicePixelRatio||ss(e),a=s?r.height:e.drawingBufferHeight,l=i;return[l.x*o,a-(l.y+l.height)*o,l.width*o,l.height*o]}(e,{moduleParameters:i,target:o,viewport:a});if(l&&l.props.clear){const t=!0===l.props.clear?{color:!0,depth:!0}:l.props.clear;is(e,{scissorTest:!0,scissor:c},(()=>Zs(e,t)))}const u={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};rs(e,{viewport:c});for(let d=0;d<r.length;d++){const e=r[d],{shouldDrawLayer:t,layerRenderIndex:i,moduleParameters:o,layerParameters:l}=n[d];if(t&&e.props.pickable&&u.pickableCount++,e.isComposite)u.compositeCount++;else if(t){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,i),o.viewport=a;try{e._drawLayer({moduleParameters:o,uniforms:{layerIndex:i},parameters:l})}catch(h){e.raiseError(h,"drawing ".concat(e," to ").concat(s))}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t,n){return e.props.parameters}_shouldDrawLayer(e,t,n,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let i=e.parent;for(;i;){if(!i.props.visible||!i.filterSubLayer(t))return!1;t.layer=i,i=i.parent}if(n){const e=t.layer.id;if(e in r||(r[e]=n(t)),!r[e])return!1}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,n,r){var i;const s=Object.assign(Object.create((null===(i=e.internalState)||void 0===i?void 0:i.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:ss(this.gl)});if(t)for(const a of t){var o;Object.assign(s,null===(o=a.getModuleParameters)||void 0===o?void 0:o.call(a,e))}return Object.assign(s,this.getModuleParameters(e,t),r)}}function Yl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let c;if(l&&!(l in t)&&r(i.parent,!1),l in n){const e=n[l]=n[l]||Yl(t[l],t);c=e(i,s),n[a]=e}else Number.isFinite(o)?(c=o+(t[l]||0),n[a]=null):c=e;return s&&c>=e&&(e=c+1),t[a]=c,c};return r}class Zl extends Ql{constructor(e,t){super(e,t),g(this,"shadowMap",void 0),g(this,"depthBuffer",void 0),g(this,"fbo",void 0),this.shadowMap=new Js(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Ks(e,{format:33189,width:1,height:1}),this.fbo=new Oo(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;is(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const n=e.viewports[0],r=ss(this.gl),i=n.width*r,s=n.height*r;i===t.width&&s===t.height||t.resize({width:i,height:s}),super.render({...e,target:t,pass:"shadow"})}))}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const ql=Wa((function(e){let{viewport:t,center:n}=e;return new jn(t.viewProjectionMatrix).invert().transform(n)})),$l=Wa((function(e){let{viewport:t,shadowMatrices:n}=e;const r=[],i=t.pixelUnprojectionMatrix,s=t.isGeospatial?void 0:1,o=[[0,0,s],[t.width,0,s],[0,t.height,s],[t.width,t.height,s],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((e=>function(e,t){const[n,r,i]=e,s=dr([n,r,i],t);if(Number.isFinite(i))return s;return[s[0],s[1],0]}(e,i)));for(const a of n){const e=a.clone().translate(new hn(t.center).negate()),n=o.map((t=>e.transform(t))),i=(new jn).ortho({left:Math.min(...n.map((e=>e[0]))),right:Math.max(...n.map((e=>e[0]))),bottom:Math.min(...n.map((e=>e[1]))),top:Math.max(...n.map((e=>e[1]))),near:Math.min(...n.map((e=>-e[2]))),far:Math.max(...n.map((e=>-e[2])))});r.push(i.multiplyRight(a))}return r})),ec=[0,0,0,1],tc=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];const nc={name:"shadow",dependencies:[tl],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"viewport"in e&&(e.drawToShadowMap||e.shadowMaps&&e.shadowMaps.length>0)?function(e,t){const{shadowEnabled:n=!0}=e;if(!n||!e.shadowMatrices||!e.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:Boolean(e.drawToShadowMap),shadow_uUseShadowMap:!!e.shadowMaps&&e.shadowMaps.length>0,shadow_uColor:e.shadowColor||ec,shadow_uLightId:e.shadowLightId||0,shadow_uLightCount:e.shadowMatrices.length},i=ql({viewport:e.viewport,center:t.project_uCenter}),s=[],o=$l({shadowMatrices:e.shadowMatrices,viewport:e.viewport}).slice();for(let a=0;a<e.shadowMatrices.length;a++){const n=o[a],r=n.clone().translate(new hn(e.viewport.center).negate());t.project_uCoordinateSystem===mr.LNGLAT&&t.project_uProjectionMode===vr.WEB_MERCATOR?(o[a]=r,s[a]=i):(o[a]=n.clone().multiplyRight(tc),s[a]=r.transform(i))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a],e.shadowMaps&&e.shadowMaps.length>0?r["shadow_uShadowMap".concat(a)]=e.shadowMaps[a]:r["shadow_uShadowMap".concat(a)]=e.dummyShadowMap;return r}(e,t):{}}},rc={color:[255,255,255],intensity:1},ic=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],sc=[0,0,0,200/255];class oc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g(this,"id","lighting-effect"),g(this,"props",void 0),g(this,"shadowColor",sc),g(this,"shadow",void 0),g(this,"ambientLight",void 0),g(this,"directionalLights",void 0),g(this,"pointLights",void 0),g(this,"shadowPasses",[]),g(this,"shadowMaps",[]),g(this,"dummyShadowMap",null),g(this,"programManager",void 0),g(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const t in e){const n=e[t];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((e=>e.shadow)),this.props=e}preRender(e,t){let{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}=t;if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=Da.getDefaultProgramManager(e),nc&&this.programManager.addDefaultModule(nc)),this.dummyShadowMap||(this.dummyShadowMap=new Js(e,{width:1,height:1}));for(let e=0;e<this.shadowPasses.length;e++){this.shadowPasses[e].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o,moduleParameters:{shadowLightId:e,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((t=>t.getProjectedLight({layer:e}))),pointLights:this.pointLights.map((t=>t.getProjectedLight({layer:e})))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(nc),this.programManager=null)}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const n=(new jn).lookAt({eye:new hn(t.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const n=new Zl(e);this.shadowPasses[t]=n,this.shadowMaps[t]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:n}=this;e||0!==t.length||0!==n.length||(this.ambientLight=new zl(rc),this.directionalLights.push(new Xl(ic[0]),new Xl(ic[1])))}}const ac=new oc;class lc{constructor(){g(this,"effects",void 0),g(this,"_resolvedEffects",[]),g(this,"_defaultEffects",[]),g(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find((t=>t.id===e.id))){const n=t.findIndex((t=>function(e,t){var n,r;return(null!==(n=e.order)&&void 0!==n?n:1/0)-(null!==(r=t.order)&&void 0!==r?r:1/0)}(t,e)>0));n<0?t.push(e):t.splice(n,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(ol(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const r of this.effects)t[r.id]=r;const n=[];for(const r of e){const e=t[r.id];e&&e!==r?e.setProps?(e.setProps(r.props),n.push(e)):(e.cleanup(),n.push(r)):n.push(r),delete t[r.id]}for(const r in t)t[r].cleanup();this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some((e=>e instanceof oc))||this._resolvedEffects.push(ac),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class cc extends Ql{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}const uc={blendFunc:[1,0,32771,0],blendEquation:32774};class hc extends Ql{constructor(){super(...arguments),g(this,"pickZ",void 0),g(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer(e){let{layers:t,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},cullRect:h,effects:d,pass:f="picking",pickZ:p,moduleParameters:g}=e;const m=this.gl;this.pickZ=p;const v=this._resetColorEncoder(p),b=is(m,{scissorTest:!0,scissor:[a,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...uc,blend:!p},(()=>super.render({target:o,layers:t,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:h,effects:null===d||void 0===d?void 0:d.filter((e=>e.useInPicking)),pass:f,isPicking:!0,moduleParameters:g})));this._colorEncoderState=null;return{decodePickingColor:v&&dc.bind(null,v),stats:b}}shouldDrawLayer(e){const{pickable:t,operation:n}=e.props;return t&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t,n){const r={...e.props.parameters},{pickable:i,operation:s}=e.props;return this._colorEncoderState?i&&s.includes("draw")&&(Object.assign(r,uc),r.blend=!0,r.blendColor=function(e,t,n){const{byLayer:r,byAlpha:i}=e;let s,o=r.get(t);o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:t,viewports:[n]},r.set(t,o),i[s]=o):(q.warn("Too many pickable layers, only picking the first 255")(),s=0));return[0,0,0,s/255]}(this._colorEncoderState,e,n)):r.blend=!1,s.includes("terrain")&&(r.blend=!1),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function dc(e,t){const n=e.byAlpha[t[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(t)}}class fc{constructor(e){g(this,"gl",void 0),g(this,"layerFilter",void 0),g(this,"drawPickingColors",void 0),g(this,"drawLayersPass",void 0),g(this,"pickLayersPass",void 0),g(this,"renderCount",void 0),g(this,"_needsRedraw",void 0),g(this,"renderBuffers",void 0),g(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new cc(e),this.pickLayersPass=new hc(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||Oo.getDefaultFramebuffer(this.gl)};n.effects&&this._preRender(n.effects,n);const r=this.lastPostProcessEffect?this.renderBuffers[0]:n.target,i=t.render({...n,target:r});n.effects&&this._postRender(n.effects,n),this.renderCount++,te("deckRenderer.renderLayers",this,i,e)}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const n of e)t.preRenderStats[n.id]=n.preRender(this.gl,t),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new Oo(this.gl),new Oo(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:n}=this,r={...t,inputBuffer:n[0],swapBuffer:n[1],target:null};for(const i of e)if(i.postRender){if(i.id===this.lastPostProcessEffect){r.target=t.target,i.postRender(this.gl,r);break}const e=i.postRender(this.gl,r);r.inputBuffer=e,r.swapBuffer=e===n[0]?n[1]:n[0]}}}const pc={pickedColor:null,pickedObjectIndex:-1};function gc(e){let{pickedColors:t,decodePickingColor:n,deviceX:r,deviceY:i,deviceRadius:s,deviceRect:o}=e;const{x:a,y:l,width:c,height:u}=o;let h=s*s,d=-1,f=0;for(let p=0;p<u;p++){const e=p+l-i,n=e*e;if(n>h)f+=4*c;else for(let i=0;i<c;i++){if(t[f+3]-1>=0){const e=i+a-r,t=e*e+n;t<=h&&(h=t,d=f)}f+=4}}if(d>=0){const e=t.slice(d,d+4),r=n(e);if(r){const t=Math.floor(d/4/c),n=d/4-t*c;return{...r,pickedColor:e,pickedX:a+n,pickedY:l+t}}q.error("Picked non-existent layer. Is picking buffer corrupt?")()}return pc}function mc(e){let t,{pickInfo:n,viewports:r,pixelRatio:i,x:s,y:o,z:a}=e,l=r[0];if(r.length>1&&(l=function(e,t){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.containsPixel(t))return r}return e[0]}((null===n||void 0===n?void 0:n.pickedViewports)||r,{x:s,y:o})),l){const e=[s-l.x,o-l.y];void 0!==a&&(e[2]=a),t=l.unproject(e)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:t,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:i}}function vc(e){const{pickInfo:t,lastPickedInfo:n,mode:r,layers:i}=e,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=t,l=o?[o]:[];if("hover"===r){const e=n.index,t=n.layerId,r=o?o.props.id:null;if(r!==t||a!==e){if(r!==t){const e=i.find((e=>e.props.id===t));e&&l.unshift(e)}n.layerId=r,n.index=a,n.info=null}}const c=mc(e),u=new Map;return u.set(null,c),l.forEach((e=>{let t={...c};e===o&&(t.color=s,t.index=a,t.picked=!0),t=bc({layer:e,info:t,mode:r});const i=t.layer;e===o&&"hover"===r&&(n.info=t),u.set(i.id,t),"hover"===r&&i.updateAutoHighlight(t)})),u}function bc(e){let{layer:t,info:n,mode:r}=e;for(;t&&n;){const e=n.layer||null;n.sourceLayer=e,n.layer=t,n=t.getPickingInfo({info:n,mode:r,sourceLayer:e}),t=t.parent}return n}class yc{constructor(e){g(this,"gl",void 0),g(this,"pickingFBO",void 0),g(this,"depthFBO",void 0),g(this,"pickLayersPass",void 0),g(this,"layerFilter",void 0),g(this,"lastPickedInfo",void 0),g(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new hc(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject(e){let{x:t,y:n,layers:r,viewports:i}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastPickedInfo.info;const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find((e=>e.id===o)):null,c=a&&i.find((e=>e.id===a))||i[0],u=c&&c.unproject([t-c.x,n-c.y]),h={x:t,y:n,viewport:c,coordinate:u,layer:l};return{...s,...h}}_resizeBuffer(){var e,t;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new Oo(n),Oo.isSupported(n,{colorBufferFloat:!0}))){const e=new Oo(n);e.attach({36064:new Js(n,{format:gi(n)?34836:6408,type:5126})}),this.depthFBO=e}null===(e=this.pickingFBO)||void 0===e||e.resize({width:n.canvas.width,height:n.canvas.height}),null===(t=this.depthFBO)||void 0===t||t.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter((e=>this.pickLayersPass.shouldDrawLayer(e)&&!e.isComposite));return t.length?t:null}_pickClosestObject(e){let{layers:t,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:h}=e;const d=this._getPickable(t),f=ss(this.gl);if(!d)return{result:[],emptyInfo:mc({viewports:r,x:i,y:s,pixelRatio:f})};this._resizeBuffer();const p=os(this.gl,[i,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],m=Math.round(o*f),{width:v,height:b}=this.pickingFBO,y=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:v,deviceHeight:b}),A={x:i-o,y:s-o,width:2*o+1,height:2*o+1};let _;const w=[],C=new Set;for(let E=0;E<a;E++){let e,t;if(y){e=gc({...this._drawAndSample({layers:d,views:n,viewports:r,onViewportActive:u,deviceRect:y,cullRect:A,effects:h,pass:"picking:".concat(l)}),deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:y})}else e={pickedColor:null,pickedObjectIndex:-1};if(e.pickedLayer&&c&&this.depthFBO){const{pickedColors:i}=this._drawAndSample({layers:[e.pickedLayer],views:n,viewports:r,onViewportActive:u,deviceRect:{x:e.pickedX,y:e.pickedY,width:1,height:1},cullRect:A,effects:h,pass:"picking:".concat(l,":z")},!0);i[3]&&(t=i[0])}e.pickedLayer&&E+1<a&&(C.add(e.pickedLayer),e.pickedLayer.disablePickingIndex(e.pickedObjectIndex)),_=vc({pickInfo:e,lastPickedInfo:this.lastPickedInfo,mode:l,layers:d,viewports:r,x:i,y:s,z:t,pixelRatio:f});for(const n of _.values())n.layer&&w.push(n);if(!e.pickedColor)break}for(const E of C)E.restorePickingColors();return{result:w,emptyInfo:_.get(null)}}_pickVisibleObjects(e){let{layers:t,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:h}=e;const d=this._getPickable(t);if(!d)return[];this._resizeBuffer();const f=ss(this.gl),p=os(this.gl,[i,s],!0),g=p.x,m=p.y+p.height,v=os(this.gl,[i+o,s+a],!0),b=v.x+v.width,y=v.y,A={x:g,y:y,width:b-g,height:m-y},_=function(e){let{pickedColors:t,decodePickingColor:n}=e;const r=new Map;if(t)for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const e=t.slice(i,i+4),s=e.join(",");if(!r.has(s)){const t=n(e);t?r.set(s,{...t,color:e}):q.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(r.values())}(this._drawAndSample({layers:d,views:n,viewports:r,onViewportActive:u,deviceRect:A,cullRect:{x:i,y:s,width:o,height:a},effects:h,pass:"picking:".concat(l)})),w=new Map,C=Number.isFinite(c);for(let B=0;B<_.length;B++){var E;if(C&&c&&w.size>=c)break;const e=_[B];let t={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:f};t=bc({layer:e.pickedLayer,info:t,mode:l});const n=null!==(E=t.object)&&void 0!==E?E:"".concat(t.layer.id,"[").concat(t.index,"]");w.has(n)||w.set(n,t)}return Array.from(w.values())}_drawAndSample(e){let{layers:t,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l}=e,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const u=c?this.depthFBO:this.pickingFBO,h={layers:t,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c,preRenderStats:{}};for(const b of a)b.useInPicking&&(h.preRenderStats[b.id]=b.preRender(this.gl,h));const{decodePickingColor:d}=this.pickLayersPass.render(h),{x:f,y:p,width:g,height:m}=s,v=new(c?Float32Array:Uint8Array)(g*m*4);return no(u,{sourceX:f,sourceY:p,sourceWidth:g,sourceHeight:m,target:v}),{pickedColors:v,decodePickingColor:d}}_getPickingRect(e){let{deviceX:t,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}=e;const o=Math.max(0,t-r),a=Math.max(0,n-r),l=Math.min(i,t+r+1)-o,c=Math.min(s,n+r+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const Ac={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class _c{constructor(e){g(this,"el",null),g(this,"isVisible",!1);const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Ac),t.appendChild(this.el))}setTooltip(e,t,n){const r=this.el;if(r){if("string"===typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(n,"px)"),e&&"object"===typeof e&&"style"in e&&Object.assign(r.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}const{_parseImageNode:wc}=globalThis,Cc="undefined"!==typeof Image,Ec="undefined"!==typeof ImageBitmap,Bc=Boolean(wc),xc=!!Ie||Bc;function Sc(e){const t=Mc(e);if(!t)throw new Error("Not an image");return t}function Tc(e){switch(Sc(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function Mc(e){return"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!==typeof Image&&e instanceof Image?"image":e&&"object"===typeof e&&e.data&&e.width&&e.height?"data":null}const Pc=/^data:image\/svg\+xml/,Ic=/\.svg((\?|#).*)?$/;function Rc(e){return e&&(Pc.test(e)||Ic.test(e))}function Oc(e,t){if(Rc(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function Lc(e,t,n){const r=function(e,t){if(Rc(t)){let t=(new TextDecoder).decode(e);try{"function"===typeof unescape&&"function"===typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(n){throw new Error(n.message)}return"data:image/svg+xml;base64,".concat(btoa(t))}return Oc(e,t)}(e,n),i=self.URL||self.webkitURL,s="string"!==typeof r&&i.createObjectURL(r);try{return await async function(e,t){const n=new Image;if(n.src=e,t.image&&t.image.decode&&n.decode)return await n.decode(),n;return await new Promise(((t,r)=>{try{n.onload=()=>t(n),n.onerror=t=>r(new Error("Could not load image ".concat(e,": ").concat(t)))}catch(i){r(i)}}))}(s||r,t)}finally{s&&i.revokeObjectURL(s)}}const Fc={};let kc=!0;async function Dc(e,t,n){let r;if(Rc(n)){r=await Lc(e,t,n)}else r=Oc(e,n);const i=t&&t.imagebitmap;return await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e){for(const t in e||Fc)return!1;return!0}(t)&&kc||(t=null);if(t)try{return await createImageBitmap(e,t)}catch(n){console.warn(n),kc=!1}return await createImageBitmap(e)}(r,i)}function Nc(e){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=(i=t,[...i].map((e=>e.charCodeAt(0))));var i;for(let s=0;s<r.length;++s)if(r[s]!==e[s+n])return!1;return!0}(e,"ftyp",4)?0===(96&e[8])?null:function(e){switch((t=e,n=8,r=12,String.fromCharCode(...t.slice(n,r))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var t,n,r}(e):null}const jc=!1,Uc=!0;function Gc(e){const t=zc(e);return function(e){const t=zc(e),n=t.byteLength>=24&&2303741511===t.getUint32(0,jc);if(!n)return null;return{mimeType:"image/png",width:t.getUint32(16,jc),height:t.getUint32(20,jc)}}(t)||function(e){const t=zc(e),n=t.byteLength>=3&&65496===t.getUint16(0,jc)&&255===t.getUint8(2);if(!n)return null;const{tableMarkers:r,sofMarkers:i}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)e.add(n);const t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}();let s=2;for(;s+9<t.byteLength;){const e=t.getUint16(s,jc);if(i.has(e))return{mimeType:"image/jpeg",height:t.getUint16(s+5,jc),width:t.getUint16(s+7,jc)};if(!r.has(e))return null;s+=2,s+=t.getUint16(s,jc)}return null}(t)||function(e){const t=zc(e),n=t.byteLength>=10&&1195984440===t.getUint32(0,jc);if(!n)return null;return{mimeType:"image/gif",width:t.getUint16(6,Uc),height:t.getUint16(8,Uc)}}(t)||function(e){const t=zc(e),n=t.byteLength>=14&&16973===t.getUint16(0,jc)&&t.getUint32(2,Uc)===t.byteLength;if(!n)return null;return{mimeType:"image/bmp",width:t.getUint32(18,Uc),height:t.getUint32(22,Uc)}}(t)||function(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),n=Nc(t);if(!n)return null;return{mimeType:n.mimeType,width:0,height:0}}(t)}function zc(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}const Vc={id:"image",module:"images",name:"Images",version:"3.4.15",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(e,t,n){const r=((t=t||{}).image||{}).type||"auto",{url:i}=n||{};let s;switch(function(e){switch(e){case"auto":case"data":return function(){if(Ec)return"imagebitmap";if(Cc)return"image";if(xc)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return Ec||Cc||xc;case"imagebitmap":return Ec;case"image":return Cc;case"data":return xc;default:throw new Error("@loaders.gl/images: image ".concat(e," not supported in this environment"))}}(e),e}}(r)){case"imagebitmap":s=await Dc(e,t,i);break;case"image":s=await Lc(e,t,i);break;case"data":s=await async function(e){const{mimeType:t}=Gc(e)||{},n=globalThis._parseImageNode;return ge(n),await n(e,t)}(e);break;default:ge(!1)}return"data"===r&&(s=Tc(s)),s},tests:[e=>Boolean(Gc(new DataView(e)))],options:{image:{type:"auto",decode:!0}}};const Hc={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(e){const t=e[0],n=e[e.length-1];return"{"===t&&"}"===n||"["===t&&"]"===n},parseTextSync:JSON.parse};const Jc=function(){const e="8.9.36",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==e)throw new Error("deck.gl - multiple versions detected: ".concat(t," vs ").concat(e));return t||(q.log(1,"deck.gl ".concat(e))(),globalThis.deck={...globalThis.deck,VERSION:e,version:e,log:q,_registerLoggers:ee},wt([Hc,[Vc,{imagebitmap:{premultiplyAlpha:"none"}}]])),e}(),Wc=globalThis;function Xc(e){if(!e&&!R())return"Node";if(I(e))return"Electron";const t="undefined"!==typeof navigator?navigator:{},n=e||t.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i?"IE":Wc.chrome?"Chrome":Wc.safari?"Safari":Wc.mozInnerScreenX?"Firefox":"Unknown"}class Kc extends xs{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=gi(e),r=Po(e,ao);let i=n||r;for(const s of t)switch(s){case"queries":i=i&&n;break;case"timers":i=i&&r;break;default:vs(!1)}return i}constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise(((n,r)=>{const i=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)})),this._pollingPromise}_createHandle(){return Kc.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Qc=R()&&"undefined"!==typeof document;let Yc=0;class Zc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:t=e=>ds(e),onAddHTML:n=null,onInitialize:r=()=>{},onRender:i=()=>{},onFinalize:s=()=>{},onError:o,gl:a=null,glOptions:l={},debug:c=!1,createFramebuffer:u=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:d=!0,stats:f=ms.get("animation-loop-".concat(Yc++))}=e;let{useDevicePixels:p=!0}=e;"useDevicePixelRatio"in e&&(hi.deprecated("useDevicePixelRatio","useDevicePixels")(),p=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:n,onInitialize:r,onRender:i,onFinalize:s,onError:o,gl:a,glOptions:l,debug:c,createFramebuffer:u},this.gl=a,this.needsRedraw=null,this.timeline=null,this.stats=f,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:d,useDevicePixels:p}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return vs("string"===typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then((()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Kc.isSupported(this.gl,["timers"])?new Kc(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps)))).then((e=>{this._running&&(this._addCallbackData(e||{}),!1!==e&&this._startLoop())}));return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((e=>{this._resolveNextFrame=e}))),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=document.getElementById(e);return n?Number(n.value):t}setViewParameters(){return hi.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Qc?new Promise(((e,t)=>{Qc&&"complete"===document.readyState?e(document):window.addEventListener("load",(()=>{e(document)}))})):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):(t=e,"undefined"!==typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t));var t}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):(t=e,"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60));var t}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:n}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"===typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!==typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?fs(this.props.gl,e):this.onCreateContext(e),!pi(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");rs(this.gl,ji),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let n=1;const{canvas:r}=this.gl;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:e>0&&t>0&&(n=e/t),{width:e,height:t,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&ps(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Oo(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var qc=n(895);const $c={mousedown:1,mousemove:2,mouseup:4};!function(e){const t=e.prototype.handler;e.prototype.handler=function(e){const n=this.store;e.button>0&&"pointerdown"===e.type&&(function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}(n,(t=>t.pointerId===e.pointerId))||n.push(e)),t.call(this,e)}}(qc.PointerEventInput),qc.MouseInput.prototype.handler=function(e){let t=$c[e.type];1&t&&e.button>=0&&(this.pressed=!0),2&t&&0===e.buttons&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))};const eu=qc.Manager,tu=qc;class nu{constructor(e,t,n){this.element=e,this.callback=t,this.options={enable:!0,...n}}}const ru=tu?[[tu.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[tu.Rotate,{enable:!1}],[tu.Pinch,{enable:!1}],[tu.Swipe,{enable:!1}],[tu.Pan,{threshold:0,enable:!1}],[tu.Press,{enable:!1}],[tu.Tap,{event:"doubletap",taps:2,enable:!1}],[tu.Tap,{event:"anytap",enable:!1}],[tu.Tap,{enable:!1}]]:null,iu={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},su={doubletap:["tap"]},ou={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},au={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},lu={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},cu={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},uu="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",hu="undefined"!==typeof window?window:n.g;"undefined"!==typeof n.g?n.g:window,"undefined"!==typeof document&&document;let du=!1;try{const e={get passive(){return du=!0,!0}};hu.addEventListener("test",null,e),hu.removeEventListener("test",null)}catch(Zv){du=!1}const fu=-1!==uu.indexOf("firefox"),{WHEEL_EVENTS:pu}=au,gu="wheel",mu=4.000244140625;class vu extends nu{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{if(!this.options.enable)return;let t=e.deltaY;hu.WheelEvent&&(fu&&e.deltaMode===hu.WheelEvent.DOM_DELTA_PIXEL&&(t/=hu.devicePixelRatio),e.deltaMode===hu.WheelEvent.DOM_DELTA_LINE&&(t*=40)),0!==t&&t%mu===0&&(t=Math.floor(t/mu)),e.shiftKey&&t&&(t*=.25),this.callback({type:gu,center:{x:e.clientX,y:e.clientY},delta:-t,srcEvent:e,pointerType:"mouse",target:e.target})},this.events=(this.options.events||[]).concat(pu),this.events.forEach((t=>e.addEventListener(t,this.handleEvent,!!du&&{passive:!1})))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===gu&&(this.options.enable=t)}}const{MOUSE_EVENTS:bu}=au,yu="pointermove",Au="pointerover",_u="pointerout",wu="pointerenter",Cu="pointerleave";class Eu extends nu{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{this.handleOverEvent(e),this.handleOutEvent(e),this.handleEnterEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(bu),this.events.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===yu&&(this.enableMoveEvent=t),e===Au&&(this.enableOverEvent=t),e===_u&&(this.enableOutEvent=t),e===wu&&(this.enableEnterEvent=t),e===Cu&&(this.enableLeaveEvent=t)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit(Au,e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit(_u,e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit(wu,e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit(Cu,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.buttons&&(this.pressed=!1),this.pressed||this._emit(yu,e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const{KEY_EVENTS:Bu}=au,xu="keydown",Su="keyup";class Tu extends nu{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:xu,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:Su,srcEvent:e,key:e.key,target:e.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Bu),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===xu&&(this.enableDownEvent=t),e===Su&&(this.enableUpEvent=t)}}const Mu="contextmenu";class Pu extends nu{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{this.options.enable&&this.callback({type:Mu,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===Mu&&(this.options.enable=t)}}const Iu={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function Ru(e){const t=Iu[e.srcEvent.type];if(!t)return null;const{buttons:n,button:r}=e.srcEvent;let i=!1,s=!1,o=!1;return 2===t?(i=Boolean(1&n),s=Boolean(4&n),o=Boolean(2&n)):(i=0===r,s=1===r,o=2===r),{leftButton:i,middleButton:s,rightButton:o}}function Ou(e,t){const n=e.center;if(!n)return null;const r=t.getBoundingClientRect(),i=r.width/t.offsetWidth||1,s=r.height/t.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-r.left-t.clientLeft)/i,y:(n.y-r.top-t.clientTop)/s}}}const Lu={srcElement:"root",priority:0};class Fu{constructor(e){this.handleEvent=e=>{if(this.isEmpty())return;const t=this._normalizeEvent(e);let n=e.srcEvent.target;for(;n&&n!==t.rootElement;){if(this._emit(t,n),t.handled)return;n=n.parentNode}this._emit(t,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{handlers:s,handlersByElement:o}=this;let a=Lu;"string"===typeof n||n&&n.addEventListener?a={...Lu,srcElement:n}:n&&(a={...Lu,...n});let l=o.get(a.srcElement);l||(l=[],o.set(a.srcElement,l));const c={type:e,handler:t,srcElement:a.srcElement,priority:a.priority};r&&(c.once=!0),i&&(c.passive=!0),s.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(e,t){const{handlers:n,handlersByElement:r}=this;for(let i=n.length-1;i>=0;i--){const s=n[i];if(s.type===e&&s.handler===t){n.splice(i,1);const e=r.get(s.srcElement);e.splice(e.indexOf(s),1),0===e.length&&r.delete(s.srcElement)}}this._active=n.some((e=>!e.passive))}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let t=!1;const r=()=>{e.handled=!0},i=()=>{e.handled=!0,t=!0},s=[];for(let o=0;o<n.length;o++){const{type:a,handler:l,once:c}=n[o];if(l({...e,type:a,stopPropagation:r,stopImmediatePropagation:i}),c&&s.push(n[o]),t)break}for(let e=0;e<s.length;e++){const{type:t,handler:n}=s[e];this.remove(t,n)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...Ru(e),...Ou(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}const ku={events:null,recognizers:null,recognizerOptions:{},Manager:eu,touchAction:"none",tabIndex:0};class Du{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;this._onBasicInput=e=>{const{srcEvent:t}=e,n=ou[t.type];n&&this.manager.emit(n,e)},this._onOtherEvent=e=>{this.manager.emit(e.type,e)},this.options={...ku,...t},this.events=new Map,this.setElement(e);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this,n=t.Manager;this.manager=new n(e,{touchAction:t.touchAction,recognizers:t.recognizers||ru}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(iu).forEach((e=>{const t=this.manager.get(e);t&&iu[e].forEach((e=>{t.recognizeWith(e)}))}));for(const r in t.recognizerOptions){const e=this.manager.get(r);if(e){const n=t.recognizerOptions[r];delete n.enable,e.set(n)}}this.wheelInput=new vu(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Eu(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Tu(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new Pu(e,this._onOtherEvent,{enable:!1});for(const[r,i]of this.events)i.isEmpty()||(this._toggleRecognizer(i.recognizerName,!0),this.manager.on(r,i.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:n}=this;if(!n)return;const r=n.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const i=su[e];i&&!this.options.recognizers&&i.forEach((i=>{const s=n.get(i);t?(s.requireFailure(e),r.dropRequireFailure(i)):s.dropRequireFailure(e)}))}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,n,r,i){if("string"!==typeof e){n=t;for(const t in e)this._addEventHandler(t,e[t],n,r,i);return}const{manager:s,events:o}=this,a=cu[e]||e;let l=o.get(a);l||(l=new Fu(this),o.set(a,l),l.recognizerName=lu[a]||a,s&&s.on(a,l.handleEvent)),l.add(e,t,n,r,i),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(e,t){if("string"!==typeof e){for(const t in e)this._removeEventHandler(t,e[t]);return}const{events:n}=this,r=cu[e]||e,i=n.get(r);if(i&&(i.remove(e,t),i.isEmpty())){const{recognizerName:e}=i;let t=!1;for(const r of n.values())if(r.recognizerName===e&&!r.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}}function Nu(){}const ju={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Nu,onResize:Nu,onViewStateChange:Nu,onInteractionStateChange:Nu,onBeforeRender:Nu,onAfterRender:Nu,onLoad:Nu,onError:e=>q.error(e.message,e.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:e=>{let{isDragging:t}=e;return t?"grabbing":"grab"},getTooltip:null,debug:!1,drawPickingColors:!1};class Uu{constructor(e){g(this,"props",void 0),g(this,"width",0),g(this,"height",0),g(this,"userData",{}),g(this,"canvas",null),g(this,"viewManager",null),g(this,"layerManager",null),g(this,"effectManager",null),g(this,"deckRenderer",null),g(this,"deckPicker",null),g(this,"eventManager",null),g(this,"tooltip",null),g(this,"metrics",void 0),g(this,"animationLoop",void 0),g(this,"stats",void 0),g(this,"viewState",void 0),g(this,"cursorState",void 0),g(this,"_needsRedraw",void 0),g(this,"_pickRequest",void 0),g(this,"_lastPointerDownInfo",null),g(this,"_metricsCounter",void 0),g(this,"_onPointerMove",(e=>{const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const n=e.offsetCenter;if(!n)return;t.x=n.x,t.y=n.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e})),g(this,"_onEvent",(e=>{const t=yr[e.type],n=e.offsetCenter;if(!t||!n||!this.layerManager)return;const r=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:s}=i,o=s&&(s[t.handler]||s.props[t.handler]),a=this.props[t.handler];let l=!1;o&&(l=o.call(s,i,e)),!l&&a&&a(i,e)})),g(this,"_onPointerDown",(e=>{const t=e.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:t.x,y:t.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo})),this.props={...ju,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&q.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===Xc()&&q.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||"undefined"!==typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new ae({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&kt.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,t,n,r,i,s,o,a,l;(null===(e=this.animationLoop)||void 0===e||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(t=this.layerManager)||void 0===t||t.finalize(),this.layerManager=null,null===(n=this.viewManager)||void 0===n||n.finalize(),this.viewManager=null,null===(r=this.effectManager)||void 0===r||r.finalize(),this.effectManager=null,null===(i=this.deckRenderer)||void 0===i||i.finalize(),this.deckRenderer=null,null===(s=this.deckPicker)||void 0===s||s.finalize(),this.deckPicker=null,null===(o=this.eventManager)||void 0===o||o.destroy(),this.eventManager=null,null===(a=this.tooltip)||void 0===a||a.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas)||(null===(l=this.canvas.parentElement)||void 0===l||l.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&q.removed("onLayerHover","onHover")(),"onLayerClick"in e&&q.removed("onLayerClick","onClick")(),e.initialViewState&&!ol(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),i=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return t=t||n||r||i||s,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return null!==this.viewManager}getViews(){return hl(this.viewManager),this.viewManager.views}getViewports(e){return hl(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,t,n){hl(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const i=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return r.get(t).timeEnd(),i}_createCanvas(e){let t=e.canvas;if("string"===typeof t&&(t=document.getElementById(t),hl(t)),!t){t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay";(e.parent||document.body).appendChild(t)}return Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:n}=e;if(t||0===t){const e=Number.isFinite(t)?"".concat(t,"px"):t;this.canvas.style.width=e}if(n||0===n){var r;const t=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=(null===(r=e.style)||void 0===r?void 0:r.position)||"absolute",this.canvas.style.height=t}}_updateCanvasSize(){var e,t;const{canvas:n}=this;if(!n)return;const r=null!==(e=n.clientWidth)&&void 0!==e?e:n.width,i=null!==(t=n.clientHeight)&&void 0!==t?t:n.height;var s,o;r===this.width&&i===this.height||(this.width=r,this.height=i,null===(s=this.viewManager)||void 0===s||s.setProps({width:r,height:i}),null===(o=this.layerManager)||void 0===o||o.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:i}))}_createAnimationLoop(e){const{width:t,height:n,gl:r,glOptions:i,debug:s,onError:o,onBeforeRender:a,onAfterRender:l,useDevicePixels:c}=e;return new Zc({width:t,height:n,useDevicePixels:c,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,gl:r,onCreateContext:e=>ds({...i,...e,canvas:this.canvas,debug:s,onContextLost:()=>this._onContextLost()}),onInitialize:e=>this._setGLContext(e.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:l,onError:o})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Nl({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:n,emptyInfo:r}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=n.length>0;let i=r,s=!1;for(const o of n){var t;i=o,s=(null===(t=o.layer)||void 0===t?void 0:t.onHover(o,e.event))||s}if(!s&&this.props.onHover&&this.props.onHover(i,e.event),this.props.getTooltip&&this.tooltip){const e=this.props.getTooltip(i);this.tooltip.setTooltip(e,i.x,i.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,fs(e,{enable:!0,copyState:!0})),this.tooltip=new _c(this.canvas),rs(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new b;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new Du(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in yr)this.eventManager.on(r,this._onEvent);this.viewManager=new al({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new sl(e,{deck:this,stats:this.stats,viewport:n,timeline:t}),this.effectManager=new lc,this.deckRenderer=new fc(e),this.deckPicker=new yc(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:n}=this.layerManager.context;rs(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...t}),this.props.onAfterRender({gl:n})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),q.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const n=ms.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}g(Uu,"defaultProps",ju),g(Uu,"VERSION",Jc);const Gu="undefined"!==typeof window?h.useLayoutEffect:h.useEffect;function zu(e,t){for(;e;){if(e===t)return!0;e=Object.getPrototypeOf(e)}return!1}class Vu{constructor(e,t){g(this,"opts",void 0),g(this,"source",void 0),this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:n}=this.source,{size:r}=t;let i=n;if(n&&n.length!==r){i=new Float32Array(r);const e=t.elementOffset||0;for(let t=0;t<r;++t)i[t]=n[e+t]}return i}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function Hu(e){return e.stride||e.size*e.bytesPerElement}function Ju(e,t){t.offset&&q.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Hu(e),r=(void 0!==t.vertexOffset?t.vertexOffset:e.vertexOffset||0)*n+(t.elementOffset||0)*e.bytesPerElement+(e.offset||0);return{...t,offset:r,stride:n}}class Wu{constructor(e,t,n){g(this,"gl",void 0),g(this,"id",void 0),g(this,"size",void 0),g(this,"settings",void 0),g(this,"value",void 0),g(this,"doublePrecision",void 0),g(this,"_buffer",void 0),g(this,"state",void 0),this.gl=e,this.id=t.id||"",this.size=t.size||1;const r=t.logicalType||t.type,i=5130===r;let s,{defaultValue:o}=t;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0),s=i?5126:!r&&t.isIndexed?e&&Mo(e,uo)?5125:5123:r||5126;let a=function(e){switch(e){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(r||s||5126);this.doublePrecision=i,i&&!1===t.fp64&&(a=Float32Array),this.value=null,this.settings={...t,defaultType:a,defaultValue:o,logicalType:r,type:s,size:this.size,bytesPerElement:a.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new Ds(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Hu(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),kt.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const n={},r=this.value instanceof Float64Array,i=function(e,t){const n=Ju(e,t);return{high:n,low:{...n,offset:n.offset+4*e.size}}}(this.getAccessor(),t||{});return n[e]=new Vu(this,i.high),n["".concat(e,"64Low")]=r?new Vu(this,i.low):new Float32Array(this.size),n}if(t){const n=Ju(this.getAccessor(),t);return{[e]:new Vu(this,n)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:n,size:r}=this,i=n*r;if(t&&i&&t.length>=i){const n=new Array(r).fill(1/0),s=new Array(r).fill(-1/0);for(let e=0;e<i;)for(let i=0;i<r;i++){const r=t[e++];r<n[i]&&(n[i]=r),r>s[i]&&(s[i]=r)}e=[n,s]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let n;n=ArrayBuffer.isView(e)?{value:e}:e instanceof Ds?{buffer:e}:e;const r={...this.settings,...n};if(t.bufferAccessor=r,t.bounds=null,n.constant){let e=n.value;e=this._normalizeValue(e,[],0),this.settings.normalized&&(e=this.normalizeConstant(e));if(!(!t.constant||!this._areValuesEqual(e,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=e}else if(n.buffer){const e=n.buffer;t.externalBuffer=e,t.constant=!1,this.value=n.value||null;const i=n.value instanceof Float64Array;r.type=n.type||e.accessor.type,r.bytesPerElement=e.accessor.BYTES_PER_ELEMENT*(i?2:1),r.stride=Hu(r)}else if(n.value){this._checkExternalBuffer(n);let e=n.value;t.externalBuffer=null,t.constant=!1,this.value=e,r.bytesPerElement=e.BYTES_PER_ELEMENT,r.stride=Hu(r);const{buffer:i,byteOffset:s}=this;this.doublePrecision&&e instanceof Float64Array&&(e=mn(e,r));const o=e.byteLength+s+2*r.stride;i.byteLength<o&&i.reallocate(o),i.setAccessor(null),i.subData({data:e,offset:s}),r.type=n.type||i.accessor.type}return!0}updateSubBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.bounds=null;const t=this.value,{startOffset:n=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?mn(t,{size:this.size,startIndex:n,endIndex:r}):t.subarray(n,r),offset:n*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{state:n}=this,r=n.allocatedValue,i=kt.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=i;const{buffer:s,byteOffset:o}=this;return s.byteLength<i.byteLength+o&&(s.reallocate(i.byteLength+o),t&&r&&s.subData({data:r instanceof Float64Array?mn(r,this):r,offset:o})),n.allocatedValue=i,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));t instanceof n||!this.settings.normalized||"normalized"in e||q.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map((e=>(e+128)/255*2-1));case 5122:return new Float32Array(e).map((e=>(e+32768)/65535*2-1));case 5121:return new Float32Array(e).map((e=>e/255));case 5123:return new Float32Array(e).map((e=>e/65535));default:return e}}_normalizeValue(e,t,n){const{defaultValue:r,size:i}=this.settings;if(Number.isFinite(e))return t[n]=e,t;if(!e){let e=i;for(;--e>=0;)t[n+e]=r[e];return t}switch(i){case 4:t[n+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[n+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[n+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[n+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let s=i;for(;--s>=0;)t[n+s]=Number.isFinite(e[s])?e[s]:r[s]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}}const Xu=[],Ku=[];function Qu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r=Xu;const i={index:-1,data:e,target:[]};return e?"function"===typeof e[Symbol.iterator]?r=e:e.length>0&&(Ku.length=e.length,r=Ku):r=Xu,(t>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(t,n),i.index=t-1),{iterable:r,objectInfo:i}}function Yu(e){return e&&e[Symbol.asyncIterator]}const Zu=[],qu=[[0,1/0]];function $u(e){const{source:t,target:n,start:r=0,size:i,getData:s}=e,o=e.end||n.length,a=t.length,l=o-r;if(a>l)return void n.set(t.subarray(0,l),r);if(n.set(t,r),!s)return;let c=a;for(;c<l;){const e=s(c,t);for(let t=0;t<i;t++)n[r+c]=e[t]||0,c++}}const eh={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function th(e,t){if(!e)return null;Number.isFinite(e)&&(e={type:"interpolation",duration:e});const n=e.type||"interpolation";return{...eh[n],...t,...e,type:n}}function nh(e,t){const n=t.getBuffer();return n?[n,{divisor:0,size:t.size,normalized:t.settings.normalized}]:t.value}function rh(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(e,'"'))}}function ih(e){e.push(e.shift())}function sh(e,t){const{doublePrecision:n,settings:r,value:i,size:s}=e,o=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:t*s)*o}function oh(e){let{buffer:t,numInstances:n,attribute:r,fromLength:i,fromStartIndices:s,getData:o=e=>e}=e;const a=r.doublePrecision&&r.value instanceof Float64Array?2:1,l=r.size*a,c=r.byteOffset,u=r.startIndices,h=s&&u,d=sh(r,n),f=r.isConstant;if(!h&&i>=d)return;const p=f?r.value:r.getBuffer().getData({srcByteOffset:c});if(r.settings.normalized&&!f){const e=o;o=(t,n)=>r.normalizeConstant(e(t,n))}const g=f?(e,t)=>o(p,t):(e,t)=>o(p.subarray(e,e+l),t),m=t.getData({length:i}),v=new Float32Array(d);!function(e){let{source:t,target:n,size:r,getData:i,sourceStartIndices:s,targetStartIndices:o}=e;if(!Array.isArray(o))return $u({source:t,target:n,size:r,getData:i}),n;let a=0,l=0;const c=i&&((e,t)=>i(e+l,t)),u=Math.min(s.length,o.length);for(let h=1;h<u;h++){const e=s[h]*r,i=o[h]*r;$u({source:t.subarray(a,e),target:n,start:l,end:i,size:r,getData:c}),a=e,l=i}l<n.length&&$u({source:[],target:n,start:l,size:r,getData:c})}({source:m,target:v,sourceStartIndices:s,targetStartIndices:u,size:l,getData:g}),t.byteLength<v.byteLength+c&&t.reallocate(v.byteLength+c),t.subData({data:v,offset:c})}class ah extends Wu{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:qu}),g(this,"constant",!1),this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!==typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,n=this.settings.transition,r=Array.isArray(t)?e[t.find((t=>e[t]))]:e[t];return th(r,n)}setNeedsUpdate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:e=0,endRow:n=1/0}=t;this.state.updateRanges=function(e,t){if(e===qu)return e;if(t[0]<0&&(t[0]=0),t[0]>=t[1])return e;const n=[],r=e.length;let i=0;for(let s=0;s<r;s++){const r=e[s];r[1]<t[0]?(n.push(r),i=s+1):r[0]>t[1]?n.push(r):t=[Math.min(r[0],t[0]),Math.max(r[1],t[1])]}return n.splice(i,0,t),n}(this.state.updateRanges,[e,n])}else this.state.updateRanges=qu}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Zu}setNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate(e,t.updateRanges!==qu),!0))}updateBuffer(e){let{numInstances:t,data:n,props:r,context:i}=e;if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[e,a]of s)o.call(i,this,{data:n,startRow:e,endRow:a,props:r,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of s){const r=Number.isFinite(e)?this.getVertexOffset(e):0,i=Number.isFinite(n)?this.getVertexOffset(n):a||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:r,endOffset:i})}else;this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){if(void 0===e||"function"===typeof e)return!1;return this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{state:n,settings:r}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;n.binaryValue=e,this.setNeedsRedraw();if(r.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const i=e;hl(ArrayBuffer.isView(i.value),"invalid ".concat(r.accessor));const s=Boolean(i.size)&&i.size!==this.size;return n.binaryAccessor=function(e,t){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=t,a=e.BYTES_PER_ELEMENT,l=r?r/a:n,c=i?i/a:0,u=Math.floor((e.length-c)/l);return(t,r)=>{let{index:i,target:a}=r;if(!s){const t=i*l+c;for(let r=0;r<n;r++)a[r]=e[t+r];return a}const h=s[i],d=s[i+1]||u;let f;if(o){f=new Array(d-h);for(let t=h;t<d;t++){const r=t*l+c;a=new Array(n);for(let t=0;t<n;t++)a[t]=e[r+t];f[t-h]=a}}else if(l===n)f=e.subarray(h*n+c,d*n+c);else{f=new e.constructor((d-h)*n);let t=0;for(let r=h;r<d;r++){const i=r*l+c;for(let r=0;r<n;r++)f[t++]=e[i+r]}}return f}}(i.value,{size:i.size||this.size,stride:i.stride,offset:i.offset,startIndices:t,nested:s}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const n in e)Object.assign(t,super.getShaderAttributes(n,e[n]));return t}_autoUpdater(e,t){let{data:n,startRow:r,endRow:i,props:s,numInstances:o}=t;if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:h}=e,{accessor:d,transform:f}=a,p=l.binaryAccessor||("function"===typeof d?d:s[d]);hl("function"===typeof p,'accessor "'.concat(d,'" is not a function'));let g=e.getVertexOffset(r);const{iterable:m,objectInfo:v}=Qu(n,r,i);for(const b of m){v.index++;let t=p(b,v);if(f&&(t=f.call(this,t)),h){const n=(v.index<h.length-1?h[v.index+1]:o)-h[v.index];if(t&&Array.isArray(t[0])){let n=g;for(const r of t)e._normalizeValue(r,c,n),n+=u}else t&&t.length>u?c.set(t,g):(e._normalizeValue(t,v.target,0),ie({target:c,source:v.target,start:g,count:n}));g+=n*u}else e._normalizeValue(t,c,g),g+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||"function"===typeof e.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let n=!0;switch(t){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const lh="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",ch="#version 300 es\n".concat(lh);function uh(e,t){t=Array.isArray(t)?t:[t];const n=e.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!t.includes(r)||!i||!s)return null;return{qualifier:r,type:i,name:s.split(";")[0]}}function hh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:t=100,input:n,inputType:r,output:i}=e;if(!n)return 300===t?ch:t>300?"#version ".concat(t,"\n").concat(lh):"void main() {gl_FragColor = vec4(0);}";const s=function(e,t){switch(t){case"float":return"vec4(".concat(e,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(e,", 0.0, 1.0)");case"vec3":return"vec4(".concat(e,", 1.0)");case"vec4":return e;default:return Sr(!1),null}}(n,r);return t>=300?"#version ".concat(t," ").concat(300===t?"es":"","\nin ").concat(r," ").concat(n,";\nout vec4 ").concat(i,";\nvoid main() {\n  ").concat(i," = ").concat(s,";\n}"):"varying ".concat(r," ").concat(n,";\nvoid main() {\n  gl_FragColor = ").concat(s,";\n}")}class dh extends xs{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return gi(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vi(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Cs(this.buffers)||this.bind((()=>this._unbindBuffers())),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind((()=>{for(const t in e)this.setBuffer(t,e[t])})),this}setBuffer(e,t){const n=this._getVaryingIndex(e),{buffer:r,byteSize:i,byteOffset:s}=this._getBufferParams(t);return n<0?(this.unused[e]=r,hi.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[n]=t,this.bindOnUse||this._bindBuffer(n,r,s,i),this)}begin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,n,r;return e instanceof Ds===!1?(r=e.buffer,n=e.byteSize,t=e.byteOffset):r=e,void 0===t&&void 0===n||(t=t||0,n=n||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:n}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:n,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,n)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const i=t&&t.handle;return i&&void 0!==r?this.gl.bindBufferRange(35982,e,i,n,r):this.gl.bindBufferBase(35982,e,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class fh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:r}=t;return{attributes:Object.assign({},n,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],n=e?t[e]:null;return n?n instanceof Ds?n:n.buffer:null}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:t}=e,n=this.getBuffer(t);return n?n.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&vs(gi(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const e=this.feedbackMap[r];r in t&&(n[e]=r)}Object.assign(n,e.feedbackBuffers);for(const r in n){const e=n[r];if("string"===typeof e){const i=t[e],{byteLength:s,usage:o,accessor:a}=i;n[r]=this._createNewBuffer(r,{byteLength:s,usage:o,accessor:a})}}return n}_setupBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const n=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:n})}_setupTransformFeedback(e,t){let{model:n}=t;const{program:r}=n;e.transformFeedback=new dh(this.gl,{program:r,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:e,feedbackBuffers:t}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:e,feedbackBuffers:t})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),n=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const i=this.feedbackMap[r];t[r]=e.feedbackBuffers[i],n[i]=e.sourceBuffers[r],vs(n[i]instanceof Ds)}return{sourceBuffers:t,feedbackBuffers:n}}_createNewBuffer(e,t){const n=new Ds(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}function ph(e){let t=100;const n=e.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const e=parseInt(n[1],10);Number.isFinite(e)&&(t=e)}return t}const gh={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},mh="transform_uSampler_",vh="transform_uSize_",bh="transform_position";function yh(e){let{vs:t,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=e;let s=Object.keys(n).length,o=null;const a={};let l=t,c={};if(s>0||r){const e=l.split("\n"),t=e.slice();if(e.forEach(((e,i,l)=>{if(s>0){const r=function(e,t){const n={},r=function(e){return uh(e,["attribute","in"])}(e);if(!r)return null;const{type:i,name:s}=r;if(s&&t[s]){const t="// ".concat(e," => Replaced by Transform with a sampler"),{samplerName:r,sizeName:o,uniformDeclerations:a}=function(e){const t="".concat(mh).concat(e),n="".concat(vh).concat(e),r="  uniform sampler2D ".concat(t,";\n  uniform vec2 ").concat(n,";");return{samplerName:t,sizeName:n,uniformDeclerations:r}}(s),l=function(e){switch(e){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Sr(!1),null}}(i),c="  ".concat(i," ").concat(s," = transform_getInput(").concat(r,", ").concat(o,").").concat(l,";\n");n[r]=s;return{updatedLine:t,inject:{"vs:#decl":a,"vs:#main-start":c},samplerTextureMap:n}}return null}(e,n);if(r){const{updatedLine:e,inject:n}=r;t[i]=e,c=Kr([c,n]),Object.assign(a,r.samplerTextureMap),s--}}r&&!o&&(o=function(e,t){const n=uh(e,["varying","out"]);if(!n)return null;return n.name===t?n.type:null}(e,r))})),r){vs(i);const e="".concat(vh).concat(r),t="uniform vec2 ".concat(e,";\n"),n="     vec2 ".concat(bh," = transform_getPos(").concat(e,");\n     gl_Position = vec4(").concat(bh,", 0, 1.);\n");c=Kr([c,{"vs:#decl":t,"vs:#main-start":n}])}l=t.join("\n")}return{vs:l,targetTextureType:o,inject:c,samplerTextureMap:a}}const Ah={10241:9728,10240:9728,10242:33071,10243:33071};class _h{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t,sourceTextures:n,framebuffer:r,targetTexture:i}=this.bindings[this.currentIndex],s=Object.assign({},t,e.attributes),o=Object.assign({},e.uniforms),a=Object.assign({},e.parameters);let l=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){s.transform_elementID=this.elementIDBuffer;for(const t in this.samplerTextureMap){const e=this.samplerTextureMap[t];o[t]=n[e]}this._setSourceTextureParameters();const e=function(e){let{sourceTextureMap:t,targetTextureVarying:n,targetTexture:r}=e;const i={};let s,o;n&&(({width:s,height:o}=r),i["".concat(vh).concat(n)]=[s,o]);for(const a in t)({width:s,height:o}=t[a]),i["".concat(vh).concat(a)]=[s,o];return i}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i});Object.assign(o,e)}return this.hasTargetTexture&&(l=!1,a.viewport=[0,0,r.width,r.height]),{attributes:s,framebuffer:r,uniforms:o,discard:l,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:t}=this.bindings[this.currentIndex],n=no(t);if(!e)return n;const r=n.constructor,i=function(e){switch(e){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Sr(!1),null}}(this.targetTextureType),s=new r(n.length*i/4);let o=0;for(let a=0;a<n.length;a+=4)for(let e=0;e<i;e++)s[o++]=n[a+e];return s}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:t,_swapTexture:n}=e;this._swapTexture=n,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:n}=e;if(n instanceof Js)return n;const r=t[n];return r?(this._targetRefTexName=n,this._createNewTexture(r)):null}_setupTextures(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t,_sourceTextures:n={},_targetTexture:r}=e,i=this._createTargetTexture({sourceTextures:n,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:n,targetTexture:i}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!==typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach(((e,t,n)=>{n[t]=t})),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new Ds(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:e,targetTexture:t}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:e,targetTexture:t})}}_updateBinding(e,t){const{sourceBuffers:n,sourceTextures:r,targetTexture:i}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,n),i){e.targetTexture=i;const{width:t,height:n}=i,{framebuffer:r}=e;r?(r.update({attachments:{36064:i},resizeAttachments:!1}),r.resize({width:t,height:n})):e.framebuffer=new Oo(this.gl,{id:"transform-framebuffer",width:t,height:n,attachments:{36064:i}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const n in t)t[n].setParameters(Ah)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);t[this._swapTexture]=e.targetTexture;return{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=function(e,t){vs(e instanceof Js||e instanceof $s||e instanceof eo);const n=e.constructor,{gl:r,width:i,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u}=e;return new n(r,Object.assign({width:i,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u},t))}(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:t,targetTexture:n}=this.bindings[this.currentIndex],{vs:r,uniforms:i,targetTextureType:s,inject:o,samplerTextureMap:a}=yh({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),l=Kr([e.inject||{},o]);this.targetTextureType=s,this.samplerTextureMap=a;return{vs:r,fs:e._fs||hh({version:ph(r),input:this.targetTextureVarying,inputType:s,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[gh].concat(e.modules||[]):e.modules,uniforms:i,inject:l}}}let wh=null;function Ch(e,t){var n;return new e((n=e.BYTES_PER_ELEMENT*t,(!wh||wh.byteLength<n)&&(wh=new ArrayBuffer(n)),wh),0,t)}class Eh extends xs{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||(gi(e)||"Chrome"===Xc())}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Eh(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Eh.MAX_ATTRIBUTES=Eh.MAX_ATTRIBUTES||e.getParameter(34921),Eh.MAX_ATTRIBUTES}static setConstant(e,t,n){switch(n.constructor){case Float32Array:Eh._setConstantFloatArray(e,t,n);break;case Int32Array:Eh._setConstantIntArray(e,t,n);break;case Uint32Array:Eh._setConstantUintArray(e,t,n);break;default:vs(!1)}}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.id||t.program&&t.program.id;super(e,Object.assign({},t,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Eh.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return vs(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind((()=>{this.gl.bindBuffer(34963,e?e.handle:null)})),this}setBuffer(e,t,n){if(34963===t.target)return this.setElementBuffer(t,n);const{size:r,type:i,stride:s,offset:o,normalized:a,integer:l,divisor:c}=n,{gl:u,gl2:h}=this;return e=Number(e),this.bind((()=>{u.bindBuffer(34962,t.handle),l?(vs(gi(u)),h.vertexAttribIPointer(e,r,i,s,o)):u.vertexAttribPointer(e,r,i,a,s,o),u.enableVertexAttribArray(e),h.vertexAttribDivisor(e,c||0)})),this}enable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!t&&0===e&&!Eh.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind((()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e)))),this}getConstantBuffer(e,t){const n=this._normalizeConstantArrayValue(t),r=n.byteLength*e,i=n.length*e;let s=!this.buffer;if(this.buffer=this.buffer||new Ds(this.gl,r),s=s||this.buffer.reallocate(r),s=s||!this._compareConstantArrayValues(n,this.bufferValue),s){const e=Ch(t.constructor,i);!function(e){let{target:t,source:n,start:r=0,count:i=1}=e;const s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)t[l++]=n[a];for(;a<o;)a<o-a?(t.copyWithin(r+a,r,r+a),a*=2):(t.copyWithin(r+a,r,r+o-a),a=o)}({target:e,source:n,start:0,count:i}),this.buffer.subData(e),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}static _setConstantFloatArray(e,t,n){switch(n.length){case 1:e.vertexAttrib1fv(t,n);break;case 2:e.vertexAttrib2fv(t,n);break;case 3:e.vertexAttrib3fv(t,n);break;case 4:e.vertexAttrib4fv(t,n);break;default:vs(!1)}}static _setConstantIntArray(e,t,n){switch(vs(gi(e)),n.length){case 1:e.vertexAttribI1iv(t,n);break;case 2:e.vertexAttribI2iv(t,n);break;case 3:e.vertexAttribI3iv(t,n);break;case 4:e.vertexAttribI4iv(t,n);break;default:vs(!1)}}static _setConstantUintArray(e,t,n){switch(vs(gi(e)),n.length){case 1:e.vertexAttribI1uiv(t,n);break;case 2:e.vertexAttribI2uiv(t,n);break;case 3:e.vertexAttribI3uiv(t,n);break;case 4:e.vertexAttribI4uiv(t,n);break;default:vs(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,t){let{location:n}=t;return vs(Number.isFinite(n)),this.bind((()=>34373===e?this.gl.getVertexAttribOffset(n,e):this.gl.getVertexAttrib(n,e)))}}const Bh=/^(.+)__LOCATION_([0-9]+)$/,xh=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Sh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.id||t.program&&t.program.id;this.id=n,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Eh(e),Es(this,"VertexArray","v6.0",xh),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind((()=>{for(const t in e){const n=e[t];this._setAttribute(t,n)}this.gl.bindBuffer(34962,null)})),this}setElementBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===t.target)return this.setElementBuffer(t,n);const{location:r,accessor:i}=this._resolveLocationAndAccessor(e,t,t.accessor,n);return r>=0&&(this.values[r]=t,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,i)),this}setConstant(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:r,accessor:i}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},n));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Ds(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Ds&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))})),this}bindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof Ds&&this.setBuffer(e,t)}})),this}bindForDraw(e,t,n){let r;return this.vertexArrayObject.bind((()=>{this._setConstantAttributes(e,t),r=n()})),r}_resolveLocationAndAccessor(e,t,n,r){const i={location:-1,accessor:null},{location:s,name:o}=this._getAttributeIndex(e);if(!Number.isFinite(s)||s<0)return this.unused[e]=t,hi.once(3,(()=>"unused value ".concat(e," in ").concat(this.id)))(),i;const a=this._getAttributeInfo(o||s);if(!a)return i;const l=this.accessors[s]||{},c=Os.resolve(a.accessor,l,n,r),{size:u,type:h}=c;return vs(Number.isFinite(u)&&Number.isFinite(h)),{location:s,accessor:c}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const n=Bh.exec(e),r=n?n[1]:e,i=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+i,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof Ds)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof Ds){const n=t[0],r=t[1];this.setBuffer(e,n,r)}else if(ArrayBuffer.isView(t)||Array.isArray(t)){const n=t;this.setConstant(e,n)}else{if(!(t.buffer instanceof Ds))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const n=t;this.setBuffer(e,n.buffer,n)}}}_setConstantAttributes(e,t){const n=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(let i=1;i<this.vertexArrayObject.MAX_ATTRIBUTES;i++)r=this.values[i],ArrayBuffer.isView(r)&&this._setConstantAttribute(i,r)}_setConstantAttributeZero(e,t){if(Eh.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const n=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(e,t){Eh.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const n=this.values[t],r=this.accessors[t];if(!n)return;const{divisor:i}=r,s=i>0;if(e.isInstanced=e.isInstanced||s,n instanceof Ds){const t=n;if(s){const n=t.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,n)}else{const n=t.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,n)}}}setElements(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return hi.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function Th(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{isInteger:n=!1}=t;if(Array.isArray(e)||ArrayBuffer.isView(e))return function(e,t){const{maxElts:n=16,size:r=1}=t;let i="[";for(let o=0;o<e.length&&o<n;++o)o>0&&(i+=",".concat(o%r===0?" ":"")),i+=Th(e[o],t);const s=e.length>n?"...":"]";return"".concat(i).concat(s)}(e,t);if(!Number.isFinite(e))return String(e);if(Math.abs(e)<1e-16)return n?"0":"0.";if(n)return e.toFixed(0);if(Math.abs(e)>100&&Math.abs(e)<1e4)return e.toFixed(0);const r=e.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function Mh(e,t,n,r){const{gl:i}=e;if(!t)return{[r]:"null","Format ":"N/A"};let s,o,a,l="NOT PROVIDED",c=1,u=0,h=0;if(n&&(l=n.type,c=n.size,l=String(l).replace("Array",""),s=-1!==l.indexOf("nt")),t instanceof Ds){const e=t,{data:d,changed:f}=e.getDebugData();let p;if(o=f?"*":"",a=d,h=e.byteLength,u=h/d.BYTES_PER_ELEMENT/c,n){const e=n.divisor>0;p="".concat(e?"I ":"P "," ").concat(u," (x").concat(c,"=").concat(h," bytes ").concat(ys(i,l),")")}else s=!0,p="".concat(h," bytes");return{[r]:"".concat(o).concat(Th(a,{size:c,isInteger:s})),"Format ":p}}return a=t,c=t.length,l=String(t.constructor.name).replace("Array",""),s=-1!==l.indexOf("nt"),{[r]:"".concat(Th(a,{size:c,isInteger:s})," (constant)"),"Format ":"".concat(c,"x").concat(l," (constant)")}}function Ph(e,t){const{type:n,size:r}=t,i=Ra(n,r);return i?"".concat(e," (").concat(i.name,")"):e}function Ih(e){let{header:t="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=e;vs(n);const s=".*Matrix",o=n._uniformSetters,a={},l=Object.keys(o).sort();let c=0;for(const d of l)d.match(".*_.*")||d.match(s)||Rh({table:a,header:t,uniforms:r,uniformName:d,undefinedOnly:i})&&c++;for(const d of l)d.match(s)&&Rh({table:a,header:t,uniforms:r,uniformName:d,undefinedOnly:i})&&c++;for(const d of l)a[d]||Rh({table:a,header:t,uniforms:r,uniformName:d,undefinedOnly:i})&&c++;let u=0;const h={};if(!i)for(const d in r){const e=r[d];a[d]||(u++,h[d]={Type:"NOT USED: ".concat(e),[t]:Th(e)})}return{table:a,count:c,unusedTable:h,unusedCount:u}}function Rh(e){let{table:t,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=e;const o=r[i],a=function(e){return void 0!==e&&null!==e}(o);return(!s||!a)&&(t[i]={[n]:a?Th(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},!0)}function Oh(e){const{type:t,size:n}=e.accessor,r=Ra(t,n);return r?"".concat(r.name," ").concat(e.name):e.name}const Lh={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Fh(e,t){const{attributeMap:n=Lh}=t||{};return n&&n[e]||e}function kh(e,t){let n;switch(e){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":t.size=t.size||3;break;case"uvs":t.size=t.size||2}vs(Number.isFinite(t.size),"attribute ".concat(e," needs size"))}const Dh=()=>{},Nh={};class jh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:n=_s("model")}=t;vs(pi(e)),this.id=n,this.gl=e,this.id=t.id||_s("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||Da.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:n,fs:r,modules:i,defines:s,inject:o,varyings:a,bufferMode:l,transpileToGLSL100:c}=e;this.programProps={program:t,vs:n,fs:r,modules:i,defines:s,inject:o,varyings:a,bufferMode:l,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},vs(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:n,fs:r,modules:i,defines:s,inject:o,varyings:a,bufferMode:l,transpileToGLSL100:c}=e;this.programProps={program:t,vs:n,fs:r,modules:i,defines:s,inject:o,varyings:a,bufferMode:l,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return vs(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return vs(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(e,t,n){const r={};let i=t.indices;for(const s in t.attributes){const o=t.attributes[s],a=Fh(s,n);if("indices"===s)i=o;else if(o.constant)r[a]=o.value;else{const t=o.value,n={...o};delete n.value,r[a]=[new Ds(e,t),n],kh(s,n)}}if(i){const t=i.value||i;vs(t instanceof Uint16Array||t instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===i.isIndexed||i.isIndexed};r.indices=[new Ds(e,{data:t,target:34963}),n]}return r}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Cs(e))return this;const t={};for(const n in e){const r=e[n];t[n]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return Zs(this.program.gl,e),this}draw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:t=null,framebuffer:n,uniforms:r={},attributes:i={},transformFeedback:s=this.transformFeedback,parameters:o={},vertexArray:a=this.vertexArray}=e;let l;this.setAttributes(i),this.updateModuleSettings(t),this.setUniforms(r),hi.priority>=2&&(l=this._logDrawCallStart(2));const c=this.vertexArray.getDrawParams(),{isIndexed:u=c.isIndexed,indexType:h=c.indexType,indexOffset:d=c.indexOffset,vertexArrayInstanced:f=c.isInstanced}=this.props;f&&!this.isInstanced&&hi.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:p,instanceCount:g}=this,{onBeforeRender:m=Dh,onAfterRender:v=Dh}=this.props;m(),this.program.setUniforms(this.uniforms);const b=this.program.draw(Object.assign(Nh,e,{logPriority:l,uniforms:null,framebuffer:n,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:a,transformFeedback:s,isIndexed:u,indexType:h,isInstanced:p,instanceCount:g,offset:u?d:0}));return v(),hi.priority>=2&&this._logDrawCallEnd(l,a,n),b}transform(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:t=!0,feedbackBuffers:n,unbindModels:r=[]}=e;let{parameters:i}=e;n&&this._setFeedbackBuffers(n),t&&(i=Object.assign({},i,{35977:t})),r.forEach((e=>e.vertexArray.unbindBuffers()));try{this.draw(Object.assign({},e,{parameters:i}))}finally{r.forEach((e=>e.vertexArray.bindBuffers()))}return this}render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return hi.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:e}=this.programProps;if(e)this._managedProgram=!1;else{const{vs:t,fs:n,modules:r,inject:i,defines:s,varyings:o,bufferMode:a,transpileToGLSL100:l}=this.programProps;e=this.programManager.get({vs:t,fs:n,modules:r,inject:i,defines:s,varyings:o,bufferMode:a,transpileToGLSL100:l}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}vs(e instanceof ka,"Model needs a program"),this._programDirty=!1,e!==this.program&&(this.program=e,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Sh(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof Ds&&t.delete()}}_setAnimationProps(e){this.animated&&vs(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Cs(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new dh(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),hi.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:hi.level<=2})(),e}_logDrawCallEnd(e,t,n,r){if(void 0===e)return;const i=function(e){let{vertexArray:t,header:n="Attributes"}=e;if(!t.configuration)return{};const r={};t.elements&&(r.ELEMENT_ARRAY_BUFFER=Mh(t,t.elements,null,n));const i=t.values;for(const s in i){const e=t._getAttributeInfo(s);if(e){let o="".concat(s,": ").concat(e.name);const a=t.accessors[e.location];a&&(o="".concat(s,": ").concat(Ph(e.name,a))),r[o]=Mh(t,i[s],a,n)}}return r}({vertexArray:t,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:s,unusedTable:o,unusedCount:a}=Ih({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:l,count:c}=Ih({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});c>0&&hi.log("MISSING UNIFORMS",Object.keys(l))(),a>0&&hi.log("UNUSED UNIFORMS",Object.keys(o))();const u=function(e){const t={},n="Accessors for ".concat(e.id);for(const r of e.attributeInfos)if(r){const e=Oh(r);t["in ".concat(e)]={[n]:JSON.stringify(r.accessor)}}for(const r of e.varyingInfos)if(r){const e=Oh(r);t["out ".concat(e)]={[n]:JSON.stringify(r.accessor)}}return t}(this.vertexArray.configuration);hi.table(e,i)(),hi.table(e,s)(),hi.table(e+1,u)(),r&&r.log({logLevel:2,message:"Rendered to ".concat(r.id)}),hi.groupEnd(2)()}}class Uh{static isSupported(e){return gi(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:n}=this;e&&e.delete(),t&&t.delete(),n&&n.delete()}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:t=!0}=e,n=this._updateDrawOptions(e);t&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t)e=e||n.swap();vs(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t){const t=n.getData(e);if(t)return t}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t)n.update(e)}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new jh(t,Object.assign({},e,{fs:e.fs||hh({version:ph(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(e){if(!Cs(e.feedbackBuffers)||!Cs(e.feedbackMap)||e.varyings&&e.varyings.length>0)return!0;return!1})(t)&&(this.bufferTransform=new fh(e,t)),function(e){if(!Cs(e._sourceTextures)||e._targetTexture||e._targetTextureVarying)return!0;return!1}(t)&&(this.textureTransform=new _h(e,t)),vs(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)t=Object.assign(t,r.getDrawOptions(t));return t}}const Gh="\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n";const zh={interpolation:class{constructor(e){let{gl:t,attribute:n,timeline:r}=e;g(this,"gl",void 0),g(this,"type","interpolation"),g(this,"attributeInTransition",void 0),g(this,"settings",void 0),g(this,"attribute",void 0),g(this,"transition",void 0),g(this,"currentStartIndices",void 0),g(this,"currentLength",void 0),g(this,"transform",void 0),g(this,"buffers",void 0),this.gl=t,this.transition=new pl(r),this.attribute=n,this.attributeInTransition=new ah(t,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=function(e,t){const n=rh(t.size);return new Uh(e,{vs:Gh,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(t,n);const i={byteLength:0,usage:35050};this.buffers=[new Ds(t,i),new Ds(t,i)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();this.settings=e;const{gl:n,buffers:r,attribute:i}=this;ih(r);const s={numInstances:t,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of r)oh({buffer:o,...s});this.currentStartIndices=i.startIndices,this.currentLength=sh(i,t),this.attributeInTransition.setData({buffer:r[1],value:i.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aFrom:r[0],aTo:nh(0,i)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{duration:e,easing:t}=this.settings,{time:n}=this.transition;let r=n/e;t&&(r=t(r)),this.transform.run({uniforms:{time:r}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}},spring:class{constructor(e){let{gl:t,attribute:n,timeline:r}=e;g(this,"gl",void 0),g(this,"type","spring"),g(this,"attributeInTransition",void 0),g(this,"settings",void 0),g(this,"attribute",void 0),g(this,"transition",void 0),g(this,"currentStartIndices",void 0),g(this,"currentLength",void 0),g(this,"texture",void 0),g(this,"framebuffer",void 0),g(this,"transform",void 0),g(this,"buffers",void 0),this.gl=t,this.type="spring",this.transition=new pl(r),this.attribute=n,this.attributeInTransition=new ah(t,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=function(e){return new Js(e,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function(e,t){return new Oo(e,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:t}})}(t,this.texture),this.transform=function(e,t,n){const r=rh(t.size);return new Uh(e,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}(t,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new Ds(t,i),new Ds(t,i),new Ds(t,i)]}get inProgress(){return this.transition.inProgress}start(e,t){const{gl:n,buffers:r,attribute:i}=this,s={numInstances:t,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of r)oh({buffer:o,...s});this.settings=e,this.currentStartIndices=i.startIndices,this.currentLength=sh(i,t),this.attributeInTransition.setData({buffer:r[1],value:i.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aTo:nh(0,i)}})}update(){const{buffers:e,transform:t,framebuffer:n,transition:r}=this;if(!r.update())return!1;const i=this.settings;t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:i.stiffness,damping:i.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),ih(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value});return no(n)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class Vh{constructor(e,t){let{id:n,timeline:r}=t;g(this,"id",void 0),g(this,"isSupported",void 0),g(this,"gl",void 0),g(this,"timeline",void 0),g(this,"transitions",void 0),g(this,"needsRedraw",void 0),g(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Uh.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update(e){let{attributes:t,transitions:n,numInstances:r}=e;this.numInstances=r||1;for(const i in t){const e=t[i],r=e.getTransitionSetting(n);r&&this._updateAttribute(i,e,r)}for(const i in this.transitions){const e=t[i];e&&e.getTransitionSetting(n)||this._removeTransition(i)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const n=this.transitions[t];n.inProgress&&(e[t]=n.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions){this.transitions[t].update()&&(this.needsRedraw=!0)}const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,n){const r=this.transitions[e];let i=!r||r.type!==n.type;if(i){if(!this.isSupported)return void q.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const s=zh[n.type];s?this.transitions[e]=new s({attribute:t,timeline:this.timeline,gl:this.gl}):(q.error("unsupported transition type '".concat(n.type,"'"))(),i=!1)}(i||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const Hh="attributeManager.invalidate";class Jh{constructor(e){let{id:t="attribute-manager",stats:n,timeline:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};g(this,"id",void 0),g(this,"gl",void 0),g(this,"attributes",void 0),g(this,"updateTriggers",void 0),g(this,"needsRedraw",void 0),g(this,"userData",void 0),g(this,"stats",void 0),g(this,"attributeTransitionManager",void 0),g(this,"mergeBoundsMemoized",Wa(vn)),this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new Vh(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const t of e)void 0!==this.attributes[t]&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const n=this._invalidateTrigger(e,t);te(Hh,this,e,n)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);te(Hh,this,"all")}update(e){let{data:t,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}=e,l=!1;te("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const e=this.attributes[c],i=e.settings.accessor;e.startIndices=r,e.numInstances=n,s[c]&&q.removed("props.".concat(c),"data.attributes.".concat(c))(),e.setExternalBuffer(o[c])||e.setBinaryValue("string"===typeof i?o[i]:void 0,t.startIndices)||"string"===typeof i&&!o[i]&&e.setConstantValue(s[i])||e.needsUpdate()&&(l=!0,this._updateAttribute({attribute:e,numInstances:n,data:t,props:s,context:a})),this.needsRedraw=this.needsRedraw||e.needsRedraw()}l&&te("attributeManager.updateEnd",this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getBounds(e){const t=e.map((e=>{var t;return null===(t=this.attributes[e])||void 0===t?void 0:t.getBounds()}));return this.mergeBoundsMemoized(t)}getChangedAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearChangedFlags:!1};const{attributes:t,attributeTransitionManager:n}=this,r={...n.getAttributes()};for(const i in t){const s=t[i];s.needsRedraw(e)&&!n.hasAttribute(i)&&(r[i]=s)}return r}getShaderAttributes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e||(e=this.getAttributes());const n={};for(const r in e)t[r]||Object.assign(n,e[r].getShaderAttributes());return n}_add(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(const n in e){const r=e[n];this.attributes[n]=this._createAttribute(n,r,t)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,n){const r={...t,id:e,size:(t.isIndexed?1:t.size)||1,divisor:n.instanced?1:t.divisor||0};return new ah(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes){this.attributes[t].getUpdateTriggers().forEach((n=>{e[n]||(e[n]=[]),e[n].push(t)}))}this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:n,updateTriggers:r}=this,i=r[e];return i&&i.forEach((e=>{const r=n[e];r&&r.setNeedsUpdate(r.id,t)})),i}_updateAttribute(e){const{attribute:t,numInstances:n}=e;if(te("attribute.updateStart",t),t.constant)return void t.setConstantValue(t.value);t.allocate(n)&&te("attribute.allocate",t,n);t.updateBuffer(e)&&(this.needsRedraw=!0,te("attribute.updateEnd",t,n))}}const Wh=1e-5;function Xh(e,t,n,r,i){const s=t-e;return(n-t)*i+-s*r+s+t}function Kh(e,t){if(Array.isArray(e)){let n=0;for(let r=0;r<e.length;r++){const i=e[r]-t[r];n+=i*i}return Math.sqrt(n)}return Math.abs(e-t)}const Qh={interpolation:class extends pl{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:n,duration:r,easing:i}}=this,s=i(e/r);this._value=Gt(t,n,s)}},spring:class extends pl{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:n,stiffness:r}=this.settings,{_prevValue:i=e,_currValue:s=e}=this;let o=function(e,t,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=Xh(e[o],t[o],n[o],r,i);return s}return Xh(e,t,n,r,i)}(i,s,t,n,r);const a=Kh(o,t),l=Kh(o,s);a<Wh&&l<Wh&&(o=t,this.end()),this._prevValue=s,this._currValue=o}}};class Yh{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,n,r){const{transitions:i}=this;if(i.has(e)){const n=i.get(e),{value:r=n.settings.fromValue}=n;t=r,this.remove(e)}if(!(r=th(r)))return;const s=Qh[r.type];if(!s)return void q.error("unsupported transition type '".concat(r.type,"'"))();const o=new s(this.timeline);o.start({...r,fromValue:t,toValue:n}),i.set(e,o)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,n]of this.transitions)n.update(),e[t]=n.value,n.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Zh(e,t){const n=$h({newProps:e,oldProps:t,propTypes:e[x],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(e,t){if(null===t)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=e;r?r(e.data,t.data)||(n="Data comparator detected a change"):e.data!==t.data&&(n="A new data container was supplied");n&&i&&(n=i(e.data,t.data)||n);return n}(e,t);let i=!1;return r||(i=function(e,t){if(null===t)return{all:!0};if("all"in e.updateTriggers){if(nd(e,t,"all"))return{all:!0}}const n={};let r=!1;for(const i in e.updateTriggers)if("all"!==i){nd(e,t,i)&&(n[i]=!0,r=!0)}return!!r&&n}(e,t)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:td(e,t),transitionsChanged:qh(e,t)}}function qh(e,t){if(!e.transitions)return!1;const n={},r=e[x];let i=!1;for(const s in e.transitions){const o=r[s],a=o&&o.type;("number"===a||"color"===a||"array"===a)&&ed(e[s],t[s],o)&&(n[s]=!0,i=!0)}return!!i&&n}function $h(e){let{newProps:t,oldProps:n,ignoreProps:r={},propTypes:i={},triggerName:s="props"}=e;if(n===t)return!1;if("object"!==typeof t||null===t)return"".concat(s," changed shallowly");if("object"!==typeof n||null===n)return"".concat(s," changed shallowly");for(const o of Object.keys(t))if(!(o in r)){if(!(o in n))return"".concat(s,".").concat(o," added");const e=ed(t[o],n[o],i[o]);if(e)return"".concat(s,".").concat(o," ").concat(e)}for(const o of Object.keys(n))if(!(o in r)){if(!(o in t))return"".concat(s,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const e=ed(t[o],n[o],i[o]);if(e)return"".concat(s,".").concat(o," ").concat(e)}}return!1}function ed(e,t,n){let r=n&&n.equal;return r&&!r(e,t,n)?"changed deeply":r||(r=e&&t&&e.equals,!r||r.call(e,t))?r||t===e?null:"changed shallowly":"changed deeply"}function td(e,t){if(null===t)return!0;const n=t.extensions,{extensions:r}=e;if(r===n)return!1;if(!n||!r)return!0;if(r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function nd(e,t,n){let r=e.updateTriggers[n];r=void 0===r||null===r?{}:r;let i=t.updateTriggers[n];i=void 0===i||null===i?{}:i;return $h({oldProps:i,newProps:r,triggerName:n})}function rd(e){if(null===(t=e)||"object"!==typeof t)throw new Error("count(): argument not an object");var t;if("function"===typeof e.count)return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(function(e){return null!==e&&"object"===typeof e&&e.constructor===Object}(e))return Object.keys(e).length;throw new Error("count(): argument not a container")}function id(e,t){if(!t)return e;const n={...e,...t};if("defines"in t&&(n.defines={...e.defines,...t.defines}),"modules"in t&&(n.modules=(e.modules||[]).concat(t.modules),t.modules.some((e=>"project64"===e.name)))){const e=n.modules.findIndex((e=>"project32"===e.name));e>=0&&n.modules.splice(e,1)}if("inject"in t)if(e.inject){const r={...e.inject};for(const e in t.inject)r[e]=(r[e]||"")+t.inject[e];n.inject=r}else n.inject=t.inject;return n}const sd=[0,0,0];function od(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=t.projectPosition(e);if(n&&t instanceof fl){const[n,i,s=0]=e,o=t.getDistanceScales([n,i]);r[2]=s*o.unitsPerMeter[2]}return r}function ad(e,t){let{viewport:n,modelMatrix:r,coordinateSystem:i,coordinateOrigin:s,offsetMode:o}=t,[a,l,c=0]=e;switch(r&&([a,l,c]=Rn([],[a,l,c,1],r)),i){case mr.LNGLAT:return od([a,l,c],n,o);case mr.LNGLAT_OFFSETS:return od([a+s[0],l+s[1],c+(s[2]||0)],n,o);case mr.METER_OFFSETS:return od(ar(s,[a,l,c]),n,o);case mr.CARTESIAN:default:return n.isGeospatial?[a+s[0],l+s[1],c+s[2]]:n.projectPosition([a,l,c])}}function ld(e,t){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(e){const{viewport:t,modelMatrix:n,coordinateOrigin:r}=e;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=e;return i===mr.DEFAULT&&(i=t.isGeospatial?mr.LNGLAT:mr.CARTESIAN),void 0===s&&(s=i),void 0===o&&(o=r),{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}(t),{autoOffset:l=!0}=t,{geospatialOrigin:c=sd,shaderCoordinateOrigin:u=sd,offsetMode:h=!1}=l?$a(n,r,i):{},d=ad(e,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:h});if(h){const e=n.projectPosition(c||u);sn(d,d,e)}return d}const cd={10241:9987,10240:9729,10242:33071,10243:33071},ud={};const hd={boolean:{validate:(e,t)=>!0,equal:(e,t,n)=>Boolean(e)===Boolean(t)},number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},color:{validate:(e,t)=>t.optional&&!e||pd(e)&&(3===e.length||4===e.length),equal:(e,t,n)=>ol(e,t,1)},accessor:{validate(e,t){const n=gd(e);return"function"===n||n===gd(t.value)},equal:(e,t,n)=>"function"===typeof t||ol(e,t,1)},array:{validate:(e,t)=>t.optional&&!e||pd(e),equal(e,t,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?ol(e,t,i):e===t}},object:{equal(e,t,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?ol(e,t,i):e===t}},function:{validate:(e,t)=>t.optional&&!e||"function"===typeof e,equal:(e,t,n)=>!n.compare&&!1!==n.ignore||e===t},data:{transform:(e,t,n)=>{const{dataTransform:r}=n.props;return r&&e?r(e):e}},image:{transform:(e,t,n)=>{const r=n.context;return r&&r.gl?function(e,t,n,r){if(n instanceof Js)return n;n.constructor&&"Object"!==n.constructor.name&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const s=new Js(t,{...n,parameters:{...cd,...i,...r}});return ud[s.id]=e,s}(n.id,r.gl,e,{...t.parameters,...n.props.textureParameters}):null},release:(e,t,n)=>{var r,i;r=n.id,(i=e)&&i instanceof Js&&ud[i.id]===r&&(i.delete(),delete ud[i.id])}}};function dd(e,t){switch(gd(t)){case"object":return fd(e,t);case"array":return fd(e,{type:"array",value:t,compare:!1});case"boolean":return fd(e,{type:"boolean",value:t});case"number":return fd(e,{type:"number",value:t});case"function":return fd(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function fd(e,t){return"type"in t?{name:e,...hd[t.type],...t}:"value"in t?{name:e,type:gd(t.value),...t}:{name:e,type:"object",value:t}}function pd(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function gd(e){return pd(e)?"array":null===e?"null":typeof e}const md="_mergedDefaultProps";function vd(e,t){let n=md;if(t)for(const i of t){const e=i.constructor;e&&(n+=":".concat(e.extensionName||e.name))}const r=Ad(e,n);return r||(e[n]=function(e,t){const n=e.prototype;if(!n)return null;const r=Object.getPrototypeOf(e),i=vd(r),s=Ad(e,"defaultProps")||{},o=function(e){const t={},n={},r={};for(const[i,s]of Object.entries(e)){const e=null===s||void 0===s?void 0:s.deprecatedFor;if(e)r[i]=Array.isArray(e)?e:[e];else{const e=dd(i,s);t[i]=e,n[i]=e.value}}return{propTypes:t,defaultProps:n,deprecatedProps:r}}(s),a=Object.assign(Object.create(null),i,o.defaultProps),l=Object.assign(Object.create(null),null===i||void 0===i?void 0:i[x],o.propTypes),c=Object.assign(Object.create(null),null===i||void 0===i?void 0:i[S],o.deprecatedProps);for(const u of t){const e=vd(u.constructor);e&&(Object.assign(a,e),Object.assign(l,e[x]),Object.assign(c,e[S]))}(function(e,t){const n=function(e){const t=e.componentName;t||q.warn("".concat(e.name,".componentName not specified"))();return t||e.name}(t);Object.defineProperties(e,{id:{writable:!0,value:n}})})(a,e),function(e,t){const n={},r={};for(const i in t){const e=t[i],{name:s,value:o}=e;e.async&&(n[s]=o,r[s]=bd(s))}e[T]=n,e[M]={},Object.defineProperties(e,r)}(a,l),function(e,t){for(const n in t)Object.defineProperty(e,n,{enumerable:!1,set(e){const r="".concat(this.id,": ").concat(n);for(const i of t[n])yd(this,i)||(this[i]=e);q.deprecated(r,t[n].join("/"))()}})}(a,c),a[x]=l,a[S]=c,0!==t.length||yd(e,"_propTypes")||(e._propTypes=l);return a}(e,t||[]))}function bd(e){return{enumerable:!0,set(t){"string"===typeof t||t instanceof Promise||Yu(t)?this[M][e]=t:this[P][e]=t},get(){if(this[P]){if(e in this[P]){return this[P][e]||this[T][e]}if(e in this[M]){const t=this[B]&&this[B].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[T][e]}}return this[T][e]}}}function yd(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ad(e,t){return yd(e,t)&&e[t]}let _d=0;class wd{constructor(){g(this,"id",void 0),g(this,"props",void 0),g(this,"count",void 0);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.props=function(e,t){let n;for(let s=t.length-1;s>=0;s--){const e=t[s];"extensions"in e&&(n=e.extensions)}const r=vd(e.constructor,n),i=Object.create(r);i[B]=e,i[M]={},i[P]={};for(let s=0;s<t.length;++s){const e=t[s];for(const t in e)i[t]=e[t]}return Object.freeze(i),i}(this,t),this.id=this.props.id,this.count=_d++}clone(e){const{props:t}=this,n={};for(const r in t[T])r in t[P]?n[r]=t[P][r]:r in t[M]&&(n[r]=t[M][r]);return new this.constructor({...t,...n,...e})}}g(wd,"componentName","Component"),g(wd,"defaultProps",{});const Cd=Object.freeze({});class Ed{constructor(e){g(this,"component",void 0),g(this,"onAsyncPropUpdated",void 0),g(this,"asyncProps",void 0),g(this,"oldProps",void 0),g(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||Cd}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[B]||this.component;const t=e[P]||{},n=e[M]||e,r=e[T]||{};for(const i in t){const e=t[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,e),t[i]=this.getAsyncProp(i)}for(const i in n){const e=n[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,e)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){this._didAsyncInputValueChange(e,t)&&("string"===typeof t&&(t=this._fetch(e,t)),t instanceof Promise?this._watchPromise(e,t):Yu(t)?this._resolveAsyncIterable(e,t):this._setPropValue(e,t))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const n=this.asyncProps[e];return t!==n.resolvedValue&&t!==n.lastValue&&(n.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(t=this._postProcessValue(n,t),n.resolvedValue=t,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,t,n){const r=this.asyncProps[e];r&&n>=r.resolvedLoadCount&&void 0!==t&&(this._freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=n,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const r=n.pendingLoadCount;t.then((t=>{this.component&&(t=this._postProcessValue(n,t),this._setAsyncPropValue(e,t,r),this._onResolve(e,t))})).catch((t=>{this._onError(e,t)}))}}async _resolveAsyncIterable(e,t){if("data"!==e)return void this._setPropValue(e,t);const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const r=n.pendingLoadCount;let i=[],s=0;for await(const o of t){if(!this.component)return;const{dataTransform:t}=this.component.props;i=t?t(o,i):i.concat(o),Object.defineProperty(i,"__diff",{enumerable:!1,value:[{startRow:s,endRow:i.length}]}),s=i.length,this._setAsyncPropValue(e,i,r)}this._onResolve(e,i)}_postProcessValue(e,t){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(t,n,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const n=this.component&&this.component.props[x];this.asyncProps[e]={type:n&&n[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class Bd extends Ed{constructor(e){let{attributeManager:t,layer:n}=e;super(n),g(this,"attributeManager",void 0),g(this,"needsRedraw",void 0),g(this,"needsUpdate",void 0),g(this,"subLayers",void 0),g(this,"usesPickingColorCache",void 0),g(this,"hasPickingBuffer",void 0),g(this,"changeFlags",void 0),g(this,"viewport",void 0),g(this,"uniformTransitions",void 0),g(this,"propsInTransition",void 0),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const n=this.layer,r=null===n||void 0===n?void 0:n.props.fetch;return r?r(t,{propName:e,layer:n}):super._fetch(e,t)}_onResolve(e,t){const n=this.layer;if(n){const r=n.props.onDataLoad;"data"===e&&r&&r(t,{propName:e,layer:n})}}_onError(e,t){const n=this.layer;n&&n.raiseError(t,"loading ".concat(e," of ").concat(this.layer))}}const xd=2**24-1,Sd=Object.freeze([]),Td=Wa((e=>{let{oldViewport:t,viewport:n}=e;return t.equals(n)}));let Md=new Uint8ClampedArray(0);const Pd={data:{type:"data",value:Sd,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:e=>e&&e.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(e,t)=>{let{propName:n,layer:r,loaders:i,loadOptions:s,signal:o}=t;const{resourceManager:a}=r.context;var l;(s=s||r.getLoadOptions(),i=i||r.props.loaders,o)&&(s={...s,fetch:{...null===(l=s)||void 0===l?void 0:l.fetch,signal:o}});let c=a.contains(e);return c||s||(a.add({resourceId:e,data:Ot(e,i),persistent:!1}),c=!0),c?a.subscribe({resourceId:e,onChange:e=>{var t;return null===(t=r.internalState)||void 0===t?void 0:t.reloadAsyncProp(n,e)},consumerId:r.id,requestId:n}):Ot(e,i,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:mr.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:e=>{let{layerIndex:t}=e;return[0,100*-t]}},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Id extends wd{constructor(){super(...arguments),g(this,"internalState",null),g(this,"lifecycle",y),g(this,"context",void 0),g(this,"state",void 0),g(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){hl(this.internalState);const t=this.internalState.viewport||this.context.viewport,n=ad(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,i,s]=hr(n,t.pixelProjectionMatrix);return 2===e.length?[r,i]:[r,i,s]}unproject(e){hl(this.internalState);return(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){hl(this.internalState);return ld(e,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const t of this.getModels())t.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===mr.DEFAULT||e===mr.LNGLAT||e===mr.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){hl(e instanceof Uint8Array);const[t,n,r]=e;return t+256*n+65536*r-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:rd(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const t of this.props.extensions)e=id(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&t)if(Array.isArray(n))for(const r of n)t.invalidateAll(r);else t.invalidateAll();if(t){const{props:n}=e,r=this.internalState.hasPickingBuffer,i=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some((e=>e.getNeedsPickingBuffer.call(this,e)));if(r!==i){this.internalState.hasPickingBuffer=i;const{pickingColors:e,instancePickingColors:n}=t.attributes,r=e||n;r&&(i&&r.constant&&(r.constant=!1,t.invalidate(r.id)),r.value||i||(r.constant=!0,r.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e)}getPickingInfo(e){let{info:t,mode:n,sourceLayer:r}=e;const{index:i}=t;return i>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[i]),t}raiseError(e,t){var n,r,i,s;(t&&(e=new Error("".concat(t,": ").concat(e.message),{cause:e})),null!==(n=(r=this.props).onError)&&void 0!==n&&n.call(r,e))||(null===(i=this.context)||void 0===i||null===(s=i.onError)||void 0===s||s.call(i,e,this))}getNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(e)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var e;return(null===(e=this.internalState)||void 0===e?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,t&&Td({oldViewport:t,viewport:e})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";const t=this.getAttributeManager();t&&("all"===e?t.invalidateAll():t.invalidate(e))}updateAttributes(e){for(const t of this.getModels())this._setModelAttributes(t,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,n=this.getNumInstances(),r=this.getStartIndices();e.update({data:t.data,numInstances:n,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const i=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),n=Object.create(this.props);for(const e in t)Object.defineProperty(n,e,{value:t[e]});return n}return this.props}calculateInstancePickingColors(e,t){let{numInstances:n}=t;if(e.constant)return;const r=Math.floor(Md.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>xd&&q.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Md=kt.allocate(Md,n,{size:3,copy:!0,maxCount:Math.max(n,xd)});const e=Math.floor(Md.length/3),t=[];for(let n=r;n<e;n++)this.encodePickingColor(n,t),Md[3*n+0]=t[0],Md[3*n+1]=t[1],Md[3*n+2]=t[2]}e.value=Md.subarray(0,3*n)}_setModelAttributes(e,t){const n=this.getAttributeManager(),r=e.userData.excludeAttributes||{},i=n.getShaderAttributes(t,r);e.setAttributes(i)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t))return void this._disablePickingIndex(e);const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r,s=i&&t.attributes&&t.attributes[i.id];if(s&&s.value){const n=s.value,r=this.encodePickingColor(e);for(let e=0;e<t.length;e++){const t=i.getVertexOffset(e);n[t]===r[0]&&n[t+1]===r[1]&&n[t+2]===r[2]&&this._disablePickingIndex(e)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:n}=this.getAttributeManager().attributes,r=t||n;if(!r)return;const i=r.getVertexOffset(e),s=r.getVertexOffset(e+1);r.buffer.subData({data:new Uint8Array(s-i),offset:i})}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,n=e||t;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Md.buffer&&(n.value=Md.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){hl(!this.internalState),hl(Number.isFinite(this.props.coordinateSystem)),te("layer.initialize",this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Bd({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(q.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new Yh(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){te("layer.matched",this,this===e);const{state:t,internalState:n}=e;this!==e&&(this.internalState=n,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(te("layer.update",this,e),!e)return;const t=this.props,n=this.context,r=this.internalState,i=n.viewport,s=this._updateUniformTransition();r.propsInTransition=s,n.viewport=r.viewport||i,this.props=s;try{const e=this._getUpdateParams(),t=this.getModels();if(n.gl)this.updateState(e);else try{this.updateState(e)}catch(o){}for(const n of this.props.extensions)n.updateState.call(this,e,n);const r=this.getModels()[0]!==t[0];this._postUpdate(e,r)}finally{n.viewport=i,this.props=t,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){te("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer(e){let{moduleParameters:t=null,uniforms:n={},parameters:r={}}=e;this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:e}=this.props,i=e&&e(n)||[0,0];rs(s.gl,{polygonOffset:i}),is(s.gl,r,(()=>{const e={moduleParameters:t,uniforms:n,parameters:r,context:s};for(const t of this.props.extensions)t.draw.call(this,e,t);this.draw(e)}))}finally{this.props=i}}getChangeFlags(){var e;return null===(e=this.internalState)||void 0===e?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const r in e)if(e[r]){let n=!1;if("dataChanged"===r){const i=e[r],s=t[r];i&&Array.isArray(s)&&(t.dataChanged=Array.isArray(i)?s.concat(i):i,n=!0)}t[r]||(t[r]=e[r],n=!0),n&&te("layer.changeFlag",this,r,e)}const n=Boolean(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=n,t.somethingChanged=n||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const n=Zh(e,t);if(n.updateTriggersChanged)for(const i in n.updateTriggersChanged)n.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(n.transitionsChanged)for(const i in n.transitionsChanged){var r;this.internalState.uniformTransitions.add(i,t[i],e[i],null===(r=e.transitions)||void 0===r?void 0:r[i])}return this.setChangeFlags(n)}validateProps(){!function(e){const t=e[x];for(const n in t){const r=t[n],{validate:i}=r;if(i&&!i(e[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(e[n]))}}(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={pickingSelectedColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&"function"===typeof n&&(t.pickingHighlightColor=n(e)),this.setModuleParameters(t),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Jh(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:n,oldProps:r}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:i}=this.state;null===i||void 0===i||i.setInstanceCount(this.getNumInstances());const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=n;if(t||r.autoHighlight!==s||r.highlightedObjectIndex!==o||r.highlightColor!==a){const e={};s||(e.pickingSelectedColor=null),Array.isArray(a)&&(e.pickingHighlightColor=a),(t||o!==r.highlightedObjectIndex)&&(e.pickingSelectedColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setModuleParameters(e)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),r=!!n&&n.getNeedsRedraw(e);if(t=t||r,t)for(const i of this.props.extensions)i.onNeedsRedraw.call(this,i);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}g(Id,"defaultProps",Pd),g(Id,"layerName","Layer");const Rd={position:"absolute",zIndex:-1};function Od(e,t){if("function"===typeof e)return e(t);if(Array.isArray(e))return e.map((e=>Od(e,t)));if(Ld(e)){if(function(e){var t;return null===(t=e.props)||void 0===t?void 0:t.mapStyle}(e))return t.style=Rd,(0,h.cloneElement)(e,t);if(function(e){const t=e.type;return t&&t.deckGLViewProps}(e))return(0,h.cloneElement)(e,t)}return e}function Ld(e){return e&&"object"===typeof e&&"type"in e||!1}function Fd(e){if("function"===typeof e)return(0,h.createElement)(dl,{},e);if(Array.isArray(e))return e.map(Fd);if(Ld(e)){if(e.type===h.Fragment)return Fd(e.props.children);if(zu(e.type,dl))return e}return e}const kd={mixBlendMode:null};function Dd(e){e.redrawReason&&(e.deck._drawLayers(e.redrawReason),e.redrawReason=null)}const Nd=(0,h.forwardRef)(((e,t)=>{const[n,r]=(0,h.useState)(0),i=(0,h.useRef)({control:null,version:n,forceUpdate:()=>r((e=>e+1))}).current,s=(0,h.useRef)(null),o=(0,h.useRef)(null),a=(0,h.useMemo)((()=>function(e){let{children:t,layers:n=[],views:r=null}=e;const i=[],s=[],o={};return h.Children.forEach(Fd(t),(e=>{if(Ld(e)){const t=e.type;if(zu(t,Id)){const n=function(e,t){const n={},r=e.defaultProps||{};for(const i in t)r[i]!==t[i]&&(n[i]=t[i]);return new e(n)}(t,e.props);s.push(n)}else i.push(e);if(zu(t,dl)&&t!==dl&&e.props.id){const n=new t(e.props);o[n.id]=n}}else e&&i.push(e)})),Object.keys(o).length>0&&(Array.isArray(r)?r.forEach((e=>{o[e.id]=e})):r&&(o[r.id]=r),r=Object.values(o)),n=s.length>0?[...s,...n]:n,{layers:n,children:i,views:r}}(e)),[e.layers,e.views,e.children]);let l=!0;const c=t=>{var n;return l&&e.viewState?(i.viewStateUpdateRequested=t,null):(i.viewStateUpdateRequested=null,null===(n=e.onViewStateChange)||void 0===n?void 0:n.call(e,t))},u=t=>{var n;l?i.interactionStateUpdateRequested=t:(i.interactionStateUpdateRequested=null,null===(n=e.onInteractionStateChange)||void 0===n||n.call(e,t))},d=(0,h.useMemo)((()=>{const t={...e,style:null,width:"100%",height:"100%",parent:s.current,canvas:o.current,layers:a.layers,views:a.views,onViewStateChange:c,onInteractionStateChange:u};return delete t._customRender,i.deck&&i.deck.setProps(t),t}),[e]);(0,h.useEffect)((()=>{const t=e.Deck||Uu;return i.deck=function(e,t,n){const r=new t({...n,_customRender:t=>{e.redrawReason=t;const n=r.getViewports();e.lastRenderedViewports!==n?e.forceUpdate():Dd(e)}});return r}(i,t,{...d,parent:s.current,canvas:o.current}),()=>{var e;return null===(e=i.deck)||void 0===e?void 0:e.finalize()}}),[]),Gu((()=>{Dd(i);const{viewStateUpdateRequested:e,interactionStateUpdateRequested:t}=i;e&&c(e),t&&u(t)})),(0,h.useImperativeHandle)(t,(()=>function(e){return{get deck(){return e.deck},pickObject:t=>e.deck.pickObject(t),pickMultipleObjects:t=>e.deck.pickMultipleObjects(t),pickObjects:t=>e.deck.pickObjects(t)}}(i)),[]);const f=i.deck&&i.deck.isInitialized?i.deck.getViewports():void 0,{ContextProvider:p,width:g,height:m,id:v,style:b}=e,{containerStyle:y,canvasStyle:A}=(0,h.useMemo)((()=>function(e){let{width:t,height:n,style:r}=e;const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:n},s={left:0,top:0};if(r)for(const o in r)o in kd?s[o]=r[o]:i[o]=r[o];return{containerStyle:i,canvasStyle:s}}({width:g,height:m,style:b})),[g,m,b]);if(!i.viewStateUpdateRequested&&i.lastRenderedViewports===f||i.version!==n){i.lastRenderedViewports=f,i.version=n;const e=function(e){let{children:t,deck:n,ContextProvider:r}=e;const{viewManager:i}=n||{};if(!i||!i.views.length)return[];const s={},o=i.views[0].id;for(const a of t){let e=o,t=a;Ld(a)&&zu(a.type,dl)&&(e=a.props.id||o,t=a.props.children);const n=i.getViewport(e),r=i.getViewState(e);if(n){r.padding=n.padding;const{x:i,y:o,width:a,height:l}=n;t=Od(t,{x:i,y:o,width:a,height:l,viewport:n,viewState:r}),s[e]||(s[e]={viewport:n,children:[]}),s[e].children.push(t)}}return Object.keys(s).map((e=>{const{viewport:t,children:i}=s[e],{x:o,y:a,width:l,height:c}=t,u={position:"absolute",left:o,top:a,width:l,height:c},d="view-".concat(e),f=(0,h.createElement)("div",{key:d,id:d,style:u},...i);if(r){const i={viewport:t,container:n.canvas.offsetParent,eventManager:n.eventManager,onViewStateChange:t=>{t.viewId=e,n._onViewStateChange(t)}};return(0,h.createElement)(r,{key:d,value:i},f)}return f}))}({children:a.children,deck:i.deck,ContextProvider:p}),t=(0,h.createElement)("canvas",{key:"canvas",id:v||"deckgl-overlay",ref:o,style:A});i.control=(0,h.createElement)("div",{id:"".concat(v||"deckgl","-wrapper"),ref:s,style:y},[t,e])}return l=!1,i.control}));Nd.defaultProps=Uu.defaultProps;const jd=Nd,Ud=Math.PI/180;function Gd(e){let{height:t,focalDistance:n,orbitAxis:r,rotationX:i,rotationOrbit:s,zoom:o}=e;const a="Z"===r?[0,0,1]:[0,1,0],l="Z"===r?[0,-n,0]:[0,0,n],c=(new jn).lookAt({eye:l,up:a});c.rotateX(i*Ud),"Z"===r?c.rotateZ(s*Ud):c.rotateY(s*Ud);const u=Math.pow(2,o)/t;return c.scale(u),c}class zd extends Er{constructor(e){const{height:t,projectionMatrix:n,fovy:r=50,orbitAxis:i="Z",target:s=[0,0,0],rotationX:o=0,rotationOrbit:a=0,zoom:l=0}=e,c=n?n[5]/2:ur(r);super({...e,longitude:void 0,viewMatrix:Gd({height:t||1,focalDistance:c,orbitAxis:i,rotationX:o,rotationOrbit:a,zoom:l}),fovy:r,focalDistance:c,position:s,zoom:l}),g(this,"projectedCenter",void 0),this.projectedCenter=this.project(this.center)}unproject(e){let{topLeft:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[n,r,i=this.projectedCenter[2]]=e,s=t?r:this.height-r,[o,a,l]=dr([n,s,i],this.pixelUnprojectionMatrix);return[o,a,l]}panByPosition(e,t){const n=this.project(e),r=[this.width/2+n[0]-t[0],this.height/2+n[1]-t[1],this.projectedCenter[2]];return{target:this.unproject(r)}}}class Vd extends Fl{constructor(e){const{width:t,height:n,rotationX:r=0,rotationOrbit:i=0,target:s=[0,0,0],zoom:o=0,minRotationX:a=-90,maxRotationX:l=90,minZoom:c=-1/0,maxZoom:u=1/0,startPanPosition:h,startRotatePos:d,startRotationX:f,startRotationOrbit:p,startZoomPosition:m,startZoom:v}=e;super({width:t,height:n,rotationX:r,rotationOrbit:i,target:s,zoom:o,minRotationX:a,maxRotationX:l,minZoom:c,maxZoom:u},{startPanPosition:h,startRotatePos:d,startRotationX:f,startRotationOrbit:p,startZoomPosition:m,startZoom:v}),g(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart(e){let{pos:t}=e;return this._getUpdatedState({startPanPosition:this._unproject(t)})}pan(e){let{pos:t,startPosition:n}=e;const r=this.getState().startPanPosition||n;if(!r)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(r,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart(e){let{pos:t}=e;return this._getUpdatedState({startRotatePos:t,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate(e){let{pos:t,deltaAngleX:n=0,deltaAngleY:r=0}=e;const{startRotatePos:i,startRotationX:s,startRotationOrbit:o}=this.getState(),{width:a,height:l}=this.getViewportProps();if(!i||void 0===s||void 0===o)return this;let c;if(t){let e=(t[0]-i[0])/a;(s<-90||s>90)&&(e*=-1),c={rotationX:s+180*((t[1]-i[1])/l),rotationOrbit:o+180*e}}else c={rotationX:s+r,rotationOrbit:o+n};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),n={...this.getViewportProps()},{rotationOrbit:r}=n;return Math.abs(r-t.rotationOrbit)>180&&(n.rotationOrbit=r<0?r+360:r-360),n}zoomStart(e){let{pos:t}=e;return this._getUpdatedState({startZoomPosition:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom(e){let{pos:t,startPos:n,scale:r}=e,{startZoom:i,startZoomPosition:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(t)),!s)return this;const o=this._calculateNewZoom({scale:r,startZoom:i}),a=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...a.panByPosition(s,t)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([-e,0])}moveRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([e,0])}moveUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([0,-e])}moveDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([0,e])}rotateLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_calculateNewZoom(e){let{scale:t,startZoom:n}=e;const{maxZoom:r,minZoom:i}=this.getViewportProps();void 0===n&&(n=this.getViewportProps().zoom);return Ut(n+Math.log2(t),i,r)}_panFromCenter(e){const{width:t,height:n,target:r}=this.getViewportProps();return this.pan({startPosition:r,pos:[t/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:r,maxRotationX:i,minRotationX:s,rotationOrbit:o}=e;return e.zoom=Array.isArray(r)?[Ut(r[0],n,t),Ut(r[1],n,t)]:Ut(r,n,t),e.rotationX=Ut(e.rotationX,s,i),(o<-180||o>180)&&(e.rotationOrbit=function(e,t){const n=e%t;return n<0?t+n:n}(o+180,360)-180),e}}class Hd extends Ll{constructor(){super(...arguments),g(this,"ControllerState",Vd),g(this,"transition",{transitionDuration:300,transitionInterpolator:new El({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})})}}class Jd extends dl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.props.orbitAxis=e.orbitAxis||"Z"}get ViewportType(){return zd}get ControllerType(){return Hd}}g(Jd,"displayName","OrbitView");const Wd={name:"project32",dependencies:[tl],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},Xd={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1};const Kd={name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xd;const t={};if(void 0!==e.pickingSelectedColor)if(e.pickingSelectedColor){const n=e.pickingSelectedColor.slice(0,3);t.picking_uSelectedColorValid=1,t.picking_uSelectedColor=n}else t.picking_uSelectedColorValid=0;if(e.pickingHighlightColor){const n=Array.from(e.pickingHighlightColor,(e=>e/255));Number.isFinite(n[3])||(n[3]=1),t.picking_uHighlightColor=n}return void 0!==e.pickingActive&&(t.picking_uActive=Boolean(e.pickingActive),t.picking_uAttribute=Boolean(e.pickingAttribute)),t}},Qd={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:#decl":"\nuniform bool picking_uAttribute;\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...Kd},Yd="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",Zd={lightSources:{}};function qd(){let{color:e=[0,0,0],intensity:t=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.map((e=>e*t/255))}const $d={name:"lights",vs:Yd,fs:Yd,getUniforms:function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zd;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},function(e){let{ambientLight:t,pointLights:n=[],directionalLights:r=[]}=e;const i={};return i["lighting_uAmbientLight.color"]=t?qd(t):[0,0,0],n.forEach(((e,t)=>{i["lighting_uPointLight[".concat(t,"].color")]=qd(e),i["lighting_uPointLight[".concat(t,"].position")]=e.position,i["lighting_uPointLight[".concat(t,"].attenuation")]=e.attenuation||[1,0,0]})),i.lighting_uPointLightCount=n.length,r.forEach(((e,t)=>{i["lighting_uDirectionalLight[".concat(t,"].color")]=qd(e),i["lighting_uDirectionalLight[".concat(t,"].direction")]=e.direction})),i.lighting_uDirectionalLightCount=r.length,i}({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const n={pointLights:[],directionalLights:[]};for(const e of t.lights||[])switch(e.type){case"ambient":n.ambientLight=e;break;case"directional":n.directionalLights.push(e);break;case"point":n.pointLights.push(e)}return e({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}},ef={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[$d]};class tf{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t}=e;this.id=t||_s(this.constructor.name),this.display=!0,this.position=new hn,this.rotation=new hn,this.scale=new hn(1,1,1),this.matrix=new jn,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(e){return vs(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return vs(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return vs(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?this.matrix.copy(e):this.matrix=e}setMatrixComponents(e){let{position:t,rotation:n,scale:r,update:i=!0}=e;return t&&this.setPosition(t),n&&this.setRotation(n),r&&this.setScale(r),i&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(n),this}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{position:t,rotation:n,scale:r}=e;return t&&this.setPosition(t),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,t){vs(e),t=t||this.matrix;const n=new jn(e).multiplyRight(t),r=n.invert(),i=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class nf extends tf{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;hi.assert(t.every((e=>e instanceof tf)),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)Array.isArray(r)?this.add(...r):this.children.push(r);return this}remove(e){const t=this.children,n=t.indexOf(e);return n>-1&&t.splice(n,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach((e=>e.delete())),this.removeAll(),super.delete()}getBounds(){const e=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse(((t,n)=>{let{worldMatrix:r}=n;const i=t.getBounds();if(!i)return;const[s,o]=i,a=new hn(s).add(o).divide([2,2,2]);r.transformAsPoint(a,a);const l=new hn(o).subtract(s).divide([2,2,2]);r.transformAsVector(l,l);for(let c=0;c<8;c++){const t=new hn(1&c?-1:1,2&c?-1:1,4&c?-1:1).multiply(l).add(a);for(let n=0;n<3;n++)e[0][n]=Math.min(e[0][n],t[n]),e[1][n]=Math.max(e[1][n],t[n])}})),Number.isFinite(e[0][0])?e:null}traverse(e){let{worldMatrix:t=new jn}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new jn(t).multiplyRight(this.matrix);for(const r of this.children)r instanceof nf?r.traverse(e,{worldMatrix:n}):e(r,{worldMatrix:n})}}let rf;class sf extends Kt{static get ZERO(){return rf||(rf=new sf(0,0,0,0),Object.freeze(rf)),rf}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(-0,-0,-0,-0),jt(e)&&1===arguments.length?this.copy(e):(Dt.debug&&(Jt(e),Jt(t),Jt(n),Jt(r)),this[0]=e,this[1]=t,this[2]=n,this[3]=r)}set(e,t,n,r){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Dt.debug&&(Jt(e.x),Jt(e.y),Jt(e.z),Jt(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Jt(e)}get w(){return this[3]}set w(e){this[3]=Jt(e)}transform(e){return tn(this,this,e),this.check()}transformByMatrix3(e){return ln(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const r=t[0],i=t[1];e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e[2]=t[2],e[3]=t[3]}(this,this,e),this.check()}transformByQuaternion(e){return rn(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}function of(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=n[0],f=n[1],p=n[2],g=n[3],m=n[4],v=n[5],b=n[6],y=n[7],A=n[8];return e[0]=d*r+f*o+p*c,e[1]=d*i+f*a+p*u,e[2]=d*s+f*l+p*h,e[3]=g*r+m*o+v*c,e[4]=g*i+m*a+v*u,e[5]=g*s+m*l+v*h,e[6]=b*r+y*o+A*c,e[7]=b*i+y*a+A*u,e[8]=b*s+y*l+A*h,e}function af(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function lf(){var e=new Yt(4);return Yt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function cf(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function uf(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],a=n[0],l=n[1],c=n[2],u=n[3];return e[0]=r*u+o*a+i*c-s*l,e[1]=i*u+o*l+s*a-r*c,e[2]=s*u+o*c+r*l-i*a,e[3]=o*u-r*a-i*l-s*c,e}function hf(e,t,n,r){var i,s,o,a,l,c=t[0],u=t[1],h=t[2],d=t[3],f=n[0],p=n[1],g=n[2],m=n[3];return(s=c*f+u*p+h*g+d*m)<0&&(s=-s,f=-f,p=-p,g=-g,m=-m),1-s>Qt?(i=Math.acos(s),o=Math.sin(i),a=Math.sin((1-r)*i)/o,l=Math.sin(r*i)/o):(a=1-r,l=r),e[0]=a*c+l*f,e[1]=a*u+l*p,e[2]=a*h+l*g,e[3]=a*d+l*m,e}function df(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*s+s]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*s+o]-t[3*o+s])*n,e[s]=(t[3*s+i]+t[3*i+s])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}var ff=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},pf=Mn,gf=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},mf=function(e,t,n,r){var i=t[0],s=t[1],o=t[2],a=t[3];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=o+r*(n[2]-o),e[3]=a+r*(n[3]-a),e},vf=Pn,bf=In,yf=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=n*n+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),e[0]=n*o,e[1]=r*o,e[2]=i*o,e[3]=s*o,e};var Af=function(){var e=Zt(),t=qt(1,0,0),n=qt(0,1,0);return function(r,i,s){var o=$t(i,s);return o<-.999999?(en(e,t,i),on(e)<1e-6&&en(e,n,i),function(e,t){var n=t[0],r=t[1],i=t[2],s=n*n+r*r+i*i;s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s}(e,e),cf(r,e,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(en(e,i,s),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+o,yf(r,r))}}();(function(){var e=lf(),t=lf()})(),function(){var e=function(){var e=new Yt(9);return Yt!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}()}();const _f=[0,0,0,1];const wf={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Cf={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Ef(e){if(!e._animation){const t=Cf[e.componentType],n=wf[e.type],r=n*e.count,{buffer:i,byteOffset:s}=e.bufferView.data,o=new t(i,s+(e.byteOffset||0),r);if(1===n)e._animation=Array.from(o);else{const t=[];for(let e=0;e<o.length;e+=n)t.push(Array.from(o.slice(e,e+n)));e._animation=t}}return e._animation}const Bf=new jn;const xf=new class extends Ht{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,n,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,n,r){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return df(this,e),this.check()}fromAxisRotation(e,t){return cf(this,e,t),this.check()}identity(){var e;return(e=this)[0]=0,e[1]=0,e[2]=0,e[3]=1,this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Jt(e)}get y(){return this[1]}set y(e){this[1]=Jt(e)}get z(){return this[2]}set z(e){this[2]=Jt(e)}get w(){return this[3]}set w(e){this[3]=Jt(e)}len(){return vf(this)}lengthSquared(){return bf(this)}dot(e){return gf(this,e)}rotationTo(e,t){return Af(this,e,t),this.check()}add(e){return ff(this,this,e),this.check()}calculateW(){return function(e,t){var n=t[0],r=t[1],i=t[2];e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i))}(this,this),this.check()}conjugate(){return function(e,t){e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3]}(this,this),this.check()}invert(){return function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=n*n+r*r+i*i+s*s,a=o?1/o:0;e[0]=-n*a,e[1]=-r*a,e[2]=-i*a,e[3]=s*a}(this,this),this.check()}lerp(e,t,n){return void 0===n?this.lerp(this,e,t):(mf(this,e,t,n),this.check())}multiplyRight(e){return uf(this,this,e),this.check()}multiplyLeft(e){return uf(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l+o*a,e[1]=i*l+s*a,e[2]=s*l-i*a,e[3]=o*l-r*a}(this,this,e),this.check()}rotateY(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l-s*a,e[1]=i*l+o*a,e[2]=s*l+r*a,e[3]=o*l-i*a}(this,this,e),this.check()}rotateZ(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l+i*a,e[1]=i*l-r*a,e[2]=s*l+o*a,e[3]=o*l-s*a}(this,this,e),this.check()}scale(e){return pf(this,this,e),this.check()}slerp(e,t,n){let r,i,s;switch(arguments.length){case 1:({start:r=_f,target:i,ratio:s}=e);break;case 2:r=this,i=e,s=t;break;default:r=e,i=t,s=n}return hf(this,r,i,s),this.check()}transformVector4(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sf;return function(e,t,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=t[0],l=t[1],c=t[2],u=i*c-s*l,h=s*a-r*c,d=r*l-i*a;u+=u,h+=h,d+=d,e[0]=a+o*u+i*d-s*h,e[1]=l+o*h+s*u-r*d,e[2]=c+o*d+r*h-i*u,e[3]=t[3]}(t,e,this),Wt(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}};function Sf(e,t,n,r){let{input:i,interpolation:s,output:o}=t;const a=e%i[i.length-1],l=i.findIndex((e=>e>=a)),c=Math.max(0,l-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:hi.warn("Bad animation path ".concat(r))()}vs(n[r].length===o[c].length);const u=i[c],h=i[l];switch(s){case"STEP":!function(e,t,n){for(let r=0;r<n.length;r++)e[t][r]=n[r]}(n,r,o[c]);break;case"LINEAR":if(h>u){const e=(a-u)/(h-u);!function(e,t,n,r,i){if("rotation"===t){xf.slerp({start:n,target:r,ratio:i});for(let n=0;n<xf.length;n++)e[t][n]=xf[n]}else for(let s=0;s<n.length;s++)e[t][s]=i*r[s]+(1-i)*n[s]}(n,r,o[c],o[l],e)}break;case"CUBICSPLINE":if(h>u){const e=(a-u)/(h-u),t=h-u;!function(e,t,n){let{p0:r,outTangent0:i,inTangent1:s,p1:o,tDiff:a,ratio:l}=n;for(let c=0;c<e[t].length;c++){const n=i[c]*a,u=s[c]*a;e[t][c]=(2*Math.pow(l,3)-3*Math.pow(l,2)+1)*r[c]+(Math.pow(l,3)-2*Math.pow(l,2)+l)*n+(-2*Math.pow(l,3)+3*Math.pow(l,2))*o[c]+(Math.pow(l,3)-Math.pow(l,2))*u}}(n,r,{p0:o[3*c+1],outTangent0:o[3*c+2],inTangent1:o[3*l+0],p1:o[3*l+1],tDiff:t,ratio:e})}break;default:hi.warn("Interpolation ".concat(s," not supported"))()}}class Tf{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const t=(e/1e3-this.startTime)*this.speed;this.channels.forEach((e=>{let{sampler:n,target:r,path:i}=e;Sf(t,n,r,i),function(e,t){if(t.matrix.identity(),e.translation&&t.matrix.translate(e.translation),e.rotation){const n=Bf.fromQuaternion(e.rotation);t.matrix.multiplyRight(n)}e.scale&&t.matrix.scale(e.scale)}(r,r._node)}))}}class Mf{constructor(e){this.animations=e.animations.map(((t,n)=>{const r=t.name||"Animation-".concat(n),i=t.samplers.map((t=>{let{input:n,interpolation:r="LINEAR",output:i}=t;return{input:Ef(e.accessors[n]),interpolation:r,output:Ef(e.accessors[i])}})),s=t.channels.map((t=>{let{sampler:n,target:r}=t;return{sampler:i[n],target:e.nodes[r.node],path:r.path}}));return new Tf({name:r,channels:s})}))}animate(e){this.setTime(e)}setTime(e){this.animations.forEach((t=>t.animate(e)))}getAnimations(){return this.animations}}class Pf extends tf{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof jh?(this.model=e,this._setModelNodeProps(t)):this.model=new jh(e,t),this.bounds=null,this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach((e=>e.delete())),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(e){this.model.setProps(e)}}class If{constructor(e,t){let{attributes:n,material:r,pbrDebug:i,imageBasedLightingEnvironment:s,lights:o,useTangents:a}=t;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},Mo(e,So)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),i&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(n.NORMAL,"HAS_NORMALS"),this.defineIfPresent(n.TANGENT&&a,"HAS_TANGENTS"),this.defineIfPresent(n.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(i,"PBR_DEBUG"),r&&this.parseMaterial(r)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},i=e.texture.source.image;let s,o={};i.compressed?(s=i,o={[this.gl.TEXTURE_MIN_FILTER]:i.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):s={data:i};const a=new Js(this.gl,{id:e.name||e.id,parameters:{...r,...o},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...s});this.uniforms[t]=a,this.defineIfPresent(n,n),this.generatedTextures.push(a)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:n=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,n]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(hi.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach((e=>e.delete()))}}function Rf(e,t){return gi(e)?"#version 300 es\n".concat(t):t}const Of={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Lf={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class Ff{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.options=Object.assign({},Lf,t)}instantiate(e){this.gltf=e;return(e.scenes||[]).map((e=>this.createScene(e)))}createAnimator(){return Array.isArray(this.gltf.animations)?new Mf(this.gltf):null}createScene(e){const t=(e.nodes||[]).map((e=>this.createNode(e)));return new nf({id:e.name||e.id,children:t})}createNode(e){if(!e._node){const t=(e.children||[]).map((e=>this.createNode(e)));e.mesh&&t.push(this.createMesh(e.mesh));const n=new nf({id:e.name||e.id,children:t});if(e.matrix)n.setMatrix(e.matrix);else{if(n.matrix.identity(),e.translation&&n.matrix.translate(e.translation),e.rotation){const t=(new jn).fromQuaternion(e.rotation);n.matrix.multiplyRight(t)}e.scale&&n.matrix.scale(e.scale)}e._node=n}return e._node}createMesh(e){if(!e._mesh){const t=(e.primitives||[]).map(((t,n)=>this.createPrimitive(t,n,e))),n=new nf({id:e.name||e.id,children:t});e._mesh=n}return e._mesh}getVertexCount(e){hi.warn("getVertexCount() not found")()}createPrimitive(e,t,n){const r=function(e,t){const{id:n,drawMode:r,vertexCount:i,attributes:s,modelOptions:o}=t,a=new If(e,t);hi.info(4,"createGLTFModel defines: ",a.defines)();const l=[];l.push(...a.generatedTextures),l.push(...Object.values(s).map((e=>e.buffer)));const c=new Pf(e,{id:n,drawMode:r,vertexCount:i,modules:[ef],parameters:a.parameters,vs:Rf(e,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:Rf(e,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l,...o,defines:{...a.defines,...o.defines}});return c.setProps({attributes:s}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:e.name||"".concat(n.name||n.id,"-primitive-").concat(t),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options));return r.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],r}createAttributes(e,t){const n={};return Object.keys(e).forEach((t=>{n[t]=this.createAccessor(e[t],this.createBuffer(e[t],this.gl.ARRAY_BUFFER))})),t&&(n.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),hi.info(4,"glTF Attributes",{attributes:e,indices:t,generated:n})(),n}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:n}=e;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[t]||(n.lumaBuffers[t]=new Ds(this.gl,{id:"from-".concat(n.id),data:n.data||e.value,target:t})),n.lumaBuffers[t]}createAccessor(e,t){return new Os({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:Of[e.type]})}createSampler(e){return e}needsPOT(){return!1}}const kf=null,Df=null,Nf=null,jf=null,Uf="3.4.15",Gf={};async function zf(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n&&(t=function(e,t,n){if(e.startsWith("http"))return e;const r=n.modules||{};if(r[e])return r[e];if(!We)return"modules/".concat(t,"/dist/libs/").concat(e);if(n.CDN)return Ve(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(t,"@").concat(Uf,"/dist/libs/").concat(e);if(Xe)return"../src/libs/".concat(e);return"modules/".concat(t,"/src/libs/").concat(e)}(t,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})),Gf[t]=Gf[t]||async function(t){if(t.endsWith("wasm")){const e=await fetch(t);return await e.arrayBuffer()}if(!We)try{return e&&Nf&&await Nf(t)}catch{return null}if(Xe)return importScripts(t);const n=await fetch(t);return function(e,t){if(!We)return jf&&jf(e,t);if(Xe)return eval.call(Je,e),null;const n=document.createElement("script");n.id=t;try{n.appendChild(document.createTextNode(e))}catch(r){n.text=e}return document.body.appendChild(n),null}(await n.text(),t)}(t),await Gf[t]}const Vf="3.4.15",Hf="https://unpkg.com/@loaders.gl/textures@".concat(Vf,"/dist/libs/basis_encoder.wasm"),Jf="https://unpkg.com/@loaders.gl/textures@".concat(Vf,"/dist/libs/basis_encoder.js");let Wf,Xf;async function Kf(e){const t=e.modules||{};return t.basis?t.basis:(Wf=Wf||async function(e){let t=null,n=null;return[t,n]=await Promise.all([await zf("basis_transcoder.js","textures",e),await zf("basis_transcoder.wasm","textures",e)]),t=t||globalThis.BASIS,await function(e,t){const n={};t&&(n.wasmBinary=t);return new Promise((t=>{e(n).then((e=>{const{BasisFile:n,initializeBasis:r}=e;r(),t({BasisFile:n})}))}))}(t,n)}(e),await Wf)}async function Qf(e){const t=e.modules||{};return t.basisEncoder?t.basisEncoder:(Xf=Xf||async function(e){let t=null,n=null;return[t,n]=await Promise.all([await zf(Jf,"textures",e),await zf(Hf,"textures",e)]),t=t||globalThis.BASIS,await function(e,t){const n={};t&&(n.wasmBinary=t);return new Promise((t=>{e(n).then((e=>{const{BasisFile:n,KTX2File:r,initializeBasis:i,BasisEncoder:s}=e;i(),t({BasisFile:n,KTX2File:r,BasisEncoder:s})}))}))}(t,n)}(e),await Xf)}const Yf=33776,Zf=33779,qf=35840,$f=35842,ep=36196,tp=37808,np=["","WEBKIT_","MOZ_"],rp={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let ip=null;function sp(e){if(!ip){e=e||function(){try{return document.createElement("canvas").getContext("webgl")}catch(e){return null}}()||void 0,ip=new Set;for(const t of np)for(const n in rp)if(e&&e.getExtension("".concat(t).concat(n))){const e=rp[n];ip.add(e)}}return ip}new Uint8Array([0]);var op,ap,lp,cp,up,hp,dp,fp;!function(e){e[e.NONE=0]="NONE",e[e.BASISLZ=1]="BASISLZ",e[e.ZSTD=2]="ZSTD",e[e.ZLIB=3]="ZLIB"}(op||(op={})),function(e){e[e.BASICFORMAT=0]="BASICFORMAT"}(ap||(ap={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.ETC1S=163]="ETC1S",e[e.UASTC=166]="UASTC"}(lp||(lp={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.SRGB=1]="SRGB"}(cp||(cp={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LINEAR=1]="LINEAR",e[e.SRGB=2]="SRGB",e[e.ITU=3]="ITU",e[e.NTSC=4]="NTSC",e[e.SLOG=5]="SLOG",e[e.SLOG2=6]="SLOG2"}(up||(up={})),function(e){e[e.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",e[e.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(hp||(hp={})),function(e){e[e.RGB=0]="RGB",e[e.RRR=3]="RRR",e[e.GGG=4]="GGG",e[e.AAA=15]="AAA"}(dp||(dp={})),function(e){e[e.RGB=0]="RGB",e[e.RGBA=3]="RGBA",e[e.RRR=4]="RRR",e[e.RRRG=5]="RRRG"}(fp||(fp={}));const pp=[171,75,84,88,32,50,48,187,13,10,26,10];const gp={etc1:{basisFormat:0,compressed:!0,format:ep},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:Yf},bc3:{basisFormat:3,compressed:!0,format:Zf},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:qf},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:$f},"astc-4x4":{basisFormat:10,compressed:!0,format:tp},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};function mp(e,t,n){const r=new e(new Uint8Array(t));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");const e=r.getNumImages(),t=[];for(let i=0;i<e;i++){const e=r.getNumLevels(i),s=[];for(let t=0;t<e;t++)s.push(vp(r,i,t,n));t.push(s)}return t}finally{r.close(),r.delete()}}function vp(e,t,n,r){const i=e.getImageWidth(t,n),s=e.getImageHeight(t,n),o=e.getHasAlpha(),{compressed:a,format:l,basisFormat:c}=Ap(r,o),u=e.getImageTranscodedSizeInBytes(t,n,c),h=new Uint8Array(u);if(!e.transcodeImage(h,t,n,c,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:s,data:h,compressed:a,format:l,hasAlpha:o}}function bp(e,t,n){const r=new e(new Uint8Array(t));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");const e=r.getLevels(),t=[];for(let i=0;i<e;i++){t.push(yp(r,i,n));break}return[t]}finally{r.close(),r.delete()}}function yp(e,t,n){const{alphaFlag:r,height:i,width:s}=e.getImageLevelInfo(t,0,0),{compressed:o,format:a,basisFormat:l}=Ap(n,r),c=e.getImageTranscodedSizeInBytes(t,0,0,l),u=new Uint8Array(c);if(!e.transcodeImage(u,t,0,0,l,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:i,data:u,compressed:o,levelSize:c,hasAlpha:r,format:a}}function Ap(e,t){let n=e&&e.basis&&e.basis.format;return"auto"===n&&(n=_p()),"object"===typeof n&&(n=t?n.alpha:n.noAlpha),n=n.toLowerCase(),gp[n]}function _p(){const e=sp();return e.has("astc")?"astc-4x4":e.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:e.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:e.has("etc1")?"etc1":e.has("etc2")?"etc2":"rgb565"}const wp={name:"Basis",id:We?"basis":"basis-nodejs",module:"textures",version:"3.4.15",worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},Cp={...wp,parse:async function(e,t){if("auto"===t.basis.containerFormat){if(function(e){const t=new Uint8Array(e);return!(t.byteLength<pp.length||t[0]!==pp[0]||t[1]!==pp[1]||t[2]!==pp[2]||t[3]!==pp[3]||t[4]!==pp[4]||t[5]!==pp[5]||t[6]!==pp[6]||t[7]!==pp[7]||t[8]!==pp[8]||t[9]!==pp[9]||t[10]!==pp[10]||t[11]!==pp[11])}(e)){return bp((await Qf(t)).KTX2File,e,t)}const{BasisFile:n}=await Kf(t);return mp(n,e,t)}if("encoder"===t.basis.module){const n=await Qf(t);return"ktx2"===t.basis.containerFormat?bp(n.KTX2File,e,t):mp(n.BasisFile,e,t)}{const{BasisFile:n}=await Kf(t);return mp(n,e,t)}}};function Ep(e,t,n){if(e.byteLength<=t+n)return"";const r=new DataView(e);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(t+s));return i}function Bp(e){try{return JSON.parse(e)}catch(t){throw new Error('Failed to parse JSON from data starting with "'.concat(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"===typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return Ep(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer)return Ep(e,0,t);return""}(e),'"'))}}function xp(e,t){if(!e)throw new Error(t||"assert failed: gltf")}function Sp(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;const n=t.baseUri||t.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(e));return n.substr(0,n.lastIndexOf("/")+1)+e}function Tp(e,t,n){const r=e.bufferViews[n];xp(r);const i=t[r.buffer];xp(i);const s=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,s,r.byteLength)}function Mp(e,t){return ge(e>=0),ge(t>0),e+(t-1)&~(t-1)}function Pp(e,t,n){let r;if(e instanceof ArrayBuffer)r=new Uint8Array(e);else{const t=e.byteOffset,n=e.byteLength;r=new Uint8Array(e.buffer||e.arrayBuffer,t,n)}return t.set(r,n),n+Mp(r.byteLength,4)}const Ip=["SCALAR","VEC2","VEC3","VEC4"],Rp=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],Op=new Map(Rp),Lp={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Fp={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},kp={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Dp(e){return Ip[e-1]||Ip[0]}function Np(e){const t=Op.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function jp(e,t){const n=kp[e.componentType],r=Lp[e.type],i=Fp[e.componentType],s=e.count*r,o=e.count*r*i;return xp(o>=0&&o<=t.byteLength),{ArrayType:n,length:s,byteLength:o}}const Up={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class Gp{constructor(e){g(this,"gltf",void 0),g(this,"sourceBuffers",void 0),g(this,"byteLength",void 0),this.gltf=e||{json:{...Up},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){const t=this.getUsedExtensions().find((t=>t===e)),n=this.json.extensions||{};return t?n[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find((t=>t===e))?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"===typeof t)return t;const n=this.json[e]&&this.json[e][t];if(!n)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(t,"]"));return n}getTypedArrayForBufferView(e){const t=(e=this.getBufferView(e)).buffer,n=this.gltf.buffers[t];xp(n);const r=(e.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,{ArrayType:r,length:i}=jp(e,t);return new r(n,t.byteOffset+e.byteOffset,i)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,r=t.byteOffset||0;return new Uint8Array(n,r,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,n){return e.extensions=e.extensions||{},e.extensions[t]=n,this.registerUsedExtension(t),this}setObjectExtension(e,t,n){(e.extensions||{})[t]=n}removeObjectExtension(e,t){const n=e.extensions||{},r=n[t];return delete n[t],r}addExtension(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return xp(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return xp(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((t=>t===e))||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((t=>t===e))||this.json.extensionsRequired.push(e)}removeExtension(e){if(!this.getExtension(e))return;this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);const t=this.json.extensionsRemoved;t.includes(e)||t.push(e)}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:n}=e;this.json.nodes=this.json.nodes||[];const r={mesh:t};return n&&(r.matrix=n),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:n,material:r,mode:i=4}=e,s={primitives:[{attributes:this._addAttributes(t),mode:i}]};if(n){const e=this._addIndices(n);s.primitives[0].indices=e}return Number.isFinite(r)&&(s.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(s),this.json.meshes.length-1}addPointCloud(e){const t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1}addImage(e,t){const n=Gc(e),r=t||(null===n||void 0===n?void 0:n.mimeType),i={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1}addBufferView(e){const t=e.byteLength;xp(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const n={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=Mp(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}addAccessor(e,t){const n={bufferView:e,type:Dp(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:3};const n=this.addBufferView(e);let r={min:t.min,max:t.max};r.min&&r.max||(r=this._getAccessorMinMax(e,t.size));const i={size:t.size,componentType:Np(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(n,Object.assign(i,t))}addTexture(e){const{imageIndex:t}=e,n={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const n=this.byteLength,r=new ArrayBuffer(n),i=new Uint8Array(r);let s=0;for(const o of this.sourceBuffers||[])s=Pp(o,i,s);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=n:this.json.buffers=[{byteLength:n}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,t){let n=!0;for(;n;){const r=e.indexOf(t);r>-1?e.splice(r,1):n=!1}}_addAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={};for(const n in e){const r=e[n],i=this._getGltfAttributeName(n),s=this.addBinaryBuffer(r.value,r);t[i]=s}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const n={min:null,max:null};if(e.length<t)return n;n.min=[],n.max=[];const r=e.subarray(0,t);for(const i of r)n.min.push(i),n.max.push(i);for(let i=t;i<e.length;i+=t)for(let r=0;r<t;r++)n.min[0+r]=Math.min(n.min[0+r],e[i+r]),n.max[0+r]=Math.max(n.max[0+r],e[i+r]);return n}}const zp="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",Vp="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",Hp=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),Jp=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),Wp={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Xp={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};let Kp;async function Qp(){return Kp||(Kp=async function(){let e=zp;WebAssembly.validate(Hp)&&(e=Vp,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const t=await WebAssembly.instantiate(function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;++r){const n=e.charCodeAt(r);t[r]=n>96?n-71:n>64?n-65:n>47?n+4:n>46?63:62}let n=0;for(let r=0;r<e.length;++r)t[n++]=t[r]<60?Jp[t[r]]:64*(t[r]-60)+t[++r];return t.buffer.slice(0,n)}(e),{});return await t.instance.exports.__wasm_call_ctors(),t.instance}()),Kp}function Yp(e,t,n,r,i,s,o){const a=e.exports.sbrk,l=r+3&-4,c=a(l*i),u=a(s.length),h=new Uint8Array(e.exports.memory.buffer);h.set(s,u);const d=t(c,r,i,u,s.length);if(0===d&&o&&o(c,l,i),n.set(h.subarray(c,c+r*i)),a(c-a(0)),0!==d)throw new Error("Malformed buffer data: ".concat(d))}const Zp="EXT_meshopt_compression",qp=Zp;async function $p(e,t){var n;const r=new Gp(e);if(null===t||void 0===t||null===(n=t.gltf)||void 0===n||!n.decompressMeshes)return;const i=[];for(const s of e.json.bufferViews||[])i.push(eg(r,s));await Promise.all(i),r.removeExtension(Zp)}async function eg(e,t){const n=e.getObjectExtension(t,Zp);if(n){const{byteOffset:r=0,byteLength:i=0,byteStride:s,count:o,mode:a,filter:l="NONE",buffer:c}=n,u=e.gltf.buffers[c],h=new Uint8Array(u.arrayBuffer,u.byteOffset+r,i),d=new Uint8Array(e.gltf.buffers[t.buffer].arrayBuffer,t.byteOffset,t.byteLength);return await async function(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NONE";const o=await Qp();Yp(o,o.exports[Xp[i]],e,t,n,r,o.exports[Wp[s||"NONE"]])}(d,o,s,h,a,l),d}return null}const tg={};function ng(e){if(void 0===tg[e]){const t=Ie?function(e){switch(e){case"image/avif":case"image/webp":return function(e){try{const t=document.createElement("canvas");return 0===t.toDataURL(e).indexOf("data:".concat(e))}catch{return!1}}(e);default:return!0}}(e):rg(e);tg[e]=t}return tg[e]}function rg(e){const t=["image/png","image/jpeg","image/gif"],{_parseImageNode:n,_imageFormatsNode:r=t}=globalThis;return Boolean(n)&&r.includes(e)}const ig="EXT_texture_webp",sg=ig;function og(e,t){const n=new Gp(e);if(!ng("image/webp")){if(n.getRequiredExtensions().includes(ig))throw new Error("gltf: Required extension ".concat(ig," not supported by browser"));return}const{json:r}=n;for(const i of r.textures||[]){const e=n.getObjectExtension(i,ig);e&&(i.source=e.source),n.removeObjectExtension(i,ig)}n.removeExtension(ig)}const ag="KHR_texture_basisu",lg=ag;function cg(e,t){const n=new Gp(e),{json:r}=n;for(const i of r.textures||[]){const e=n.getObjectExtension(i,ag);e&&(i.source=e.source),n.removeObjectExtension(i,ag)}n.removeExtension(ag)}const ug="3.4.15",hg={draco:{decoderType:"object"===typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},dg={name:"Draco",id:We?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:ug,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:hg};class fg{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map;g(this,"name",void 0),g(this,"type",void 0),g(this,"nullable",void 0),g(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=n,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new fg(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let pg,gg,mg,vg,bg,yg,Ag,_g,wg=function(e){return e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth",e}({});class Cg{static isNull(e){return e&&e.typeId===wg.Null}static isInt(e){return e&&e.typeId===wg.Int}static isFloat(e){return e&&e.typeId===wg.Float}static isBinary(e){return e&&e.typeId===wg.Binary}static isUtf8(e){return e&&e.typeId===wg.Utf8}static isBool(e){return e&&e.typeId===wg.Bool}static isDecimal(e){return e&&e.typeId===wg.Decimal}static isDate(e){return e&&e.typeId===wg.Date}static isTime(e){return e&&e.typeId===wg.Time}static isTimestamp(e){return e&&e.typeId===wg.Timestamp}static isInterval(e){return e&&e.typeId===wg.Interval}static isList(e){return e&&e.typeId===wg.List}static isStruct(e){return e&&e.typeId===wg.Struct}static isUnion(e){return e&&e.typeId===wg.Union}static isFixedSizeBinary(e){return e&&e.typeId===wg.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===wg.FixedSizeList}static isMap(e){return e&&e.typeId===wg.Map}static isDictionary(e){return e&&e.typeId===wg.Dictionary}get typeId(){return wg.NONE}compareTo(e){return this===e}}Symbol.toStringTag;Symbol.toStringTag;pg=Symbol.toStringTag;class Eg extends Cg{constructor(e,t){super(),g(this,"isSigned",void 0),g(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return wg.Int}get[pg](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class Bg extends Eg{constructor(){super(!0,8)}}class xg extends Eg{constructor(){super(!0,16)}}class Sg extends Eg{constructor(){super(!0,32)}}class Tg extends Eg{constructor(){super(!1,8)}}class Mg extends Eg{constructor(){super(!1,16)}}class Pg extends Eg{constructor(){super(!1,32)}}const Ig=32,Rg=64;gg=Symbol.toStringTag;class Og extends Cg{constructor(e){super(),g(this,"precision",void 0),this.precision=e}get typeId(){return wg.Float}get[gg](){return"Float"}toString(){return"Float".concat(this.precision)}}class Lg extends Og{constructor(){super(Ig)}}class Fg extends Og{constructor(){super(Rg)}}Symbol.toStringTag;Symbol.toStringTag;mg=Symbol.toStringTag;vg=Symbol.toStringTag;bg=Symbol.toStringTag;yg=Symbol.toStringTag;Ag=Symbol.toStringTag;class kg extends Cg{constructor(e,t){super(),g(this,"listSize",void 0),g(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return wg.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[Ag](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}_g=Symbol.toStringTag;function Dg(e,t,n){const r=function(e){switch(e.constructor){case Int8Array:return new Bg;case Uint8Array:return new Tg;case Int16Array:return new xg;case Uint16Array:return new Mg;case Int32Array:return new Sg;case Uint32Array:return new Pg;case Float32Array:return new Lg;case Float64Array:return new Fg;default:throw new Error("array type not supported")}}(t.value),i=n||function(e){const t=new Map;"byteOffset"in e&&t.set("byteOffset",e.byteOffset.toString(10));"byteStride"in e&&t.set("byteStride",e.byteStride.toString(10));"normalized"in e&&t.set("normalized",e.normalized.toString());return t}(t);return new fg(e,new kg(t.size,new fg("value",r)),!1,i)}class Ng{constructor(e,t){g(this,"fields",void 0),g(this,"metadata",void 0),function(e,t){if(!e)throw new Error(t||"loader assertion failed.")}(Array.isArray(e)),function(e){const t={};for(const n of e)t[n.name]&&console.warn("Schema: duplicated field name",n.name,n),t[n.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata)return!1;if(this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(){const e=Object.create(null);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n)e[s]=!0;const i=this.fields.filter((t=>e[t.name]));return new Ng(i,this.metadata)}selectAt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.map((e=>this.fields[e])).filter(Boolean);return new Ng(r,this.metadata)}assign(e){let t,n=this.metadata;if(e instanceof Ng){const r=e;t=r.fields,n=jg(jg(new Map,this.metadata),r.metadata)}else t=e;const r=Object.create(null);for(const s of this.fields)r[s.name]=s;for(const s of t)r[s.name]=s;const i=Object.values(r);return new Ng(i,n)}}function jg(e,t){return new Map([...e||new Map,...t||new Map])}function Ug(e,t,n){return Dg(e,t,n?Gg(n.metadata):void 0)}function Gg(e){const t=new Map;for(const n in e)t.set("".concat(n,".string"),JSON.stringify(e[n]));return t}const zg={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Vg={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class Hg{constructor(e){g(this,"draco",void 0),g(this,"decoder",void 0),g(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const r=this.decoder.GetEncodedGeometryType(n),i=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let e;switch(r){case this.draco.TRIANGULAR_MESH:e=this.decoder.DecodeBufferToMesh(n,i);break;case this.draco.POINT_CLOUD:e=this.decoder.DecodeBufferToPointCloud(n,i);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!e.ok()||!i.ptr){const t="DRACO decompression failed: ".concat(e.error_msg());throw new Error(t)}const s=this._getDracoLoaderData(i,r,t),o=this._getMeshData(i,s,t),a=function(e){let t=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,o=-1/0;const a=e.POSITION?e.POSITION.value:[],l=a&&a.length;for(let c=0;c<l;c+=3){const e=a[c],l=a[c+1],u=a[c+2];t=e<t?e:t,n=l<n?l:n,r=u<r?u:r,i=e>i?e:i,s=l>s?l:s,o=u>o?u:o}return[[t,n,r],[i,s,o]]}(o.attributes),l=function(e,t,n){const r=Gg(t.metadata),i=[],s=function(e){const t={};for(const n in e){const r=e[n];t[r.name||"undefined"]=r}return t}(t.attributes);for(const o in e){const t=Ug(o,e[o],s[o]);i.push(t)}if(n){const e=Ug("indices",n);i.push(e)}return new Ng(i,r)}(o.attributes,s,o.indices);return{loader:"draco",loaderData:s,header:{vertexCount:i.num_points(),boundingBox:a},...o,schema:l}}finally{this.draco.destroy(n),i&&this.draco.destroy(i)}}_getDracoLoaderData(e,t,n){const r=this._getTopLevelMetadata(e),i=this._getDracoAttributes(e,n);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:i}}_getDracoAttributes(e,t){const n={};for(let r=0;r<e.num_attributes();r++){const i=this.decoder.GetAttribute(e,r),s=this._getAttributeMetadata(e,r);n[i.unique_id()]={unique_id:i.unique_id(),attribute_type:i.attribute_type(),data_type:i.data_type(),num_components:i.num_components(),byte_offset:i.byte_offset(),byte_stride:i.byte_stride(),normalized:i.normalized(),attribute_index:r,metadata:s};const o=this._getQuantizationTransform(i,t);o&&(n[i.unique_id()].quantization_transform=o);const a=this._getOctahedronTransform(i,t);a&&(n[i.unique_id()].octahedron_transform=a)}return n}_getMeshData(e,t,n){const r=this._getMeshAttributes(t,e,n);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");return e instanceof this.draco.Mesh?"triangle-strip"===n.topology?{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}}:{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}:{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,t,n){const r={};for(const i of Object.values(e.attributes)){const e=this._deduceAttributeName(i,n);i.name=e;const{value:s,size:o}=this._getAttributeValues(t,i);r[e]={value:s,size:o,byteOffset:i.byte_offset,byteStride:i.byte_stride,normalized:i.normalized}}return r}_getTriangleListIndices(e){const t=3*e.num_faces(),n=4*t,r=this.draco._malloc(n);try{return this.decoder.GetTrianglesUInt32Array(e,n,r),new Uint32Array(this.draco.HEAPF32.buffer,r,t).slice()}finally{this.draco._free(r)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(e){const t=e.size(),n=new Int32Array(t);for(let r=0;r<t;r++)n[r]=e.GetValue(r);return n}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const n=Vg[t.data_type],r=t.num_components,i=e.num_points()*r,s=i*n.BYTES_PER_ELEMENT,o=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32;default:return e.DT_INVALID}}(this.draco,n);let a;const l=this.draco._malloc(s);try{const r=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,r,o,s,l),a=new n(this.draco.HEAPF32.buffer,l,i).slice()}finally{this.draco._free(l)}return{value:a,size:r}}_deduceAttributeName(e,t){const n=e.unique_id;for(const[s,o]of Object.entries(t.extraAttributes||{}))if(o===n)return s;const r=e.attribute_type;for(const s in zg){if(this.draco[s]===r)return zg[s]}const i=t.attributeNameEntry||"name";return e.metadata[i]?e.metadata[i].string:"CUSTOM_ATTRIBUTE_".concat(n)}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const n=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(n)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},n=this.metadataQuerier.NumEntries(e);for(let r=0;r<n;r++){const n=this.metadataQuerier.GetEntryName(e,r);t[n]=this._getDracoMetadataField(e,n)}return t}_getDracoMetadataField(e,t){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,n);const r=function(e){const t=e.size(),n=new Int32Array(t);for(let r=0;r<t;r++)n[r]=e.GetValue(r);return n}(n);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:r}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:n=[]}=e,r=[...t,...n];for(const i of r)this.decoder.SkipAttributeTransform(this.draco[i])}_getQuantizationTransform(e,t){const{quantizedAttributes:n=[]}=t,r=e.attribute_type();if(n.map((e=>this.decoder[e])).includes(r)){const t=new this.draco.AttributeQuantizationTransform;try{if(t.InitFromAttribute(e))return{quantization_bits:t.quantization_bits(),range:t.range(),min_values:new Float32Array([1,2,3]).map((e=>t.min_value(e)))}}finally{this.draco.destroy(t)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:n=[]}=t,r=e.attribute_type();if(n.map((e=>this.decoder[e])).includes(r)){const t=new this.draco.AttributeQuantizationTransform;try{if(t.InitFromAttribute(e))return{quantization_bits:t.quantization_bits()}}finally{this.draco.destroy(t)}}return null}}const Jg="https://www.gstatic.com/draco/versioned/decoders/".concat("1.5.5"),Wg="".concat(Jg,"/draco_decoder.js"),Xg="".concat(Jg,"/draco_wasm_wrapper.js"),Kg="".concat(Jg,"/draco_decoder.wasm");"https://raw.githubusercontent.com/google/draco/".concat("1.4.1","/javascript/draco_encoder.js");let Qg;async function Yg(e){const t=e.modules||{};return Qg=t.draco3d?Qg||t.draco3d.createDecoderModule({}).then((e=>({draco:e}))):Qg||async function(e){let t,n;if("js"===(e.draco&&e.draco.decoderType))t=await zf(Wg,"draco",e);else[t,n]=await Promise.all([await zf(Xg,"draco",e),await zf(Kg,"draco",e)]);return t=t||globalThis.DracoDecoderModule,await function(e,t){const n={};t&&(n.wasmBinary=t);return new Promise((t=>{e({...n,onModuleLoaded:e=>t({draco:e})})}))}(t,n)}(e),await Qg}const Zg={...dg,parse:async function(e,t){const{draco:n}=await Yg(t),r=new Hg(n);try{return r.parseSync(e,null===t||void 0===t?void 0:t.draco)}finally{r.destroy()}}};function qg(e){const{buffer:t,size:n,count:r}=function(e){let t=e,n=1,r=0;e&&e.value&&(t=e.value,n=e.size||1);t&&(ArrayBuffer.isView(t)||(t=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;if(Array.isArray(e))return new t(e);if(n&&!(e instanceof t))return new t(e);return e}(t,Float32Array)),r=t.length/n);return{buffer:t,size:n,count:r}}(e);return{value:t,size:n,byteOffset:0,count:r,type:Dp(n),componentType:Np(t)}}const $g="KHR_draco_mesh_compression",em=$g;function tm(e,t,n){const r=new Gp(e);for(const i of om(r))r.getObjectExtension(i,$g)}async function nm(e,t,n){var r;if(null===t||void 0===t||null===(r=t.gltf)||void 0===r||!r.decompressMeshes)return;const i=new Gp(e),s=[];for(const o of om(i))i.getObjectExtension(o,$g)&&s.push(im(i,o,t,n));await Promise.all(s),i.removeExtension($g)}function rm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new Gp(e);for(const r of n.json.meshes||[])sm(r,t),n.addRequiredExtension($g)}async function im(e,t,n,r){const i=e.getObjectExtension(t,$g);if(!i)return;const s=e.getTypedArrayForBufferView(i.bufferView),o=ut(s.buffer,s.byteOffset),{parse:a}=r,l={...n};delete l["3d-tiles"];const c=await a(o,Zg,l,r),u=function(e){const t={};for(const n in e){const r=e[n];if("indices"!==n){const e=qg(r);t[n]=e}}return t}(c.attributes);for(const[h,d]of Object.entries(u))if(h in t.attributes){const n=t.attributes[h],r=e.getAccessor(n);null!==r&&void 0!==r&&r.min&&null!==r&&void 0!==r&&r.max&&(d.min=r.min,d.max=r.max)}t.attributes=u,c.indices&&(t.indices=qg(c.indices)),function(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}(t)}function sm(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:e}),a=null===s||void 0===s||null===(n=s.parseSync)||void 0===n?void 0:n.call(s,{attributes:e}),l=i._addFauxAttributes(a.attributes),c=i.addBufferView(o);return{primitives:[{attributes:l,mode:r,extensions:{[$g]:{bufferView:c,attributes:l}}}]}}function*om(e){for(const t of e.json.meshes||[])for(const e of t.primitives)yield e}var am;!function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"}(am||(am={}));const lm=Object.freeze([1,0,0,0,1,0,0,0,1]);class cm extends bn{static get IDENTITY(){return function(){hm||(hm=new cm,Object.freeze(hm));return hm}()}static get ZERO(){return function(){um||(um=new cm([0,0,0,0,0,0,0,0,0]),Object.freeze(um));return um}()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return am}constructor(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(lm)}fromObject(e){return this.check()}fromQuaternion(e){return function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,h=r*a,d=i*o,f=i*a,p=i*l,g=s*o,m=s*a,v=s*l;e[0]=1-h-p,e[3]=u-v,e[6]=d+m,e[1]=u+v,e[4]=1-c-p,e[7]=f-g,e[2]=d-m,e[5]=f+g,e[8]=1-c-h}(this,e),this.check()}set(e,t,n,r,i,s,o,a,l){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=l,this.check()}setRowMajor(e,t,n,r,i,s,o,a,l){return this[0]=e,this[1]=r,this[2]=o,this[3]=t,this[4]=i,this[5]=a,this[6]=n,this[7]=s,this[8]=l,this.check()}determinant(){return function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*(c*s-o*l)+n*(-c*i+o*a)+r*(l*i-s*a)}(this)}transpose(){return function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8]}(this,this),this.check()}invert(){return function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=u*o-a*c,d=-u*s+a*l,f=c*s-o*l,p=n*h+r*d+i*f;p&&(p=1/p,e[0]=h*p,e[1]=(-u*r+i*c)*p,e[2]=(a*r-i*o)*p,e[3]=d*p,e[4]=(u*n-i*l)*p,e[5]=(-a*n+i*s)*p,e[6]=f*p,e[7]=(-c*n+r*l)*p,e[8]=(o*n-r*s)*p)}(this,this),this.check()}multiplyLeft(e){return of(this,e,this),this.check()}multiplyRight(e){return of(this,this,e),this.check()}rotate(e){return function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=Math.sin(n),f=Math.cos(n);e[0]=f*r+d*o,e[1]=f*i+d*a,e[2]=f*s+d*l,e[3]=f*o-d*r,e[4]=f*a-d*i,e[5]=f*l-d*s,e[6]=c,e[7]=u,e[8]=h}(this,this,e),this.check()}scale(e){return Array.isArray(e)?af(this,this,e):af(this,this,[e,e]),this.check()}translate(e){return function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=n[0],f=n[1];e[0]=r,e[1]=i,e[2]=s,e[3]=o,e[4]=a,e[5]=l,e[6]=d*r+f*o+c,e[7]=d*i+f*a+u,e[8]=d*s+f*l+h}(this,this,e),this.check()}transform(e,t){let n;switch(e.length){case 2:n=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e}(t||[-0,-0],e,this);break;case 3:n=nn(t||[-0,-0,-0],e,this);break;case 4:n=ln(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Wt(n,e.length),n}transformVector(e,t){return this.transform(e,t)}transformVector2(e,t){return this.transform(e,t)}transformVector3(e,t){return this.transform(e,t)}}let um,hm;const dm={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},fm={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4};const pm="KHR_texture_transform",gm=pm,mm=new hn,vm=new cm,bm=new cm;async function ym(e,t){if(!new Gp(e).getExtension(pm))return;const n=e.json.materials||[];for(let r=0;r<n.length;r++)Am(r,e)}function Am(e,t){var n,r,i;const s=[],o=null===(n=t.json.materials)||void 0===n?void 0:n[e],a=null===o||void 0===o||null===(r=o.pbrMetallicRoughness)||void 0===r?void 0:r.baseColorTexture;a&&_m(t,e,a,s);const l=null===o||void 0===o?void 0:o.emissiveTexture;l&&_m(t,e,l,s);const c=null===o||void 0===o?void 0:o.normalTexture;c&&_m(t,e,c,s);const u=null===o||void 0===o?void 0:o.occlusionTexture;u&&_m(t,e,u,s);const h=null===o||void 0===o||null===(i=o.pbrMetallicRoughness)||void 0===i?void 0:i.metallicRoughnessTexture;h&&_m(t,e,h,s)}function _m(e,t,n,r){const i=function(e,t){var n;const r=null===(n=e.extensions)||void 0===n?void 0:n[pm],{texCoord:i=0}=e,{texCoord:s=i}=r,o=-1!==t.findIndex((e=>{let[t,n]=e;return t===i&&n===s}));if(!o){const n=function(e){const{offset:t=[0,0],rotation:n=0,scale:r=[1,1]}=e,i=(new cm).set(1,0,0,0,1,0,t[0],t[1],1),s=vm.set(Math.cos(n),Math.sin(n),0,-Math.sin(n),Math.cos(n),0,0,0,1),o=bm.set(r[0],0,0,0,r[1],0,0,0,1);return i.multiplyRight(s).multiplyRight(o)}(r);return i!==s&&(e.texCoord=s),t.push([i,s]),{originalTexCoord:i,texCoord:s,matrix:n}}return null}(n,r);if(!i)return;const s=e.json.meshes||[];for(const o of s)for(const n of o.primitives){const r=n.material;Number.isFinite(r)&&t===r&&wm(e,n,i)}}function wm(e,t,n){const{originalTexCoord:r,texCoord:i,matrix:s}=n,o=t.attributes["TEXCOORD_".concat(r)];if(Number.isFinite(o)){var a;const n=null===(a=e.json.accessors)||void 0===a?void 0:a[o];if(n&&n.bufferView){var l;const o=null===(l=e.json.bufferViews)||void 0===l?void 0:l[n.bufferView];if(o){const{arrayBuffer:a,byteOffset:l}=e.buffers[o.buffer],c=(l||0)+(n.byteOffset||0)+(o.byteOffset||0),{ArrayType:u,length:h}=jp(n,o),d=fm[n.componentType],f=dm[n.type],p=o.byteStride||d*f,g=new Float32Array(h);for(let e=0;e<n.count;e++){const t=new u(a,c+e*p,2);mm.set(t[0],t[1],1),mm.transformByMatrix3(s),g.set([mm[0],mm[1]],e*f)}r===i?function(e,t,n,r){e.componentType=5126,n.push({arrayBuffer:r.buffer,byteOffset:0,byteLength:r.buffer.byteLength}),t.buffer=n.length-1,t.byteLength=r.buffer.byteLength,t.byteOffset=0,delete t.byteStride}(n,o,e.buffers,g):function(e,t,n,r,i){r.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const s=r.json.bufferViews;if(!s)return;s.push({buffer:r.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const o=r.json.accessors;if(!o)return;o.push({bufferView:(null===s||void 0===s?void 0:s.length)-1,byteOffset:0,componentType:5126,count:t.count,type:"VEC2"}),n.attributes["TEXCOORD_".concat(e)]=o.length-1}(i,n,t,e,g)}}}}const Cm="KHR_lights_punctual",Em=Cm;async function Bm(e){const t=new Gp(e),{json:n}=t,r=t.getExtension(Cm);r&&(t.json.lights=r.lights,t.removeExtension(Cm));for(const i of n.nodes||[]){const e=t.getObjectExtension(i,Cm);e&&(i.light=e.light),t.removeObjectExtension(i,Cm)}}async function xm(e){const t=new Gp(e),{json:n}=t;if(n.lights){const e=t.addExtension(Cm);xp(!e.lights),e.lights=n.lights,delete n.lights}if(t.json.lights){for(const e of t.json.lights){const n=e.node;t.addObjectExtension(n,Cm,e)}delete t.json.lights}}const Sm="KHR_materials_unlit",Tm=Sm;async function Mm(e){const t=new Gp(e),{json:n}=t;for(const r of n.materials||[]){r.extensions&&r.extensions.KHR_materials_unlit&&(r.unlit=!0),t.removeObjectExtension(r,Sm)}t.removeExtension(Sm)}function Pm(e){const t=new Gp(e),{json:n}=t;if(t.materials)for(const r of n.materials||[])r.unlit&&(delete r.unlit,t.addObjectExtension(r,Sm,{}),t.addExtension(Sm))}const Im="KHR_techniques_webgl",Rm=Im;async function Om(e){const t=new Gp(e),{json:n}=t,r=t.getExtension(Im);if(r){const e=function(e,t){const{programs:n=[],shaders:r=[],techniques:i=[]}=e,s=new TextDecoder;return r.forEach((e=>{if(!Number.isFinite(e.bufferView))throw new Error("KHR_techniques_webgl: no shader code");e.code=s.decode(t.getTypedArrayForBufferView(e.bufferView))})),n.forEach((e=>{e.fragmentShader=r[e.fragmentShader],e.vertexShader=r[e.vertexShader]})),i.forEach((e=>{e.program=n[e.program]})),i}(r,t);for(const r of n.materials||[]){const n=t.getObjectExtension(r,Im);n&&(r.technique=Object.assign({},n,e[n.technique]),r.technique.values=Fm(r.technique,t)),t.removeObjectExtension(r,Im)}t.removeExtension(Im)}}async function Lm(e,t){}function Fm(e,t){const n=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach((t=>{e.uniforms[t].value&&!(t in n)&&(n[t]=e.uniforms[t].value)})),Object.keys(n).forEach((e=>{"object"===typeof n[e]&&void 0!==n[e].index&&(n[e].texture=t.getTexture(n[e].index))})),n}const km="EXT_feature_metadata",Dm=km;async function Nm(e){!function(e){var t;const n=e.getExtension(km),r=null===n||void 0===n||null===(t=n.schema)||void 0===t?void 0:t.classes,i=null===n||void 0===n?void 0:n.featureTables;(null===n||void 0===n?void 0:n.featureTextures)&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.');if(r&&i)for(const s in r){const t=r[s],n=Gm(i,s);n&&jm(e,n,t)}}(new Gp(e))}function jm(e,t,n){for(const i in n.properties){var r;const s=n.properties[i],o=null===t||void 0===t||null===(r=t.properties)||void 0===r?void 0:r[i],a=t.count;if(o){const t=Um(e,s,a,o);o.data=t}}}function Um(e,t,n,r){const i=r.bufferView;let s=e.getTypedArrayForBufferView(i);switch(t.type){case"STRING":{const t=r.stringOffsetBufferView;s=function(e,t,n){const r=[],i=new TextDecoder("utf8");let s=0;const o=4;for(let a=0;a<n;a++){const n=t[(a+1)*o]-t[a*o],l=e.subarray(s,n+s),c=i.decode(l);r.push(c),s+=n}return r}(s,e.getTypedArrayForBufferView(t),n);break}}return s}function Gm(e,t){for(const n in e){const r=e[n];if(r.class===t)return r}return null}const zm=[t,r,i,s,a,l,c,o,u];function Vm(e,t){var n;const r=(null===t||void 0===t||null===(n=t.gltf)||void 0===n?void 0:n.excludeExtensions)||{};return!(e in r&&!r[e])}const Hm="KHR_binary_glTF";const Jm={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},Wm={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class Xm{constructor(){g(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),g(this,"json",void 0)}normalize(e,t){this.json=e.json;const n=e.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version ".concat(n.asset.version))}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(e){const t=new Gp(e),{json:n}=t;for(const r of n.images||[]){const e=t.getObjectExtension(r,Hm);e&&Object.assign(r,e),t.removeObjectExtension(r,Hm)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,t.removeExtension(Hm)}(e),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in Jm)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const n=e[t];if(n&&!Array.isArray(n)){e[t]=[];for(const r in n){const i=n[r];i.id=i.id||r;const s=e[t].length;e[t].push(i),this.idToIndexMap[t][r]=s}}}_convertObjectIdsToArrayIndices(e){for(const t in Jm)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:e,indices:n,material:r}=t;for(const t in e)e[t]=this._convertIdToIndex(e[t],"accessor");n&&(t.indices=this._convertIdToIndex(n,"accessor")),r&&(t.material=this._convertIdToIndex(r,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map((e=>this._convertIdToIndex(e,"node")))),e.meshes&&(e.meshes=e.meshes.map((e=>this._convertIdToIndex(e,"mesh"))))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map((e=>this._convertIdToIndex(e,"node"))))}_convertIdsToIndices(e,t){e[t]||(console.warn("gltf v1: json doesn't contain attribute ".concat(t)),e[t]=[]);for(const n of e[t])for(const e in n){const t=n[e],r=this._convertIdToIndex(t,e);n[e]=r}}_convertIdToIndex(e,t){const n=Wm[t];if(n in this.idToIndexMap){const r=this.idToIndexMap[n][e];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve ".concat(t," with id ").concat(e));return r}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const i of e.materials){var t,n,r;i.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const s=(null===(t=i.values)||void 0===t?void 0:t.tex)||(null===(n=i.values)||void 0===n?void 0:n.texture2d_0)||(null===(r=i.values)||void 0===r?void 0:r.diffuseTex),o=e.textures.findIndex((e=>e.id===s));-1!==o&&(i.pbrMetallicRoughness.baseColorTexture={index:o})}}}const Km={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Qm={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Ym=10240,Zm=10241,qm=10242,$m=10243,ev=10497,tv=9729,nv=9986,rv={magFilter:Ym,minFilter:Zm,wrapS:qm,wrapT:$m},iv={[Ym]:tv,[Zm]:nv,[qm]:ev,[$m]:ev};class sv{constructor(){g(this,"baseUri",""),g(this,"json",{}),g(this,"buffers",[]),g(this,"images",[])}postProcess(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{json:n,buffers:r=[],images:i=[],baseUri:s=""}=e;return xp(n),this.baseUri=s,this.json=n,this.buffers=r,this.images=i,this._resolveTree(this.json,t),this.json}_resolveTree(e){e.bufferViews&&(e.bufferViews=e.bufferViews.map(((e,t)=>this._resolveBufferView(e,t)))),e.images&&(e.images=e.images.map(((e,t)=>this._resolveImage(e,t)))),e.samplers&&(e.samplers=e.samplers.map(((e,t)=>this._resolveSampler(e,t)))),e.textures&&(e.textures=e.textures.map(((e,t)=>this._resolveTexture(e,t)))),e.accessors&&(e.accessors=e.accessors.map(((e,t)=>this._resolveAccessor(e,t)))),e.materials&&(e.materials=e.materials.map(((e,t)=>this._resolveMaterial(e,t)))),e.meshes&&(e.meshes=e.meshes.map(((e,t)=>this._resolveMesh(e,t)))),e.nodes&&(e.nodes=e.nodes.map(((e,t)=>this._resolveNode(e,t)))),e.skins&&(e.skins=e.skins.map(((e,t)=>this._resolveSkin(e,t)))),e.scenes&&(e.scenes=e.scenes.map(((e,t)=>this._resolveScene(e,t)))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"===typeof t)return t;const n=this.json[e]&&this.json[e][t];return n||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),n}_resolveScene(e,t){return e.id=e.id||"scene-".concat(t),e.nodes=(e.nodes||[]).map((e=>this.getNode(e))),e}_resolveNode(e,t){return e.id=e.id||"node-".concat(t),e.children&&(e.children=e.children.map((e=>this.getNode(e)))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce(((e,t)=>{const n=this.getMesh(t);return e.id=n.id,e.primitives=e.primitives.concat(n.primitives),e}),{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||"skin-".concat(t),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||"mesh-".concat(t),e.primitives&&(e.primitives=e.primitives.map((e=>{const t=(e={...e}).attributes;e.attributes={};for(const n in t)e.attributes[n]=this.getAccessor(t[n]);return void 0!==e.indices&&(e.indices=this.getAccessor(e.indices)),void 0!==e.material&&(e.material=this.getMaterial(e.material)),e}))),e}_resolveMaterial(e,t){if(e.id=e.id||"material-".concat(t),e.normalTexture&&(e.normalTexture={...e.normalTexture},e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture={...e.occlustionTexture},e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture={...e.emmisiveTexture},e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness={...e.pbrMetallicRoughness};const t=e.pbrMetallicRoughness;t.baseColorTexture&&(t.baseColorTexture={...t.baseColorTexture},t.baseColorTexture.texture=this.getTexture(t.baseColorTexture.index)),t.metallicRoughnessTexture&&(t.metallicRoughnessTexture={...t.metallicRoughnessTexture},t.metallicRoughnessTexture.texture=this.getTexture(t.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){var n,r;if(e.id=e.id||"accessor-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=(n=e.componentType,Qm[n]),e.components=(r=e.type,Km[r]),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const t=e.bufferView.buffer,{ArrayType:n,byteLength:r}=jp(e,e.bufferView),i=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+t.byteOffset;let s=t.arrayBuffer.slice(i,i+r);e.bufferView.byteStride&&(s=this._getValueFromInterleavedBuffer(t,i,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new n(s)}return e}_getValueFromInterleavedBuffer(e,t,n,r,i){const s=new Uint8Array(i*r);for(let o=0;o<i;o++){const i=t+o*n;s.set(new Uint8Array(e.arrayBuffer.slice(i,i+r)),o*r)}return s.buffer}_resolveTexture(e,t){return e.id=e.id||"texture-".concat(t),e.sampler="sampler"in e?this.getSampler(e.sampler):iv,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||"sampler-".concat(t),e.parameters={};for(const n in e){const t=this._enumSamplerParameter(n);void 0!==t&&(e.parameters[t]=e[n])}return e}_enumSamplerParameter(e){return rv[e]}_resolveImage(e,t){e.id=e.id||"image-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const n=this.images[t];return n&&(e.image=n),e}_resolveBufferView(e,t){const n=e.buffer,r={id:"bufferView-".concat(t),...e,buffer:this.buffers[n]},i=this.buffers[n].arrayBuffer;let s=this.buffers[n].byteOffset||0;return"byteOffset"in e&&(s+=e.byteOffset),r.data=new Uint8Array(i,s,e.byteLength),r}_resolveCamera(e,t){return e.id=e.id||"camera-".concat(t),e.perspective,e.orthographic,e}}const ov=1735152710,av=1313821514,lv=5130562,cv=!0;function uv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=new DataView(t),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(String.fromCharCode(e.getUint8(t+0))).concat(String.fromCharCode(e.getUint8(t+1))).concat(String.fromCharCode(e.getUint8(t+2))).concat(String.fromCharCode(e.getUint8(t+3)))}(i,n+0),o=i.getUint32(n+4,cv),a=i.getUint32(n+8,cv);switch(Object.assign(e,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),n+=12,e.version){case 1:return function(e,t,n){ge(e.header.byteLength>20);const r=t.getUint32(n+0,cv),i=t.getUint32(n+4,cv);return n+=8,ge(0===i),hv(e,t,n,r),n+=r,n+=dv(e,t,n,e.header.byteLength),n}(e,i,n);case 2:return function(e,t,n,r){return ge(e.header.byteLength>20),function(e,t,n,r){for(;n+8<=e.header.byteLength;){const i=t.getUint32(n+0,cv),s=t.getUint32(n+4,cv);switch(n+=8,s){case av:hv(e,t,n,i);break;case lv:dv(e,t,n,i);break;case 0:r.strict||hv(e,t,n,i);break;case 1:r.strict||dv(e,t,n,i)}n+=Mp(i,4)}}(e,t,n,r),n+e.header.byteLength}(e,i,n,r={});default:throw new Error("Invalid GLB version ".concat(e.version,". Only supports v1 and v2."))}}function hv(e,t,n,r){const i=new Uint8Array(t.buffer,n,r),s=new TextDecoder("utf8").decode(i);return e.json=JSON.parse(s),Mp(r,4)}function dv(e,t,n,r){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:t.buffer}),Mp(r,4)}async function fv(e,t){var n,r,i,s;let o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;!function(e,t,n,r){r.uri&&(e.baseUri=r.uri);if(t instanceof ArrayBuffer&&!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new DataView(e),{magic:i=ov}=n,s=r.getUint32(t,!1);return s===i||s===ov}(t,n,r)){t=(new TextDecoder).decode(t)}if("string"===typeof t)e.json=Bp(t);else if(t instanceof ArrayBuffer){const i={};n=uv(i,t,n,r.glb),xp("glTF"===i.type,"Invalid GLB magic string ".concat(i.type)),e._glb=i,e.json=i.json}else xp(!1,"GLTF: must be ArrayBuffer or string");const i=e.json.buffers||[];if(e.buffers=new Array(i.length).fill(null),e._glb&&e._glb.header.hasBinChunk){const{binChunks:t}=e._glb;e.buffers[0]={arrayBuffer:t[0].arrayBuffer,byteOffset:t[0].byteOffset,byteLength:t[0].byteLength}}const s=e.json.images||[];e.images=new Array(s.length).fill({})}(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(new Xm).normalize(e,t)}(e,{normalize:null===o||void 0===o||null===(n=o.gltf)||void 0===n?void 0:n.normalize}),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=zm.filter((e=>Vm(e.name,t)));for(const s of r){var i;null===(i=s.preprocess)||void 0===i||i.call(s,e,t,n)}}(e,o,a);const l=[];if(null!==o&&void 0!==o&&null!==(r=o.gltf)&&void 0!==r&&r.loadBuffers&&e.json.buffers&&await async function(e,t,n){const r=e.json.buffers||[];for(let o=0;o<r.length;++o){const a=r[o];if(a.uri){var i,s;const{fetch:r}=n;xp(r);const l=Sp(a.uri,t),c=await(null===n||void 0===n||null===(i=n.fetch)||void 0===i?void 0:i.call(n,l)),u=await(null===c||void 0===c||null===(s=c.arrayBuffer)||void 0===s?void 0:s.call(c));e.buffers[o]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete a.uri}else null===e.buffers[o]&&(e.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}(e,o,a),null!==o&&void 0!==o&&null!==(i=o.gltf)&&void 0!==i&&i.loadImages){const t=async function(e,t,n){const r=function(e){const t=new Set,n=e.json.textures||[];for(const r of n)void 0!==r.source&&t.add(r.source);return Array.from(t).sort()}(e),i=e.json.images||[],s=[];for(const o of r)s.push(pv(e,i[o],o,t,n));return await Promise.all(s)}(e,o,a);l.push(t)}const c=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=zm.filter((e=>Vm(e.name,t)));for(const s of r){var i;await(null===(i=s.decode)||void 0===i?void 0:i.call(s,e,t,n))}}(e,o,a);return l.push(c),await Promise.all(l),null!==o&&void 0!==o&&null!==(s=o.gltf)&&void 0!==s&&s.postProcess?function(e,t){return(new sv).postProcess(e,t)}(e,o):e}async function pv(e,t,n,r,i){const{fetch:s,parse:o}=i;let a;if(t.uri&&!t.hasOwnProperty("bufferView")){const e=Sp(t.uri,r),n=await s(e);a=await n.arrayBuffer(),t.bufferView={data:a}}if(Number.isFinite(t.bufferView)){const n=Tp(e.json,e.buffers,t.bufferView);a=ut(n.buffer,n.byteOffset,n.byteLength)}xp(a,"glTF image has no data");let l=await o(a,[Vc,Cp],{mimeType:t.mimeType,basis:r.basis||{format:_p()}},i);l&&l[0]&&(l={compressed:!0,mipmaps:!1,width:l[0].width,height:l[0].height,data:l[0]}),e.images=e.images||[],e.images[n]=l}const gv={name:"glTF",id:"gltf",module:"gltf",version:"3.4.15",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;t={...gv.options,...t},t.gltf={...gv.options.gltf,...t.gltf};const{byteOffset:r=0}=t;return await fv({},e,r,t,n)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};async function mv(e){const t=[];return e.scenes.forEach((e=>{e.traverse((e=>{Object.values(e.model.getUniforms()).forEach((e=>{!1===e.loaded&&t.push(e)}))}))})),await async function(e){for(;e();)await new Promise((e=>requestAnimationFrame(e)))}((()=>t.some((e=>!e.loaded))))}const vv=Math.PI/180,bv=new Float32Array(16),yv=new Float32Array(12);function Av(e,t,n){const r=t[0]*vv,i=t[1]*vv,s=t[2]*vv,o=Math.sin(s),a=Math.sin(r),l=Math.sin(i),c=Math.cos(s),u=Math.cos(r),h=Math.cos(i),d=n[0],f=n[1],p=n[2];e[0]=d*h*u,e[1]=d*l*u,e[2]=d*-a,e[3]=f*(-l*c+h*a*o),e[4]=f*(h*c+l*a*o),e[5]=f*u*o,e[6]=p*(l*o+h*a*c),e[7]=p*(-h*o+l*a*c),e[8]=p*u*c}function _v(e){return e[0]=e[0],e[1]=e[1],e[2]=e[2],e[3]=e[4],e[4]=e[5],e[5]=e[6],e[6]=e[8],e[7]=e[9],e[8]=e[10],e[9]=e[12],e[10]=e[13],e[11]=e[14],e.subarray(0,12)}const wv={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(e,t){let{startRow:n,endRow:r}=t;const{data:i,getOrientation:s,getScale:o,getTranslation:a,getTransformMatrix:l}=this.props,c=Array.isArray(l),u=c&&16===l.length,h=Array.isArray(o),d=Array.isArray(s),f=Array.isArray(a),p=u||!c&&Boolean(l(i[0]));e.constant=p?u:d&&h&&f;const g=e.value;if(e.constant){let t;if(p)bv.set(l),t=_v(bv);else{t=yv;Av(t,s,o),t.set(a,9)}e.value=new Float32Array(t)}else{let t=n*e.size;const{iterable:c,objectInfo:m}=Qu(i,n,r);for(const e of c){let n;if(m.index++,p)bv.set(u?l:l(e,m)),n=_v(bv);else{n=yv;Av(n,d?s:s(e,m),h?o:o(e,m)),n.set(f?a:a(e,m),9)}g[t++]=n[0],g[t++]=n[1],g[t++]=n[2],g[t++]=n[3],g[t++]=n[4],g[t++]=n[5],g[t++]=n[6],g[t++]=n[7],g[t++]=n[8],g[t++]=n[9],g[t++]=n[10],g[t++]=n[11]}}}};function Cv(e,t){return t===mr.CARTESIAN||t===mr.METER_OFFSETS||t===mr.DEFAULT&&!e.isGeospatial}const Ev=[255,255,255,255],Bv={scenegraph:{type:"object",value:null,async:!0},getScene:e=>e&&e.scenes?"object"===typeof e.scene?e.scene:e.scenes[e.scene||0]:e,getAnimator:e=>e&&e.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:Ev},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[gv]};class xv extends Id{constructor(){super(...arguments),g(this,"state",void 0)}getShaders(){const e=[Wd,Qd];return"pbr"===this.props._lighting&&e.push(ef),super.getShaders({vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  vec3 normal = vec3(0.0, 0.0, 1.0);\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;\n    #endif\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    geometry.normal = project_normal(normal);\n    geometry.worldPosition += pos;\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n    geometry.normal = project_normal(normal);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n    #ifdef HAS_NORMALS\n      pbr_vNormal = geometry.normal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:e})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:Ev,transition:!0},instanceModelMatrix:wv})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e;t.scenegraph!==n.scenegraph?this._updateScenegraph():t._animations!==n._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,t._animations)}finalizeState(e){super.finalizeState(e),this._deleteScenegraph()}get isLoaded(){var e;return(null===(e=this.state)||void 0===e?void 0:e.scenegraph)&&super.isLoaded}_updateScenegraph(){const e=this.props,{gl:t}=this.context;let n=null;if(e.scenegraph instanceof tf)n={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){const r=e.scenegraph,i=function(e,t,n){const r=new Ff(e,n);return{scenes:r.instantiate(t),animator:r.createAnimator()}}(t,r,this._getModelOptions());n={gltf:r,...i},mv(i).then((()=>this.setNeedsRedraw()))}else e.scenegraph&&(q.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),n=e.scenegraph);const r={layer:this,gl:t},i=e.getScene(n,r),s=e.getAnimator(n,r);i instanceof tf?(this._deleteScenegraph(),this._applyAllAttributes(i),this._applyAnimationsProp(i,s,e._animations),this.setState({scenegraph:i,animator:s})):null!==i&&q.warn("invalid scenegraph:",i)()}_applyAllAttributes(e){if(this.state.attributesAvailable){const t=this.getAttributeManager().getAttributes();e.traverse((e=>{this._setModelAttributes(e.model,t)}))}}_applyAnimationsProp(e,t,n){if(!e||!t||!n)return;const r=t.getAnimations();Object.keys(n).sort().forEach((e=>{const t=n[e];if("*"===e)r.forEach((e=>{Object.assign(e,t)}));else if(Number.isFinite(Number(e))){const n=Number(e);n>=0&&n<r.length?Object.assign(r[n],t):q.warn("animation ".concat(e," not found"))()}else{const n=r.find((t=>{let{name:n}=t;return n===e}));n?Object.assign(n,t):q.warn("animation ".concat(e," not found"))()}}))}_deleteScenegraph(){const{scenegraph:e}=this.state;e instanceof tf&&e.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:e}=this.props;let t=null;return e&&(t="function"===typeof e?e({gl:this.context.gl,layer:this}):e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:t,modelOptions:{isInstanced:!0,transpileToGLSL100:!gi(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(e){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse((t=>{this._setModelAttributes(t.model,e)}))}draw(e){let{moduleParameters:t=null,parameters:n={},context:r}=e;if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:i}=this.context,{sizeScale:s,sizeMinPixels:o,sizeMaxPixels:a,opacity:l,coordinateSystem:c}=this.props,u=this.getNumInstances();this.state.scenegraph.traverse(((e,r)=>{let{worldMatrix:h}=r;e.model.setInstanceCount(u),e.updateModuleSettings(t),e.draw({parameters:n,uniforms:{sizeScale:s,opacity:l,sizeMinPixels:o,sizeMaxPixels:a,composeModelMatrix:Cv(i,c),sceneModelMatrix:h,u_Camera:e.model.getUniforms().project_uCameraPosition}})}))}}g(xv,"defaultProps",Bv),g(xv,"layerName","ScenegraphLayer");const Sv="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",Tv={};function Mv(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tv;if(!("material"in e))return{};const{material:t}=e;return t?function(e){const{ambient:t=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=e;return{lighting_uAmbient:t,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map((e=>e/255))}}(t):{lighting_uEnabled:!1}}const Pv={name:"gouraud-lighting",dependencies:[$d],vs:Sv,defines:{LIGHTING_VERTEX:1},getUniforms:Mv},Iv={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Rv{static get DRAW_MODE(){return Iv}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=_s("geometry"),drawMode:n=Iv.TRIANGLES,attributes:r={},indices:i=null,vertexCount:s=null}=e;this.id=t,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(r,i),this.vertexCount=s||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const n in e){let t=e[n];t=ArrayBuffer.isView(t)?{value:t}:t,vs(ArrayBuffer.isView(t.value),"".concat(this._print(n),": must be typed array or object with value as typed array")),"POSITION"!==n&&"positions"!==n||t.size||(t.size=3),"indices"===n?(vs(!this.indices),this.indices=t):this.attributes[n]=t}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let n=1/0;for(const r in e){const t=e[r],{value:i,size:s,constant:o}=t;!o&&i&&s>=1&&(n=Math.min(n,i.length/s))}return vs(Number.isFinite(n)),n}}const Ov=[0,0,0,255],Lv=[0,0,1],Fv={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:e=>e.position},getNormal:{type:"accessor",value:Lv},getColor:{type:"accessor",value:Ov},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};class kv extends Id{getShaders(){return super.getShaders({vs:"#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\nuniform int sizeUnits;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.normal = project_normal(instanceNormals);\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n  vColor = vec4(lightColor, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[Wd,Pv,Qd]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:Lv},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:Ov}})}updateState(e){const{changeFlags:t,props:n}=e;if(super.updateState(e),t.extensionsChanged){var r;const{gl:e}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}t.dataChanged&&function(e){const{header:t,attributes:n}=e;t&&n&&(e.length=t.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}(n.data)}draw(e){let{uniforms:t}=e;const{pointSize:n,sizeUnits:r}=this.props;this.state.model.setUniforms(t).setUniforms({sizeUnits:br[r],radiusPixels:n}).draw()}_getModel(e){const t=[];for(let n=0;n<3;n++){const e=n/3*Math.PI*2;t.push(2*Math.cos(e),2*Math.sin(e),0)}return new jh(e,{...this.getShaders(),id:this.props.id,geometry:new Rv({drawMode:4,attributes:{positions:new Float32Array(t)}}),isInstanced:!0})}}g(kv,"layerName","PointCloudLayer"),g(kv,"defaultProps",Fv);var Dv=n(579);wt([gv]);const Nv={MESH:"mesh",POINTCLOUD:"pointcloud"},jv={target:[0,0,0],rotationX:30,rotationOrbit:-45,zoom:4,minZoom:-2,maxZoom:20},Uv=.1;function Gv(e){let{modelData:t,pointCloudData:n,viewMode:r=Nv.MESH,controls:i={},initialViewState:s,onCanvasReady:o,onDeviceInfo:a}=e;const l=(0,h.useRef)(null),[c,u]=(0,h.useState)(s||jv),d=(0,h.useRef)({}),f=(0,h.useRef)(null);(0,h.useEffect)((()=>{s&&s.target&&u((e=>({...e,...s})))}),[s]);const p=(0,h.useCallback)((e=>{let{viewState:t}=e;u(t)}),[]);(0,h.useEffect)((()=>{const e=e=>{d.current[e.code]=!0,["KeyW","KeyA","KeyS","KeyD","Space","ShiftLeft","ShiftRight","KeyQ","KeyE"].includes(e.code)&&e.preventDefault()},t=e=>{d.current[e.code]=!1};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}}),[]),(0,h.useEffect)((()=>{const e=()=>{const t=d.current;u((e=>{if(!e||!e.target)return e;const n=(e.rotationOrbit||0)*Math.PI/180,r=[Math.sin(n),0,-Math.cos(n)],i=[Math.cos(n),0,Math.sin(n)];let s=0,o=0,a=0;return t.KeyW&&(s+=r[0]*Uv,a+=r[2]*Uv),t.KeyS&&(s-=r[0]*Uv,a-=r[2]*Uv),t.KeyA&&(s-=i[0]*Uv,a-=i[2]*Uv),t.KeyD&&(s+=i[0]*Uv,a+=i[2]*Uv),(t.Space||t.KeyE)&&(o+=.05),(t.ShiftLeft||t.ShiftRight||t.KeyQ)&&(o-=.05),0!==s||0!==o||0!==a?{...e,target:[e.target[0]+s,e.target[1]+o,e.target[2]+a]}:e})),f.current=requestAnimationFrame(e)};return f.current=requestAnimationFrame(e),()=>{f.current&&cancelAnimationFrame(f.current)}}),[]),(0,h.useEffect)((()=>{var e;if(null!==(e=l.current)&&void 0!==e&&e.deck){const e=l.current.deck;o&&e.canvas&&o(e.canvas),a&&a({type:"webgl2",vendor:"WebGL",renderer:"WebGL2"})}}),[o,a]);const g=(0,h.useMemo)((()=>{const e=[];return r===Nv.MESH&&null!==t&&void 0!==t&&t.url&&e.push(new xv({id:"scenegraph-layer",data:[{position:[0,0,0]}],scenegraph:t.url,getPosition:e=>e.position,getOrientation:e=>[0,0,0],sizeScale:i.modelScale||1,_lighting:"pbr"})),r===Nv.POINTCLOUD&&n&&n.length>0&&e.push(new kv({id:"pointcloud-layer",data:n,getPosition:e=>e.position,getColor:e=>e.color,getNormal:e=>e.normal,pointSize:i.pointSize||4,sizeUnits:"pixels"})),e}),[r,t,n,i.modelScale,i.pointSize]),m=(0,h.useMemo)((()=>new Jd({id:"orbit",orbitAxis:"Y",fovy:i.fov||75,near:.01,far:1e4})),[i.fov]);return(0,Dv.jsx)(jd,{ref:l,views:m,viewState:c,onViewStateChange:p,layers:g,useDevicePixels:!0,controller:!0,parameters:{clearColor:[.1,.1,.1,1]},style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0,cursor:"grab"}})}function zv(e){let{models:t,loading:n,error:r,onSelect:i,selectedModel:s}=e;const[o,a]=(0,h.useState)(!s),l=e=>{i(e),a(!1)};return n?(0,Dv.jsx)("div",{className:"model-selector-overlay",children:(0,Dv.jsxs)("div",{className:"model-selector-modal",children:[(0,Dv.jsx)("h2",{children:"Loading Models..."}),(0,Dv.jsx)("div",{className:"loading-spinner"})]})}):r?(0,Dv.jsx)("div",{className:"model-selector-overlay",children:(0,Dv.jsxs)("div",{className:"model-selector-modal error",children:[(0,Dv.jsx)("h2",{children:"Error Loading Models"}),(0,Dv.jsx)("p",{children:r}),(0,Dv.jsx)("button",{onClick:()=>window.location.reload(),children:"Retry"})]})}):!s&&o?(0,Dv.jsx)("div",{className:"model-selector-overlay",children:(0,Dv.jsxs)("div",{className:"model-selector-modal",children:[(0,Dv.jsx)("h2",{children:"Select a Model"}),(0,Dv.jsx)("p",{className:"subtitle",children:"Choose a 3D model to view"}),(0,Dv.jsx)("div",{className:"model-list",children:t.map((e=>(0,Dv.jsxs)("button",{className:"model-item",onClick:()=>l(e),children:[(0,Dv.jsx)("div",{className:"model-icon",children:"glb"===e.type?"\ud83d\udce6":"\ud83c\udfdb\ufe0f"}),(0,Dv.jsxs)("div",{className:"model-info",children:[(0,Dv.jsx)("span",{className:"model-name",children:e.name}),(0,Dv.jsx)("span",{className:"model-type",children:e.type.toUpperCase()}),e.description&&(0,Dv.jsx)("span",{className:"model-description",children:e.description})]})]},e.id)))}),0===t.length&&(0,Dv.jsx)("p",{className:"no-models",children:"No models found in manifest."})]})}):(0,Dv.jsxs)("div",{className:"model-selector-compact",children:[(0,Dv.jsxs)("button",{className:"model-selector-button",onClick:()=>a(!o),children:[(0,Dv.jsx)("span",{className:"current-model",children:(null===s||void 0===s?void 0:s.name)||"Select Model"}),(0,Dv.jsx)("span",{className:"dropdown-arrow",children:o?"\u25b2":"\u25bc"})]}),o&&(0,Dv.jsx)("div",{className:"model-dropdown",children:t.map((e=>(0,Dv.jsxs)("button",{className:"dropdown-item "+((null===s||void 0===s?void 0:s.id)===e.id?"active":""),onClick:()=>l(e),children:[(0,Dv.jsx)("span",{className:"model-icon-small",children:"glb"===e.type?"\ud83d\udce6":"\ud83c\udfdb\ufe0f"}),(0,Dv.jsx)("span",{children:e.name})]},e.id)))})]})}const Vv={ORIGINAL:"original",HEIGHT:"height",NORMAL:"normal",SOLID:"solid"};function Hv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorMode:n=Vv.ORIGINAL,solidColor:r=[255,255,255],sampleRate:i=1,lodLevel:s=1}=t,[o,a]=(0,h.useState)(null),[l,c]=(0,h.useState)(!1),[u,d]=(0,h.useState)({totalPoints:0,sampledPoints:0}),f=(0,h.useCallback)((()=>{if(!e)return void a(null);let t=e.meshes;t&&0!==t.length||(t=function(e){const t=[];if(!e)return t;e.meshes&&Array.isArray(e.meshes)&&e.meshes.forEach(((e,n)=>{e.primitives&&e.primitives.forEach(((e,r)=>{var i,s;const o=null===(i=e.attributes)||void 0===i||null===(s=i.POSITION)||void 0===s?void 0:s.value;var a,l,c,u;o&&t.push({id:`mesh-${n}-${r}`,positions:o,normals:(null===(a=e.attributes)||void 0===a||null===(l=a.NORMAL)||void 0===l?void 0:l.value)||null,colors:(null===(c=e.attributes)||void 0===c||null===(u=c.COLOR_0)||void 0===u?void 0:u.value)||null,vertexCount:o.length/3})}))}));if(0===t.length&&e.scenes){const n=new Set,r=e=>{if(e&&!n.has(e)){if(n.add(e),e.mesh){const n=e.mesh;n.primitives&&n.primitives.forEach((e=>{var n,r;const i=null===(n=e.attributes)||void 0===n||null===(r=n.POSITION)||void 0===r?void 0:r.value;var s,o,a,l;i&&t.push({id:`node-mesh-${t.length}`,positions:i,normals:(null===(s=e.attributes)||void 0===s||null===(o=s.NORMAL)||void 0===o?void 0:o.value)||null,colors:(null===(a=e.attributes)||void 0===a||null===(l=a.COLOR_0)||void 0===l?void 0:l.value)||null,vertexCount:i.length/3})}))}e.children&&e.children.forEach(r)}};e.scenes.forEach((e=>{e.nodes&&e.nodes.forEach(r)}))}return t}(e.gltf)),t&&0!==t.length?(c(!0),setTimeout((()=>{const e=[];let o=0,l=1/0,u=-1/0;t.forEach((e=>{const t=e.positions;if(t){o+=e.vertexCount||t.length/3;for(let e=1;e<t.length;e+=3){const n=t[e];l=Math.min(l,n),u=Math.max(u,n)}}}));const h=u-l||1,f=i*s;t.forEach((t=>{const{positions:i,normals:s,colors:o}=t;if(!i)return;const a=t.vertexCount||i.length/3;for(let c=0;c<i.length;c+=3){if(Math.random()>f)continue;const t=i[c],u=i[c+1],d=i[c+2],p=s?s[c]:0,g=s?s[c+1]:1,m=s?s[c+2]:0;let v;switch(n){case Vv.HEIGHT:v=Jv(u,l,h);break;case Vv.NORMAL:v=Wv(p,g,m);break;case Vv.SOLID:v=[...r];break;case Vv.ORIGINAL:default:if(o&&o.length>0){const e=c/3,t=o instanceof Uint8Array||o[0]>1,n=o.length/a,r=Math.round(n),i=Math.floor(e*r);v=t?[o[i]||180,o[i+1]||180,o[i+2]||180]:[Math.round(255*(o[i]||.7)),Math.round(255*(o[i+1]||.7)),Math.round(255*(o[i+2]||.7))]}else v=[180,180,180]}e.push({position:[t,u,d],normal:[p,g,m],color:v})}})),a(e),d({totalPoints:o,sampledPoints:e.length}),c(!1)}),0)):a(null)}),[e,n,r,i,s]);return(0,h.useEffect)((()=>{f()}),[f]),{pointCloudData:o,extracting:l,stats:u,reextract:f}}function Jv(e,t,n){const r=(e-t)/n;if(r<.25){const e=r/.25;return[0,Math.round(255*e),255]}if(r<.5){const e=(r-.25)/.25;return[0,255,Math.round(255*(1-e))]}if(r<.75){const e=(r-.5)/.25;return[Math.round(255*e),255,0]}{const e=(r-.75)/.25;return[255,Math.round(255*(1-e)),0]}}function Wv(e,t,n){return[Math.round(255*(.5*e+.5)),Math.round(255*(.5*t+.5)),Math.round(255*(.5*n+.5))]}function Xv(e){var t,n,r;let{controls:i,onControlChange:s,viewMode:o,onViewModeChange:a,cameraMode:l,onCameraModeChange:c,deviceInfo:u,stats:d,isCollapsed:f,onToggleCollapse:p}=e;const[g,m]=(0,h.useState)("view"),v=(e,t)=>{s({...i,[e]:t})},b=i.solidColor?`#${i.solidColor.map((e=>e.toString(16).padStart(2,"0"))).join("")}`:"#ffffff";return(0,Dv.jsxs)("div",{className:"control-panel "+(f?"collapsed":""),children:[(0,Dv.jsxs)("div",{className:"control-panel-header",children:[(0,Dv.jsx)("h3",{children:"Controls"}),(0,Dv.jsx)("button",{className:"collapse-btn",onClick:p,title:f?"Expand":"Collapse",children:f?"\u25c0":"\u25b6"})]}),!f&&(0,Dv.jsxs)("div",{className:"control-panel-content",children:[(0,Dv.jsxs)("div",{className:"control-tabs",children:[(0,Dv.jsx)("button",{className:"tab "+("view"===g?"active":""),onClick:()=>m("view"),children:"View"}),(0,Dv.jsx)("button",{className:"tab "+("render"===g?"active":""),onClick:()=>m("render"),children:"Render"}),(0,Dv.jsx)("button",{className:"tab "+("info"===g?"active":""),onClick:()=>m("info"),children:"Info"})]}),"view"===g&&(0,Dv.jsxs)("div",{className:"control-section",children:[(0,Dv.jsxs)("div",{className:"control-group",children:[(0,Dv.jsx)("label",{children:"View Mode"}),(0,Dv.jsxs)("div",{className:"button-group",children:[(0,Dv.jsx)("button",{className:o===Nv.MESH?"active":"",onClick:()=>a(Nv.MESH),children:"Mesh"}),(0,Dv.jsx)("button",{className:o===Nv.POINTCLOUD?"active":"",onClick:()=>a(Nv.POINTCLOUD),children:"Point Cloud"})]})]}),(0,Dv.jsxs)("div",{className:"control-group",children:[(0,Dv.jsx)("label",{children:"Camera Mode"}),(0,Dv.jsxs)("div",{className:"button-group",children:[(0,Dv.jsx)("button",{className:"free"===l?"active":"",onClick:()=>c("free"),children:"Free Flight"}),(0,Dv.jsx)("button",{className:"physics"===l?"active":"",onClick:()=>c("physics"),children:"Physics"})]})]}),(0,Dv.jsxs)("div",{className:"control-group",children:[(0,Dv.jsxs)("label",{children:["Field of View: ",i.fov||75,"\xb0"]}),(0,Dv.jsx)("input",{type:"range",min:"30",max:"120",value:i.fov||75,onChange:e=>v("fov",parseInt(e.target.value))})]})]}),"render"===g&&(0,Dv.jsxs)("div",{className:"control-section",children:[o===Nv.POINTCLOUD&&(0,Dv.jsxs)(Dv.Fragment,{children:[(0,Dv.jsxs)("div",{className:"control-group",children:[(0,Dv.jsxs)("label",{children:["Point Size: ",i.pointSize||2,"px"]}),(0,Dv.jsx)("input",{type:"range",min:"1",max:"20",step:"0.5",value:i.pointSize||2,onChange:e=>v("pointSize",parseFloat(e.target.value))})]}),(0,Dv.jsxs)("div",{className:"control-group",children:[(0,Dv.jsx)("label",{children:"Color Mode"}),(0,Dv.jsxs)("select",{value:i.colorMode||Vv.ORIGINAL,onChange:e=>v("colorMode",e.target.value),children:[(0,Dv.jsx)("option",{value:Vv.ORIGINAL,children:"Original"}),(0,Dv.jsx)("option",{value:Vv.HEIGHT,children:"Height-based"}),(0,Dv.jsx)("option",{value:Vv.NORMAL,children:"Normal-based"}),(0,Dv.jsx)("option",{value:Vv.SOLID,children:"Solid Color"})]})]}),i.colorMode===Vv.SOLID&&(0,Dv.jsxs)("div",{className:"control-group",children:[(0,Dv.jsx)("label",{children:"Solid Color"}),(0,Dv.jsx)("input",{type:"color",value:b,onChange:e=>{const t=e.target.value,n=parseInt(t.slice(1,3),16),r=parseInt(t.slice(3,5),16),i=parseInt(t.slice(5,7),16);v("solidColor",[n,r,i])}})]}),(0,Dv.jsxs)("div",{className:"control-group",children:[(0,Dv.jsxs)("label",{children:["LOD Level: ",(100*(i.lodLevel||1)).toFixed(0),"%"]}),(0,Dv.jsx)("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:i.lodLevel||1,onChange:e=>v("lodLevel",parseFloat(e.target.value))})]})]}),o===Nv.MESH&&(0,Dv.jsxs)("div",{className:"control-group",children:[(0,Dv.jsxs)("label",{children:["Model Scale: ",i.modelScale||1,"x"]}),(0,Dv.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",value:i.modelScale||1,onChange:e=>v("modelScale",parseFloat(e.target.value))})]}),(0,Dv.jsx)("div",{className:"control-group",children:(0,Dv.jsxs)("label",{className:"checkbox-label",children:[(0,Dv.jsx)("input",{type:"checkbox",checked:!1!==i.highQuality,onChange:e=>v("highQuality",e.target.checked)}),"High Quality"]})}),(0,Dv.jsx)("div",{className:"control-group",children:(0,Dv.jsxs)("label",{className:"checkbox-label",children:[(0,Dv.jsx)("input",{type:"checkbox",checked:!1!==i.antiAliasing,onChange:e=>v("antiAliasing",e.target.checked)}),"Anti-aliasing"]})})]}),"info"===g&&(0,Dv.jsxs)("div",{className:"control-section info-section",children:[(0,Dv.jsxs)("div",{className:"info-item",children:[(0,Dv.jsx)("span",{className:"info-label",children:"Renderer:"}),(0,Dv.jsx)("span",{className:`info-value renderer-${(null===u||void 0===u?void 0:u.type)||"unknown"}`,children:(null===u||void 0===u||null===(t=u.type)||void 0===t?void 0:t.toUpperCase())||"Unknown"})]}),d&&(0,Dv.jsxs)(Dv.Fragment,{children:[(0,Dv.jsxs)("div",{className:"info-item",children:[(0,Dv.jsx)("span",{className:"info-label",children:"Total Points:"}),(0,Dv.jsx)("span",{className:"info-value",children:(null===(n=d.totalPoints)||void 0===n?void 0:n.toLocaleString())||0})]}),(0,Dv.jsxs)("div",{className:"info-item",children:[(0,Dv.jsx)("span",{className:"info-label",children:"Rendered:"}),(0,Dv.jsx)("span",{className:"info-value",children:(null===(r=d.sampledPoints)||void 0===r?void 0:r.toLocaleString())||0})]})]}),(0,Dv.jsxs)("div",{className:"info-item",children:[(0,Dv.jsx)("span",{className:"info-label",children:"Vendor:"}),(0,Dv.jsx)("span",{className:"info-value",children:(null===u||void 0===u?void 0:u.vendor)||"Unknown"})]}),(0,Dv.jsxs)("div",{className:"help-section",children:[(0,Dv.jsx)("h4",{children:"Controls"}),(0,Dv.jsxs)("ul",{children:[(0,Dv.jsxs)("li",{children:[(0,Dv.jsx)("kbd",{children:"W"}),(0,Dv.jsx)("kbd",{children:"A"}),(0,Dv.jsx)("kbd",{children:"S"}),(0,Dv.jsx)("kbd",{children:"D"})," - Move"]}),(0,Dv.jsxs)("li",{children:[(0,Dv.jsx)("kbd",{children:"Space"})," - Ascend / Jump"]}),(0,Dv.jsxs)("li",{children:[(0,Dv.jsx)("kbd",{children:"Shift"})," - Descend"]}),(0,Dv.jsxs)("li",{children:[(0,Dv.jsx)("kbd",{children:"Mouse"})," - Look around"]}),(0,Dv.jsxs)("li",{children:[(0,Dv.jsx)("kbd",{children:"Click"})," - Lock cursor"]}),(0,Dv.jsxs)("li",{children:[(0,Dv.jsx)("kbd",{children:"ESC"})," - Unlock cursor"]})]})]})]})]})]})}function Kv(e){var t;const n=[];if(!e)return n;if(e.meshes&&Array.isArray(e.meshes)&&e.meshes.length>0&&e.meshes.forEach(((e,t)=>{var r;null===(r=e.primitives)||void 0===r||r.forEach(((e,r)=>{var i,s,o,a,l,c,u,h;const d=null===(i=e.attributes)||void 0===i||null===(s=i.POSITION)||void 0===s?void 0:s.value,f=null===(o=e.attributes)||void 0===o||null===(a=o.NORMAL)||void 0===a?void 0:a.value,p=null===(l=e.attributes)||void 0===l||null===(c=l.COLOR_0)||void 0===c?void 0:c.value,g=null===(u=e.attributes)||void 0===u||null===(h=u.TEXCOORD_0)||void 0===h?void 0:h.value;d&&n.push({id:`mesh-${t}-${r}`,positions:d,normals:f||null,colors:p||null,texcoords:g||null,vertexCount:d.length/3})}))})),0===n.length&&null!==(t=e.json)&&void 0!==t&&t.meshes&&e.buffers){const t=e.json.meshes,r=e.json.accessors||[],i=e.json.bufferViews||[];t.forEach(((t,s)=>{var o;null===(o=t.primitives)||void 0===o||o.forEach(((t,o)=>{var a;const l=null===(a=t.attributes)||void 0===a?void 0:a.POSITION;if(void 0!==l){const a=r[l];if(a){const l=i[a.bufferView],h=e.buffers[(null===l||void 0===l?void 0:l.buffer)||0];if(h&&l){var c,u;const d=(l.byteOffset||0)+(a.byteOffset||0),f=a.count,p=new Float32Array(h.arrayBuffer||h,d,3*f);let g=null;const m=null===(c=t.attributes)||void 0===c?void 0:c.NORMAL;if(void 0!==m){const t=r[m];if(t){const n=i[t.bufferView],r=e.buffers[(null===n||void 0===n?void 0:n.buffer)||0];if(r&&n){const e=(n.byteOffset||0)+(t.byteOffset||0);g=new Float32Array(r.arrayBuffer||r,e,3*t.count)}}}let v=null;const b=null===(u=t.attributes)||void 0===u?void 0:u.COLOR_0;if(void 0!==b){const t=r[b];if(t){const n=i[t.bufferView],r=e.buffers[(null===n||void 0===n?void 0:n.buffer)||0];if(r&&n){const e=(n.byteOffset||0)+(t.byteOffset||0),i="VEC4"===t.type?4:3,s=r.arrayBuffer||r;5121===t.componentType?v=new Uint8Array(s,e,t.count*i):5126===t.componentType&&(v=new Float32Array(s,e,t.count*i))}}}n.push({id:`mesh-${s}-${o}`,positions:p,normals:g,colors:v,texcoords:null,vertexCount:f})}}}}))}))}return n}wt([Zg]);const Qv=function(){var e;const{models:t,loading:n,error:r}=function(){const[e,t]=(0,h.useState)([]),[n,r]=(0,h.useState)(!0),[i,s]=(0,h.useState)(null);return(0,h.useEffect)((()=>{(async()=>{try{const e=await fetch("/interior-walkthrough/models/models-manifest.json");if(!e.ok)throw new Error("Failed to fetch model manifest");const n=await e.json();t(n.models||[])}catch(Zv){console.error("Error loading model manifest:",Zv),s(Zv.message)}finally{r(!1)}})()}),[]),{models:e,loading:n,error:i}}(),[i,s]=(0,h.useState)(null),{modelData:o,loading:a,error:l,progress:c,loadModel:u}=function(){const[e,t]=(0,h.useState)(null),[n,r]=(0,h.useState)(null),[i,s]=(0,h.useState)(!1),[o,a]=(0,h.useState)(null),[l,c]=(0,h.useState)(0);return{modelData:n,modelUrl:e,loading:i,error:o,progress:l,loadModel:(0,h.useCallback)((async e=>{if(e){s(!0),a(null),c(0),t(e);try{const t=e.startsWith("http")?e:`/interior-walkthrough${e}`,n=await Ot(t,gv,{gltf:{loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},draco:{decoderType:"js"},onProgress:e=>{e.total&&c(Math.round(e.loaded/e.total*100))}});r({gltf:n,url:t,meshes:Kv(n)}),c(100)}catch(Zv){console.error("Error loading model:",Zv),a(Zv.message||"Failed to load model")}finally{s(!1)}}}),[]),clearModel:(0,h.useCallback)((()=>{r(null),t(null),a(null),c(0)}),[])}}(),[d,f]=(0,h.useState)(Nv.POINTCLOUD),[p,g]=(0,h.useState)({pointSize:2.5,colorMode:Vv.ORIGINAL,solidColor:[255,255,255],highQuality:!0,antiAliasing:!0,lodLevel:1,modelScale:1,fov:75}),[m,v]=(0,h.useState)(!1),[b,y]=(0,h.useState)(null),{pointCloudData:A,extracting:_,stats:w}=Hv(o,{colorMode:p.colorMode,solidColor:p.solidColor,lodLevel:p.lodLevel,sampleRate:1}),C=(0,h.useMemo)((()=>{if(A&&A.length>0){const e=function(e){if(!e||0===e.length)return null;let t=1/0,n=-1/0,r=1/0,i=-1/0,s=1/0,o=-1/0;return e.forEach((e=>{const[a,l,c]=e.position;t=Math.min(t,a),n=Math.max(n,a),r=Math.min(r,l),i=Math.max(i,l),s=Math.min(s,c),o=Math.max(o,c)})),{min:[t,r,s],max:[n,i,o],center:[(t+n)/2,(r+i)/2,(s+o)/2],size:[n-t,i-r,o-s]}}(A);if(e)return{target:e.center,rotationX:30,rotationOrbit:-45,zoom:4,minZoom:-2,maxZoom:20}}return null}),[A]),E=(0,h.useCallback)((e=>{s(e),u(e.path)}),[u]),B=(0,h.useCallback)((e=>{f(e)}),[]),x=(0,h.useCallback)((e=>{g(e)}),[]),S=(0,h.useCallback)((e=>{y(e)}),[]),T=n||a||_,M=n?"Loading model list...":a?`Loading model... ${c}%`:_?"Extracting point cloud...":null;return(0,Dv.jsxs)("div",{className:"app",children:[(0,Dv.jsx)(zv,{models:t,loading:n,error:r,selectedModel:i,onSelect:E}),i&&o&&(0,Dv.jsx)(Gv,{modelData:o,pointCloudData:A,viewMode:d,controls:p,initialViewState:C,onDeviceInfo:S}),i&&(0,Dv.jsx)(Xv,{controls:p,onControlChange:x,viewMode:d,onViewModeChange:B,deviceInfo:b,stats:w,isCollapsed:m,onToggleCollapse:()=>v(!m)}),T&&M&&(0,Dv.jsx)("div",{className:"loading-overlay",children:(0,Dv.jsxs)("div",{className:"loading-content",children:[(0,Dv.jsx)("div",{className:"loading-spinner"}),(0,Dv.jsx)("p",{children:M}),a&&c>0&&(0,Dv.jsx)("div",{className:"progress-bar",children:(0,Dv.jsx)("div",{className:"progress-fill",style:{width:`${c}%`}})})]})}),l&&(0,Dv.jsxs)("div",{className:"error-toast",children:[(0,Dv.jsxs)("p",{children:["Error: ",l]}),(0,Dv.jsx)("button",{onClick:()=>u(null===i||void 0===i?void 0:i.path),children:"Retry"})]}),i&&o&&!T&&(0,Dv.jsx)("div",{className:"pointer-lock-hint",children:"WASD move \xb7 Space up \xb7 Shift down \xb7 Mouse rotate \xb7 Scroll zoom"}),(0,Dv.jsxs)("div",{className:"status-bar",children:[(0,Dv.jsx)("span",{className:`renderer-badge ${(null===b||void 0===b?void 0:b.type)||"unknown"}`,children:(null===b||void 0===b||null===(e=b.type)||void 0===e?void 0:e.toUpperCase())||"WebGL2"}),i&&(0,Dv.jsx)("span",{className:"model-badge",children:i.name})]})]})},Yv=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:s,getTTFB:o}=t;n(e),r(e),i(e),s(e),o(e)}))};d.createRoot(document.getElementById("root")).render((0,Dv.jsx)(h.StrictMode,{children:(0,Dv.jsx)(h.Suspense,{fallback:null,children:(0,Dv.jsx)(Qv,{})})})),Yv()})()})();
//# sourceMappingURL=main.c9c610dd.js.map